(()=>{var tn=Object.defineProperty;var en=(e,n,h)=>n in e?tn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:h}):e[n]=h;var m=(e,n,h)=>(en(e,typeof n!="symbol"?n+"":n,h),h);function pe(e,n,h,c){this.hash=c,this.p=e,this.n=n,this.d=h,this.lambda_n_acc=0,this.lambda_t_acc=0}function St(e,n,h){return e<n?n:e>h?h:e}function Ce(e){return e/180*Math.PI}function bi(e){return e*.02}function Vr(e){return e*50}function l(e,n){this.x=e||0,this.y=n||0}l.zero=new l(0,0);l.prototype.toString=function(){return["x:",this.x,"y:",this.y].join(" ")};l.prototype.set=function(e,n){return this.x=e,this.y=n,this};l.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this};l.prototype.duplicate=function(){return new l(this.x,this.y)};l.prototype.equal=function(e){return!(this.x!=e.x||this.y!=e.y)};l.prototype.add=function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this};l.prototype.addself=function(e){return this.x+=e.x,this.y+=e.y,this};l.prototype.sub=function(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this};l.prototype.subself=function(e){return this.x-=e.x,this.y-=e.y,this};l.prototype.scale=function(e){return this.x*=e,this.y*=e,this};l.prototype.scale2=function(e){return this.x*=e.x,this.y*=e.y,this};l.prototype.mad=function(e,n){this.x+=e.x*n,this.y+=e.y*n};l.prototype.neg=function(){return this.x*=-1,this.y*=-1,this};l.prototype.rcp=function(){return this.x=1/this.x,this.y=1/this.y,this};l.prototype.lengthsq=function(){return this.x*this.x+this.y*this.y};l.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};l.prototype.normalize=function(){var e=this.x!=0||this.y!=0?1/Math.sqrt(this.x*this.x+this.y*this.y):0;return this.x*=e,this.y*=e,this};l.prototype.dot=function(e){return this.x*e.x+this.y*e.y};l.prototype.cross=function(e){return this.x*e.y-this.y*e.x};l.prototype.toAngle=function(){return Math.atan2(this.y,this.x)};l.prototype.rotation=function(e){return this.x=Math.cos(e),this.y=Math.sin(e),this};l.prototype.rotate=function(e){var n=Math.cos(e),h=Math.sin(e);return this.set(this.x*n-this.y*h,this.x*h+this.y*n)};l.prototype.lerp=function(e,n,h){return this.add(l.scale(e,1-h),l.scale(n,h))};l.add=function(e,n){return new l(e.x+n.x,e.y+n.y)};l.sub=function(e,n){return new l(e.x-n.x,e.y-n.y)};l.scale=function(e,n){return new l(e.x*n,e.y*n)};l.scale2=function(e,n){return new l(e.x*n.x,e.y*n.y)};l.mad=function(e,n,h){return new l(e.x+n.x*h,e.y+n.y*h)};l.neg=function(e){return new l(-e.x,-e.y)};l.rcp=function(e){return new l(1/e.x,1/e.y)};l.normalize=function(e){var n=e.x!=0||e.y!=0?1/Math.sqrt(e.x*e.x+e.y*e.y):0;return new l(e.x*n,e.y*n)};l.dot=function(e,n){return e.x*n.x+e.y*n.y};l.cross=function(e,n){return e.x*n.y-e.y*n.x};l.toAngle=function(e){return Math.atan2(e.y,e.x)};l.rotation=function(e){return new l(Math.cos(e),Math.sin(e))};l.rotate=function(e,n){var h=Math.cos(n),c=Math.sin(n);return new l(e.x*h-e.y*c,e.x*c+e.y*h)};l.perp=function(e){return new l(-e.y,e.x)};l.rperp=function(e){return new l(e.y,-e.x)};l.dist=function(e,n){var h=n.x-e.x,c=n.y-e.y;return Math.sqrt(h*h+c*c)};l.distsq=function(e,n){var h=n.x-e.x,c=n.y-e.y;return h*h+c*c};l.lerp=function(e,n,h){return l.add(l.scale(e,1-h),l.scale(n,h))};l.truncate=function(e,n){var h=e.duplicate(),c=e.x*e.x+e.y*e.y;return c>n*n&&h.scale(n/Math.sqrt(c)),h};function gt(e,n,h){this.x=e||0,this.y=n||0,this.z=h||0}gt.zero=new gt(0,0,0);gt.prototype.toString=function(){return["x:",this.x,"y:",this.y,"z:",this.z].join(" ")};gt.prototype.set=function(e,n,h){return this.x=e,this.y=n,this.z=h,this};gt.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this};gt.prototype.duplicate=function(){return new gt(this.x,this.y,this.z)};gt.prototype.equal=function(e){return!(this.x!=e.x||this.y!=e.y||this.z!=e.z)};gt.prototype.add=function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this};gt.prototype.addself=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this};gt.prototype.sub=function(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this};gt.prototype.subself=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this};gt.prototype.scale=function(e){return this.x*=e,this.y*=e,this.z*=e,this};gt.prototype.mad=function(e,n){this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n};gt.prototype.neg=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this};gt.prototype.rcp=function(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this};gt.prototype.lengthsq=function(){return this.x*this.x+this.y*this.y+this.z*this.z};gt.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};gt.prototype.normalize=function(){var e=this.x!=0||this.y!=0||this.z!=0?1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z):0;return this.x*=e,this.y*=e,this.z*=e,this};gt.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z};gt.prototype.toVec2=function(){return new l(this.x,this.y)};gt.fromVec2=function(e,n){return new gt(e.x,e.y,n)};gt.truncate=function(e,n){var h=e.duplicate(),c=e.x*e.x+e.y*e.y+e.z*e.z;return c>n*n&&h.scale(n/Math.sqrt(c)),h};function Ct(e,n,h,c){this._11=e||0,this._12=n||0,this._21=h||0,this._22=c||0}Ct.zero=new Ct(0,0,0,0);Ct.prototype.toString=function(){return["[",this._11,this._12,this_21,this._22,"]"].join(" ")};Ct.prototype.set=function(e,n,h,c){return this._11=e,this._12=n,this._21=h,this._22=c,this};Ct.prototype.copy=function(e){return this._11=e._11,this._12=e._12,this._21=e._21,this._22=e._22,this};Ct.prototype.duplicate=function(){return new Ct(this._11,this._12,this._21,this._22)};Ct.prototype.scale=function(e){return this._11*=e,this._12*=e,this._21*=e,this._22*=e,this};Ct.prototype.mul=function(e){return this.set(this._11*m2._11+this._12*m2._21,this._11*m2._12+this._12*m2._22,this._21*m2._11+this._22*m2._21,this._21*m2._12+this._22*m2._22)};Ct.prototype.mulvec=function(e){return new l(this._11*e.x+this._12*e.y,this._21*e.x+this._22*e.y)};Ct.prototype.invert=function(){var e=this._11*this._22-this._12*this._21;return e!=0&&(e=1/e),this.set(this._22*e,-this._12*e,-this._21*e,this._11*e)};Ct.prototype.solve=function(e){var n=this._11*this._22-this._12*this._21;return n!=0&&(n=1/n),new l(n*(this._22*e.x-this._12*e.y),n*(this._11*e.y-this._21*e.x))};Ct.mul=function(e,n){return new Ct(e._11*n._11+e._12*n._21,e._11*n._12+e._12*n._22,e._21*n._11+e._22*n._21,e._21*n._12+e._22*n._22)};function Bt(e,n,h,c,p,v,y,b,g){this._11=e||0,this._12=n||0,this._13=h||0,this._21=c||0,this._22=p||0,this._23=v||0,this._31=y||0,this._32=b||0,this._33=g||0}Bt.zero=new Bt(0,0,0,0,0,0,0,0,0);Bt.prototype.toString=function(){return["[",this._11,this._12,this._13,this_21,this._22,this._23,this._31,this._32,this._33,"]"].join(" ")};Bt.prototype.set=function(e,n,h,c,p,v,y,b,g){return this._11=e,this._12=n,this._13=h,this._21=c,this._22=p,this._23=v,this._31=y,this._32=b,this._33=g,this};Bt.prototype.copy=function(e){return this._11=e._11,this._12=e._12,this._13=e._13,this._21=e._21,this._22=e._22,this._23=e._23,this._31=e._31,this._32=e._32,this._33=e._33,this};Bt.prototype.duplicate=function(){return new Bt(this._11,this._12,this._13,this._21,this._22,this._23,this._31,this._32,this._33)};Bt.prototype.scale=function(e){return this._11*=e,this._12*=e,this._13*=e,this._21*=e,this._22*=e,this._23*=e,this._31*=e,this._32*=e,this._33*=e,this};Bt.prototype.mul=function(e){return this.set(this._11*m2._11+this._12*m2._21+this._13*m2._31,this._11*m2._12+this._12*m2._22+this._13*m2._32,this._11*m2._13+this._12*m2._23+this._13*m2._33,this._21*m2._11+this._22*m2._21+this._23*m2._31,this._21*m2._12+this._22*m2._22+this._23*m2._32,this._21*m2._13+this._22*m2._23+this._23*m2._33,this._31*m2._11+this._32*m2._21+this._33*m2._31,this._31*m2._12+this._32*m2._22+this._33*m2._32,this._31*m2._13+this._32*m2._23+this._33*m2._33)};Bt.prototype.mulvec=function(e){return new l(this._11*e.x+this._12*e.y+this._13*e.z,this._21*e.x+this._22*e.y+this._23*e.z,this._31*e.x+this._32*e.y+this._33*e.z)};Bt.prototype.invert=function(){var e=this._22*this._33-this._23*this._32,n=this._23*this._31-this._21*this._33,h=this._21*this._32-this._22*this._31,c=this._11*e+this._12*n+this._13*h;c!=0&&(c=1/c);var p=this._13*this._32-this._12*this._33,v=this._11*this._33-this._13*this._31,y=this._12*this._31-this._11*this._32,b=this._12*this._23-this._13*this._22,g=this._13*this._21-this._11*this._23,M=this._11*this._22-this._12*this._21;return this.set(e*c,n*c,h*c,p*c,v*c,y*c,b*c,g*c,M*c)};Bt.prototype.solve2x2=function(e){var n=this._11*this._22-this._12*this._21;return n!=0&&(n=1/n),new l(n*(this._22*e.x-this._12*e.y),n*(this._11*e.y-this._21*e.x))};Bt.prototype.solve=function(e){var n=this._22*this._33-this._23*this._32,h=this._23*this._31-this._21*this._33,c=this._21*this._32-this._22*this._31,p=this._11*n+this._12*h+this._13*c;p!=0&&(p=1/p);var v=this._13*this._32-this._12*this._33,y=this._11*this._33-this._13*this._31,b=this._12*this._31-this._11*this._32,g=this._12*this._23-this._13*this._22,M=this._13*this._21-this._11*this._23,k=this._11*this._22-this._12*this._21;return new gt(p*(n*e.x+h*e.y+c*e.z),p*(v*e.x+y*e.y+b*e.z),p*(g*e.x+M*e.y+k*e.z))};Bt.mul=function(e,n){return new Bt(e._11*n._11+e._12*n._21+e._13*n._31,e._11*n._12+e._12*n._22+e._13*n._32,e._11*n._13+e._12*n._23+e._13*n._33,e._21*n._11+e._22*n._21+e._23*n._31,e._21*n._12+e._22*n._22+e._23*n._32,e._21*n._13+e._22*n._23+e._23*n._33,e._31*n._11+e._32*n._21+e._33*n._31,e._31*n._12+e._32*n._22+e._33*n._32,e._31*n._13+e._32*n._23+e._33*n._33)};var ve=function(e,n){this.t=e.duplicate(),this.c=Math.cos(n),this.s=Math.sin(n)};ve.prototype.set=function(e,n){return this.t.copy(e),this.c=Math.cos(n),this.s=Math.sin(n),this};ve.prototype.setRotation=function(e){return this.c=Math.cos(e),this.s=Math.sin(e),this};ve.prototype.setPosition=function(e){return this.t.copy(e),this};ve.prototype.identity=function(){return this.t.set(0,0),this.c=1,this.s=0,this};ve.prototype.rotate=function(e){return new l(e.x*this.c-e.y*this.s,e.x*this.s+e.y*this.c)};ve.prototype.unrotate=function(e){return new l(e.x*this.c+e.y*this.s,-e.x*this.s+e.y*this.c)};ve.prototype.transform=function(e){return new l(e.x*this.c-e.y*this.s+this.t.x,e.x*this.s+e.y*this.c+this.t.y)};ve.prototype.untransform=function(e){var n=e.x-this.t.x,h=e.y-this.t.y;return new l(n*this.c+h*this.s,-n*this.s+h*this.c)};var Et=function(e,n){this.mins=e?new l(e.x,e.y):new l(1/0,1/0),this.maxs=n?new l(n.x,n.y):new l(-1/0,-1/0)};Et.prototype.toString=function(){return["mins:",this.mins.toString(),"maxs:",this.maxs.toString()].join(" ")};Et.prototype.set=function(e,n){this.mins.set(e.x,e.y),this.maxs.set(n.x,n.y)};Et.prototype.copy=function(e){return this.mins.copy(e.mins),this.maxs.copy(e.maxs),this};Et.prototype.clear=function(){return this.mins.set(1/0,1/0),this.maxs.set(-1/0,-1/0),this};Et.prototype.isEmpty=function(){if(this.mins.x===-1/0||this.maxs.x===1/0||this.mins.y===-1/0||this.maxs.y===1/0||this.mins.x>this.maxs.x||this.mins.y>this.maxs.y)return!0};Et.prototype.getCenter=function(){return l.scale(l.add(this.mins,this.maxs),.5)};Et.prototype.getExtent=function(){return l.scale(l.sub(this.maxs,this.mins),.5)};Et.prototype.getPerimeter=function(){return(maxs.x-mins.x+maxs.y-mins.y)*2};Et.prototype.addPoint=function(e){return this.mins.x>e.x&&(this.mins.x=e.x),this.maxs.x<e.x&&(this.maxs.x=e.x),this.mins.y>e.y&&(this.mins.y=e.y),this.maxs.y<e.y&&(this.maxs.y=e.y),this};Et.prototype.addBounds=function(e){return this.mins.x>e.mins.x&&(this.mins.x=e.mins.x),this.maxs.x<e.maxs.x&&(this.maxs.x=e.maxs.x),this.mins.y>e.mins.y&&(this.mins.y=e.mins.y),this.maxs.y<e.maxs.y&&(this.maxs.y=e.maxs.y),this};Et.prototype.addBounds2=function(e,n){return this.mins.x>e.x&&(this.mins.x=e.x),this.maxs.x<n.x&&(this.maxs.x=n.x),this.mins.y>e.y&&(this.mins.y=e.y),this.maxs.y<n.y&&(this.maxs.y=n.y),this};Et.prototype.addExtents=function(e,n,h){return this.mins.x>e.x-n&&(this.mins.x=e.x-n),this.maxs.x<e.x+n&&(this.maxs.x=e.x+n),this.mins.y>e.y-h&&(this.mins.y=e.y-h),this.maxs.y<e.y+h&&(this.maxs.y=e.y+h),this};Et.prototype.expand=function(e,n){return this.mins.x-=e,this.mins.y-=n,this.maxs.x+=e,this.maxs.y+=n,this};Et.prototype.containPoint=function(e){return!(e.x<this.mins.x||e.x>this.maxs.x||e.y<this.mins.y||e.y>this.maxs.y)};Et.prototype.intersectsBounds=function(e){return!(this.mins.x>e.maxs.x||this.maxs.x<e.mins.x||this.mins.y>e.maxs.y||this.maxs.y<e.mins.y)};Et.expand=function(c,n,h){var c=new Et(c.mins,c.maxs);return c.expand(n,h),c};var nt=function(e){arguments.length!=0&&(nt.id_counter==null&&(nt.id_counter=0),this.id=nt.id_counter++,this.type=e,this.e=0,this.u=1,this.density=1,this.bounds=new Et)};nt.TYPE_CIRCLE=0;nt.TYPE_SEGMENT=1;nt.TYPE_POLY=2;nt.NUM_TYPES=3;nt.prototype.translateTo=function(e){switch(console.warn("Unimplemented"),this.type){case nt.TYPE_CIRCLE:console.warn("Shape.TYPE_CIRCLE.translateTo: TODO tests",e),this.c.copy(this.body.getLocalPoint(e));break;case nt.TYPE_SEGMENT:console.warn("Shape.TYPE_SEGMENT.translateTo: TODO tests",e);var c=l.sub(e,this.centroid()),n=l.add(this.ta,c),h=l.add(this.ta,c);this.a.copy(this.body.getLocalPoint(n)),this.b.copy(this.body.getLocalPoint(h));break;case nt.TYPE_POLY:for(var c=l.sub(e,this.centroid()),p=0;p<this.tverts.length;p++){var v=l.add(this.tverts[p],c);this.verts[p].copy(this.body.getLocalPoint(v))}break}this.finishVerts(),this.body.resetMassData(),this.body.awake(!0),this.body.cacheData()};nt.prototype.translateWithDelta=function(e){switch(console.warn("Unimplemented"),this.type){case nt.TYPE_CIRCLE:var n=l.add(this.tc,e);this.c.copy(this.body.getLocalPoint(n));break;case nt.TYPE_SEGMENT:var h=l.add(this.ta,e),c=l.add(this.ta,e);this.a.copy(this.body.getLocalPoint(h)),this.b.copy(this.body.getLocalPoint(c));break;case nt.TYPE_POLY:for(var p=this.body.p,v=this.body.a,y=0;y<this.tverts.length;y++){var b=l.add(this.tverts[y],e);this.verts[y].copy(this.body.getLocalPoint(b))}break}this.finishVerts(),this.body.resetMassData(),this.body.awake(!0),this.body.cacheData()};var Re={};(function(){var e=[];function n(L,R,B){e[L*nt.NUM_TYPES+R]=B}function h(L,R,B,V,H){var W=R+V,J=l.sub(B,L),G=J.lengthsq();if(G>W*W)return 0;var K=Math.sqrt(G),ht=l.mad(L,J,.5+(R-V)*.5/K),At=K!=0?l.scale(J,1/K):l.zero,pt=K-W;return H.push(new pe(ht,At,pt,0)),1}function c(L,R,B){return h(L.tc,L.r,R.tc,R.r,B)}function p(L,R,B){var V=L.r+R.r,H=l.dot(L.tc,R.tn)-l.dot(R.ta,R.tn),W=(H<0?H*-1:H)-V;if(W>0)return 0;var J=l.cross(L.tc,R.tn),G=l.cross(R.ta,R.tn),K=l.cross(R.tb,R.tn);if(J<G)return J<G-V?0:h(L.tc,L.r,R.ta,R.r,B);if(J>K)return J>K+V?0:h(L.tc,L.r,R.tb,R.r,B);var ht=H>0?R.tn:l.neg(R.tn);return B.push(new pe(l.mad(L.tc,ht,-(L.r+W*.5)),l.neg(ht),W,0)),1}function v(L,R,B){for(var V=-999999,H=-1,W=0;W<R.verts.length;W++){var J=R.tplanes[W],G=l.dot(L.tc,J.n)-J.d-L.r;if(G>0)return 0;G>V&&(V=G,H=W)}var K=R.tplanes[H].n,ht=R.tverts[H],At=R.tverts[(H+1)%R.verts.length],pt=l.cross(ht,K),fe=l.cross(At,K),E=l.cross(L.tc,K);return E>pt?h(L.tc,L.r,ht,0,B):E<fe?h(L.tc,L.r,At,0,B):(B.push(new pe(l.mad(L.tc,K,-(L.r+V*.5)),l.neg(K),V,0)),1)}function y(L,R){var B=l.sub(R,L.ta),V=l.sub(L.tb,L.ta),H=B.dot(V);if(H<=0)return B.dot(B);var W=V.dot(V);return H>=W?B.dot(B)-2*H+W:B.dot(B)-H*H/W}function b(L,R,B){var V=[];V[0]=y(L,R.ta),V[1]=y(L,R.tb),V[2]=y(R,L.ta),V[3]=y(R,L.tb);var H=V[0]<V[1]?0:1,W=V[2]<V[3]?2:3,J=V[H]<V[W]?H:W,G,K,ht=l.sub(L.tb,L.ta),At=l.sub(R.tb,R.ta);switch(J){case 0:G=l.dot(l.sub(R.ta,L.ta),ht)/l.dot(ht,ht),G=G<0?0:G>1?1:G,K=0;break;case 1:G=l.dot(l.sub(R.tb,L.ta),ht)/l.dot(ht,ht),G=G<0?0:G>1?1:G,K=1;break;case 2:G=0,K=l.dot(l.sub(L.ta,R.ta),At)/l.dot(At,At),K=K<0?0:K>1?1:K;break;case 3:G=1,K=l.dot(l.sub(L.tb,R.ta),At)/l.dot(At,At),K=K<0?0:K>1?1:K;break}var pt=l.mad(L.ta,ht,G),fe=l.mad(R.ta,At,K);return h(pt,L.r,fe,R.r,B)}function g(L,R,B,V,H){for(var W=l.cross(R.tn,R.ta),J=l.cross(R.tn,R.tb),G=l.scale(R.tn,H),K=0;K<B.verts.length;K++){var ht=B.tverts[K];if(l.dot(ht,G)<l.dot(R.tn,R.ta)*H+R.r){var At=l.cross(R.tn,ht);W>=At&&At>=J&&L.push(new pe(ht,G,V,B.id<<16|K))}}}function M(L,R,B){var V=l.dot(L.tn,L.ta),H=R.distanceOnPlane(L.tn,V)-L.r;if(H>0)return 0;var W=R.distanceOnPlane(l.neg(L.tn),-V)-L.r;if(W>0)return 0;for(var J=-999999,G=-1,K=0;K<R.verts.length;K++){var ht=R.tplanes[K],At=L.distanceOnPlane(ht.n,ht.d);if(At>0)return 0;At>J&&(J=At,G=K)}var pt=l.neg(R.tplanes[G].n),fe=l.mad(L.ta,pt,L.r),E=l.mad(L.tb,pt,L.r);if(R.containPoint(fe)&&B.push(new pe(fe,pt,J,L.id<<16|0)),R.containPoint(E)&&B.push(new pe(E,pt,J,L.id<<16|1)),J-=.1,(H>=J||W>=J)&&(H>W?g(B,L,R,H,1):g(B,L,R,W,-1)),B.length==0){var lt=R.tverts[G],ft=R.tverts[(G+1)%R.verts.length];if(h(L.ta,L.r,lt,0,B)||h(L.tb,L.r,lt,0,B)||h(L.ta,L.r,ft,0,B)||h(L.tb,L.r,ft,0,B))return 1}return B.length}function k(L,R,B){for(var V=-999999,H=-1,W=0;W<B;W++){var J=L.distanceOnPlane(R[W].n,R[W].d);if(J>0)return{dist:0,index:-1};J>V&&(V=J,H=W)}return{dist:V,index:H}}function U(L,R,B,V,H){for(var W=0,J=0;J<R.verts.length;J++){var G=R.tverts[J];B.containPointPartial(G,V)&&(L.push(new pe(G,V,H,R.id<<16|J)),W++)}for(var J=0;J<B.verts.length;J++){var G=B.tverts[J];R.containPointPartial(G,V)&&(L.push(new pe(G,V,H,B.id<<16|J)),W++)}return W}function O(L,R,B,V,H){for(var W=0,J=0;J<R.verts.length;J++){var G=R.tverts[J];B.containPoint(G)&&(L.push(new pe(G,V,H,R.id<<16|J)),W++)}for(var J=0;J<B.verts.length;J++){var G=B.tverts[J];R.containPoint(G)&&(L.push(new pe(G,V,H,B.id<<16|J)),W++)}return W>0?W:U(L,R,B,V,H)}function Z(L,R,B){var V=k(R,L.tplanes,L.verts.length);if(V.index==-1)return 0;var H=k(L,R.tplanes,R.verts.length);return H.index==-1?0:V.dist>H.dist?O(B,L,R,L.tplanes[V.index].n,V.dist):O(B,L,R,l.neg(R.tplanes[H.index].n),H.dist)}Re.init=function(){n(nt.TYPE_CIRCLE,nt.TYPE_CIRCLE,c),n(nt.TYPE_CIRCLE,nt.TYPE_SEGMENT,p),n(nt.TYPE_CIRCLE,nt.TYPE_POLY,v),n(nt.TYPE_SEGMENT,nt.TYPE_SEGMENT,b),n(nt.TYPE_SEGMENT,nt.TYPE_POLY,M),n(nt.TYPE_POLY,nt.TYPE_POLY,Z)},Re.collide=function(L,R,B){if(L.type>R.type){var V=L;L=R,R=V}return e[L.type*nt.NUM_TYPES+R.type](L,R,B)}})();function Wr(e,n){return Math.PI*(e*e-n*n)}function qr(e,n,h,c){return e*((h*h+c*c)*.5+n.lengthsq())}function Ur(e,n,h){return h*(Math.PI*h+2*l.dist(e,n))}function Xr(e,n){return l.scale(l.add(e,n),.5)}function Hr(e,n,h){var c=l.distsq(h,n),p=l.scale(l.add(n,h),.5);return e*(c/12+p.lengthsq())}function Jr(e){for(var n=0,h=0;h<e.length;h++)n+=l.cross(e[h],e[(h+1)%e.length]);return n/2}function jr(e){for(var n=0,h=new l(0,0),c=0;c<e.length;c++){var p=e[c],v=e[(c+1)%e.length],y=l.cross(p,v);n+=y,h.addself(l.scale(l.add(p,v),y))}return l.scale(h,1/(3*n))}function Gr(e,n,h){for(var c=0,p=0,v=0;v<n.length;v++){var y=l.add(n[v],h),b=l.add(n[(v+1)%n.length],h),g=l.cross(b,y),M=l.dot(y,y)+l.dot(y,b)+l.dot(b,b);c+=g*M,p+=g}return e*c/(6*p)}function Kr(){return!!navigator.userAgent.match(/iPhone|iPod|iPad/gi)}var Ft=function(e,n,h){nt.call(this,nt.TYPE_CIRCLE),this.c=new l(e||0,n||0),this.r=h,this.tc=l.zero,this.finishVerts()};Ft.prototype=new nt;Ft.prototype.constructor=Ft;Ft.prototype.finishVerts=function(){this.r=Math.abs(this.r)};Ft.prototype.duplicate=function(){return new Ft(this.c.x,this.c.y,this.r)};Ft.prototype.serialize=function(){return{type:"ShapeCircle",e:this.e,u:this.u,density:this.density,center:this.c,radius:this.r}};Ft.prototype.recenter=function(e){this.c.subself(e)};Ft.prototype.transform=function(e){this.c=e.transform(this.c)};Ft.prototype.untransform=function(e){this.c=e.untransform(this.c)};Ft.prototype.area=function(){return Wr(this.r,0)};Ft.prototype.centroid=function(){return this.c.duplicate()};Ft.prototype.inertia=function(e){return qr(e,this.c,this.r,0)};Ft.prototype.cacheData=function(e){this.tc=e.transform(this.c),this.bounds.mins.set(this.tc.x-this.r,this.tc.y-this.r),this.bounds.maxs.set(this.tc.x+this.r,this.tc.y+this.r)};Ft.prototype.pointQuery=function(e){return l.distsq(this.tc,e)<this.r*this.r};Ft.prototype.findVertexByPoint=function(e,n){var h=n*n;return l.distsq(this.tc,e)<h?0:-1};Ft.prototype.distanceOnPlane=function(e,n){return l.dot(e,this.tc)-this.r-n};var It=function(e,n,h){nt.call(this,nt.TYPE_SEGMENT),this.a=e.duplicate(),this.b=n.duplicate(),this.r=h,this.n=l.perp(l.sub(n,e)),this.n.normalize(),this.ta=l.zero,this.tb=l.zero,this.tn=l.zero,this.finishVerts()};It.prototype=new nt;It.prototype.constructor=It;It.prototype.finishVerts=function(){this.n=l.perp(l.sub(this.b,this.a)),this.n.normalize(),this.r=Math.abs(this.r)};It.prototype.duplicate=function(){return new It(this.a,this.b,this.r)};It.prototype.serialize=function(){return{type:"ShapeSegment",e:this.e,u:this.u,density:this.density,a:this.a,b:this.b,radius:this.r}};It.prototype.recenter=function(e){this.a.subself(e),this.b.subself(e)};It.prototype.transform=function(e){this.a=e.transform(this.a),this.b=e.transform(this.b)};It.prototype.untransform=function(e){this.a=e.untransform(this.a),this.b=e.untransform(this.b)};It.prototype.area=function(){return Ur(this.a,this.b,this.r)};It.prototype.centroid=function(){return Xr(this.a,this.b)};It.prototype.inertia=function(e){return Hr(e,this.a,this.b)};It.prototype.cacheData=function(e){if(this.ta=e.transform(this.a),this.tb=e.transform(this.b),this.tn=l.perp(l.sub(this.tb,this.ta)).normalize(),this.ta.x<this.tb.x)var n=this.ta.x,h=this.tb.x;else var n=this.tb.x,h=this.ta.x;if(this.ta.y<this.tb.y)var c=this.ta.y,p=this.tb.y;else var c=this.tb.y,p=this.ta.y;this.bounds.mins.set(n-this.r,c-this.r),this.bounds.maxs.set(h+this.r,p+this.r)};It.prototype.pointQuery=function(e){if(!this.bounds.containPoint(e))return!1;var n=l.dot(this.tn,e)-l.dot(this.ta,this.tn),h=Math.abs(n);if(h>this.r)return!1;var c=l.cross(e,this.tn),p=l.cross(this.ta,this.tn),v=l.cross(this.tb,this.tn);return c<=p?c<p-this.r?!1:l.distsq(this.ta,e)<this.r*this.r:c>v?c>v+this.r?!1:l.distsq(this.tb,e)<this.r*this.r:!0};It.prototype.findVertexByPoint=function(e,n){var h=n*n;return l.distsq(this.ta,e)<h?0:l.distsq(this.tb,e)<h?1:-1};It.prototype.distanceOnPlane=function(e,n){var h=l.dot(e,this.ta)-this.r,c=l.dot(e,this.tb)-this.r;return Math.min(h,c)-n};var kt=function(e){if(nt.call(this,nt.TYPE_POLY),this.verts=[],this.planes=[],this.tverts=[],this.tplanes=[],e)for(var n=0;n<e.length;n++)this.verts[n]=e[n].duplicate(),this.tverts[n]=this.verts[n],this.tplanes[n]={},this.tplanes[n].n=l.zero,this.tplanes[n].d=0;this.finishVerts()};kt.prototype=new nt;kt.prototype.constructor=kt;kt.prototype.finishVerts=function(){if(this.verts.length<2){this.convexity=!1,this.planes=[];return}this.convexity=!0,this.tverts=[],this.tplanes=[];for(var e=0;e<this.verts.length;e++){var n=this.verts[e],h=this.verts[(e+1)%this.verts.length],c=l.normalize(l.perp(l.sub(n,h)));this.planes[e]={},this.planes[e].n=c,this.planes[e].d=l.dot(c,n),this.tverts[e]=this.verts[e],this.tplanes[e]={},this.tplanes[e].n=l.zero,this.tplanes[e].d=0}for(var e=0;e<this.verts.length;e++){var h=this.verts[(e+2)%this.verts.length],c=this.planes[e].n,p=this.planes[e].d;l.dot(c,h)-p>0&&(this.convexity=!1)}};kt.prototype.duplicate=function(){return new kt(this.verts)};kt.prototype.serialize=function(){return{type:"ShapePoly",e:this.e,u:this.u,density:this.density,verts:this.verts}};kt.prototype.recenter=function(e){for(var n=0;n<this.verts.length;n++)this.verts[n].subself(e)};kt.prototype.transform=function(e){for(var n=0;n<this.verts.length;n++)this.verts[n]=e.transform(this.verts[n])};kt.prototype.untransform=function(e){for(var n=0;n<this.verts.length;n++)this.verts[n]=e.untransform(this.verts[n])};kt.prototype.area=function(){return Jr(this.verts)};kt.prototype.centroid=function(){return jr(this.verts)};kt.prototype.inertia=function(e){return Gr(e,this.verts,l.zero)};kt.prototype.cacheData=function(e){this.bounds.clear();var n=this.verts.length;if(n!=0){for(var h=0;h<n;h++)this.tverts[h]=e.transform(this.verts[h]);if(n<2){this.bounds.addPoint(this.tverts[0]);return}for(var h=0;h<n;h++){var c=this.tverts[h],p=this.tverts[(h+1)%n],v=l.normalize(l.perp(l.sub(c,p)));this.tplanes[h].n=v,this.tplanes[h].d=l.dot(v,c),this.bounds.addPoint(c)}}};kt.prototype.pointQuery=function(e){return this.bounds.containPoint(e)?this.containPoint(e):!1};kt.prototype.findVertexByPoint=function(e,n){for(var h=n*n,c=0;c<this.tverts.length;c++)if(l.distsq(this.tverts[c],e)<h)return c;return-1};kt.prototype.findEdgeByPoint=function(e,n){for(var h=n*n,c=this.tverts.length,p=0;p<this.tverts.length;p++){var v=this.tverts[p],y=this.tverts[(p+1)%c],b=this.tplanes[p].n,g=l.cross(v,b),M=l.cross(y,b),k=l.cross(e,b);if(k>g){if(l.distsq(v,e)<h)return p}else if(k<M){if(l.distsq(y,e)<h)return p}else{var U=l.dot(b,e)-l.dot(b,v);if(U*U<h)return p}}return-1};kt.prototype.distanceOnPlane=function(e,n){for(var h=999999,c=0;c<this.verts.length;c++)h=Math.min(h,l.dot(e,this.tverts[c]));return h-n};kt.prototype.containPoint=function(e){for(var n=0;n<this.verts.length;n++){var h=this.tplanes[n];if(l.dot(h.n,e)-h.d>0)return!1}return!0};kt.prototype.containPointPartial=function(e,n){for(var h=0;h<this.verts.length;h++){var c=this.tplanes[h];if(!(l.dot(c.n,n)<1e-4)&&l.dot(c.n,e)-c.d>0)return!1}return!0};var Qr=function(e,n,h){var c=[new l(e.x,e.y),new l(n.x,n.y),new l(h.x,h.y)];return new kt(c)},$r=function(e,n,h,c){e=e||0,n=n||0;var p=h*.5,v=c*.5,y=[new l(-p+e,+v+n),new l(-p+e,-v+n),new l(+p+e,-v+n),new l(+p+e,+v+n)];return new kt(y)};var tt=function(e,n,h){tt.id_counter==null&&(tt.id_counter=0),this.id=tt.id_counter++,this.name="body"+this.id,this.type=e,n=n||new l(0,0),h=h||0,this.xf=new ve(n,h),this.centroid=new l(0,0),this.p=new l(n.x,n.y),this.v=new l(0,0),this.f=new l(0,0),this.a=h,this.w=0,this.t=0,this.linearDamping=0,this.angularDamping=0,this.sleepTime=0,this.awaked=!1,this.shapeArr=[],this.jointArr=[],this.jointHash={},this.bounds=new Et,this.fixedRotation=!1,this.categoryBits=1,this.maskBits=65535,this.stepCount=0};tt.STATIC=0;tt.KINETIC=1;tt.DYNAMIC=2;tt.prototype.duplicate=function(){for(var e=new tt(this.type,this.xf.t,this.a),n=0;n<this.shapeArr.length;n++)e.addShape(this.shapeArr[n].duplicate());return e.resetMassData(),e};tt.prototype.serialize=function(){for(var e=[],n=0;n<this.shapeArr.length;n++)e.push(this.shapeArr[n].serialize());return{type:["static","kinetic","dynamic"][this.type],name:this.name,position:this.xf.t,angle:this.xf.a,shapes:e}};tt.prototype.isStatic=function(){return this.type==tt.STATIC};tt.prototype.isDynamic=function(){return this.type==tt.DYNAMIC};tt.prototype.isKinetic=function(){return this.type==tt.KINETIC};tt.prototype.setType=function(e){e!=this.type&&(this.f.set(0,0),this.v.set(0,0),this.t=0,this.w=0,this.type=e,this.awake(!0))};tt.prototype.addShape=function(e){e.body=this,this.shapeArr.push(e),this.awake(!0),this.cacheData()};tt.prototype.removeShape=function(e){var n=this.shapeArr.indexOf(e);n!=-1&&(this.shapeArr.splice(n,1),e.body=void 0,this.awake(!0),this.cacheData())};tt.prototype.setMass=function(e){this.m=e,this.m_inv=e>0?1/e:0};tt.prototype.setInertia=function(e){this.i=e,this.i_inv=e>0?1/e:0};tt.prototype.setTransform=function(e,n){this.xf.set(e,n),this.p=this.xf.transform(this.centroid),this.a=n};tt.prototype.syncTransform=function(){this.xf.setRotation(this.a),this.xf.setPosition(l.sub(this.p,this.xf.rotate(this.centroid)))};tt.prototype.getWorldPoint=function(e){return this.xf.transform(e)};tt.prototype.getWorldVector=function(e){return this.xf.rotate(e)};tt.prototype.getLocalPoint=function(e){return this.xf.untransform(e)};tt.prototype.getLocalVector=function(e){return this.xf.unrotate(e)};tt.prototype.setFixedRotation=function(e){this.fixedRotation=e,this.resetMassData()};tt.prototype.resetMassData=function(){if(this.centroid.set(0,0),this.m=0,this.m_inv=0,this.i=0,this.i_inv=0,!this.isDynamic()){this.p=this.xf.transform(this.centroid);return}for(var e=new l(0,0),n=0,h=0,c=0;c<this.shapeArr.length;c++){var p=this.shapeArr[c],v=p.centroid(),y=p.area()*p.density,b=p.inertia(y);e.mad(v,y),n+=y,h+=b}this.centroid.copy(l.scale(e,1/n)),this.setMass(n),this.fixedRotation||this.setInertia(h-n*l.dot(this.centroid,this.centroid));var g=this.p;this.p=this.xf.transform(this.centroid),this.v.mad(l.perp(l.sub(this.p,g)),this.w)};tt.prototype.resetJointAnchors=function(){for(var e=0;e<this.jointArr.length;e++){var n=this.jointArr[e];if(n){var h=n.getWorldAnchor1(),c=n.getWorldAnchor2();n.setWorldAnchor1(h),n.setWorldAnchor2(c)}}};tt.prototype.cacheData=function(){this.bounds.clear();for(var e=0;e<this.shapeArr.length;e++){var n=this.shapeArr[e];n.cacheData(this.xf),this.bounds.addBounds(n.bounds)}};tt.prototype.updateVelocity=function(e,n,h){this.v=l.mad(this.v,l.mad(e,this.f,this.m_inv),n),this.w=this.w+this.t*this.i_inv*n,this.v.scale(St(1-n*(h+this.linearDamping),0,1)),this.w*=St(1-n*(h+this.angularDamping),0,1),this.f.set(0,0),this.t=0};tt.prototype.updatePosition=function(e){this.p.addself(l.scale(this.v,e)),this.a+=this.w*e};tt.prototype.resetForce=function(){this.f.set(0,0),this.t=0};tt.prototype.applyForce=function(e,n){this.isDynamic()&&(this.isAwake()||this.awake(!0),this.f.addself(e),this.t+=l.cross(l.sub(n,this.p),e))};tt.prototype.applyForceToCenter=function(e){this.isDynamic()&&(this.isAwake()||this.awake(!0),this.f.addself(e))};tt.prototype.applyTorque=function(e){this.isDynamic()&&(this.isAwake()||this.awake(!0),this.t+=e)};tt.prototype.applyLinearImpulse=function(e,n){this.isDynamic()&&(this.isAwake()||this.awake(!0),this.v.mad(e,this.m_inv),this.w+=l.cross(l.sub(n,this.p),e)*this.i_inv)};tt.prototype.applyAngularImpulse=function(e){this.isDynamic()&&(this.isAwake()||this.awake(!0),this.w+=e*this.i_inv)};tt.prototype.kineticEnergy=function(){var e=this.v.dot(this.v),n=this.w*this.w;return .5*(this.m*e+this.i*n)};tt.prototype.isAwake=function(){return this.awaked};tt.prototype.awake=function(e){this.awaked=e,e?this.sleepTime=0:(this.v.set(0,0),this.w=0,this.f.set(0,0),this.t=0)};tt.prototype.isCollidable=function(e){if(this==e||!this.isDynamic()&&!e.isDynamic()||!(this.maskBits&e.categoryBits)||!(e.maskBits&this.categoryBits))return!1;for(var n=0;n<this.jointArr.length;n++){var h=this.jointArr[n];if(h&&!h.collideConnected&&e.jointHash[h.id]!=null)return!1}return!0};tt.prototype.translateWithDelta=function(e){var n=this.xf.t.duplicate();n.x+=e.x,n.y+=e.y,this.setTransform(n,this.a),this.resetJointAnchors(),this.awake(!0),this.cacheData()};var I=function(e,n,h,c){arguments.length!=0&&(I.id_counter==null&&(I.id_counter=0),this.id=I.id_counter++,this.type=e,this.body1=n,this.body2=h,this.collideConnected=c,this.maxForce=9999999999,this.breakable=!1)};I.TYPE_ANGLE=I.prototype.TYPE_ANGLE=0;I.TYPE_REVOLUTE=I.prototype.TYPE_REVOLUTE=1;I.TYPE_WELD=I.prototype.TYPE_WELD=2;I.TYPE_WHEEL=I.prototype.TYPE_WHEEL=3;I.TYPE_PRISMATIC=I.prototype.TYPE_PRISMATIC=4;I.TYPE_DISTANCE=I.prototype.TYPE_DISTANCE=5;I.TYPE_ROPE=I.prototype.TYPE_ROPE=6;I.TYPE_MOUSE=I.prototype.TYPE_MOUSE=7;I.LINEAR_SLOP=8e-4;I.ANGULAR_SLOP=Ce(2);I.MAX_LINEAR_CORRECTION=.5;I.MAX_ANGULAR_CORRECTION=Ce(8);I.LIMIT_STATE_INACTIVE=0;I.LIMIT_STATE_AT_LOWER=1;I.LIMIT_STATE_AT_UPPER=2;I.LIMIT_STATE_EQUAL_LIMITS=3;I.prototype.getWorldAnchor1=function(){return this.body1.getWorldPoint(this.anchor1)};I.prototype.getWorldAnchor2=function(){return this.body2.getWorldPoint(this.anchor2)};I.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e)};I.prototype.setWorldAnchor2=function(e){this.anchor2=this.body2.getLocalPoint(e)};function Gt(e,n){this.shape1=e,this.shape2=n,this.contactArr=[],this.e=1,this.u=1}Gt.COLLISION_SLOP=8e-4;Gt.BAUMGARTE=.28;Gt.MAX_LINEAR_CORRECTION=1;Gt.prototype.update=function(e){for(var n=0;n<e.length;n++){for(var h=e[n],c=-1,p=0;p<this.contactArr.length;p++)if(h.hash==this.contactArr[p].hash){c=p;break}c>-1&&(h.lambda_n_acc=this.contactArr[c].lambda_n_acc,h.lambda_t_acc=this.contactArr[c].lambda_t_acc)}this.contactArr=e};Gt.prototype.initSolver=function(e){for(var n=this.shape1.body,h=this.shape2.body,c=n.m_inv+h.m_inv,p=0;p<this.contactArr.length;p++){var v=this.contactArr[p];v.r1=l.sub(v.p,n.p),v.r2=l.sub(v.p,h.p),v.r1_local=n.xf.unrotate(v.r1),v.r2_local=h.xf.unrotate(v.r2);var y=v.n,b=l.perp(v.n),g=l.cross(v.r1,y),M=l.cross(v.r2,y),k=c+n.i_inv*g*g+h.i_inv*M*M;v.emn=k==0?0:1/k;var U=l.cross(v.r1,b),O=l.cross(v.r2,b),Z=c+n.i_inv*U*U+h.i_inv*O*O;v.emt=Z==0?0:1/Z;var L=l.mad(n.v,l.perp(v.r1),n.w),R=l.mad(h.v,l.perp(v.r2),h.w),B=l.sub(R,L);v.bounce=l.dot(B,v.n)*this.e}};Gt.prototype.warmStart=function(){for(var e=this.shape1.body,n=this.shape2.body,h=0;h<this.contactArr.length;h++){var c=this.contactArr[h],p=c.n,v=c.lambda_n_acc,y=c.lambda_t_acc,b=new l(v*p.x-y*p.y,y*p.x+v*p.y);e.v.mad(b,-e.m_inv),e.w-=l.cross(c.r1,b)*e.i_inv,n.v.mad(b,n.m_inv),n.w+=l.cross(c.r2,b)*n.i_inv}};Gt.prototype.solveVelocityConstraints=function(){for(var e=this.shape1.body,n=this.shape2.body,h=e.m_inv,c=e.i_inv,p=n.m_inv,v=n.i_inv,y=0;y<this.contactArr.length;y++){var b=this.contactArr[y],g=b.n,M=l.perp(g),k=b.r1,U=b.r2,O=l.mad(e.v,l.perp(k),e.w),Z=l.mad(n.v,l.perp(U),n.w),L=l.sub(Z,O),R=-b.emn*(l.dot(g,L)+b.bounce),B=b.lambda_n_acc;b.lambda_n_acc=Math.max(B+R,0),R=b.lambda_n_acc-B;var V=-b.emt*l.dot(M,L),H=b.lambda_n_acc*this.u,W=b.lambda_t_acc;b.lambda_t_acc=St(W+V,-H,H),V=b.lambda_t_acc-W;var J=new l(R*g.x-V*g.y,V*g.x+R*g.y);e.v.mad(J,-h),e.w-=l.cross(k,J)*c,n.v.mad(J,p),n.w+=l.cross(U,J)*v}};Gt.prototype.solvePositionConstraints=function(){for(var e=this.shape1.body,n=this.shape2.body,h=e.m_inv,c=e.i_inv,p=n.m_inv,v=n.i_inv,y=h+p,b=0,g=0;g<this.contactArr.length;g++){var M=this.contactArr[g],k=M.n,U=l.rotate(M.r1_local,e.a),O=l.rotate(M.r2_local,n.a),Z=l.add(e.p,U),L=l.add(n.p,O),R=l.sub(L,Z),B=l.dot(R,k)+M.d,V=St(Gt.BAUMGARTE*(B+Gt.COLLISION_SLOP),-Gt.MAX_LINEAR_CORRECTION,0);if(V!=0){b=Math.max(b,-B);var H=l.cross(U,k),W=l.cross(O,k),J=y+e.i_inv*H*H+n.i_inv*W*W,G=J==0?0:-V/J,K=l.scale(k,G);e.p.mad(K,-h),e.a-=H*G*c,n.p.mad(K,p),n.a+=W*G*v}}return b<=Gt.COLLISION_SLOP*3};var Xt={};function yt(e){this.renderer=e,this.bodyArr=[],this.jointArr=[],this.jointHash={},this.numContacts=0,this.contactSolverArr=[],this.postSolve=function(n){},this.gravity=new l(0,0),this.damping=0}yt.TIME_TO_SLEEP=.5;yt.SLEEP_LINEAR_TOLERANCE=.5;yt.SLEEP_ANGULAR_TOLERANCE=Ce(2);yt.prototype.clear=function(){for(nt.id_counter=0,tt.id_counter=0,I.id_counter=0;this.jointArr.length;)this.removeJoint(this.jointArr[this.jointArr.length-1]);for(;this.bodyArr.length;)this.removeBody(this.bodyArr[this.bodyArr.length-1]);this.bodyArr=[],this.jointArr=[],this.jointHash={},this.contactSolverArr=[],this.stepCount=0};yt.prototype.toJSON=function(e){for(var n=[],h=0;h<this.bodyArr.length;h++)this.bodyArr[h]&&n.push(this.bodyArr[h].serialize());for(var c=[],h=0;h<this.jointArr.length;h++)this.jointArr[h]&&c.push(this.jointHash[h].serialize());return{bodies:n,joints:c}};yt.prototype.create=function(e){var n=JSON.parse(e);this.clear();for(var h=0;h<n.bodies.length;h++){for(var c=n.bodies[h],p={static:tt.STATIC,kinetic:tt.KINETIC,dynamic:tt.DYNAMIC}[c.type],v=new tt(p,c.position.x,c.position.y,c.angle),y=0;y<c.shapes.length;y++){var b=c.shapes[y],g;switch(b.type){case"ShapeCircle":g=new Ft(b.center.x,b.center.y,b.radius);break;case"ShapeSegment":g=new It(b.a,b.b,b.radius);break;case"ShapePoly":g=new kt(b.verts);break}g.e=b.e,g.u=b.u,g.density=b.density,v.addShape(g)}v.resetMassData(),this.addBody(v)}for(var h=0;h<n.joints.length;h++){var M=n.joints[h],k=this.bodyArr.find(L=>L.id===M.body1.id),U=this.bodyArr.find(L=>L.id===M.body2.id),O;switch(M.type){case"AngleJoint":O=new AngleJoint(k,U);break;case"RevoluteJoint":O=new RevoluteJoint(k,U,M.anchor),O.enableLimit(M.limitEnabled),O.setLimits(M.limitLowerAngle,M.limitUpperAngle),O.enableMotor(M.motorEnabled),O.setMotorSpeed(M.motorSpeed),O.setMaxMotorTorque(M.maxMotorTorque);break;case"WeldJoint":O=new WeldJoint(k,U,M.anchor),O.setSpringFrequencyHz(M.frequencyHz),O.setSpringDampingRatio(M.dampingRatio);break;case"WheelJoint":O=new WheelJoint(k,U,M.anchor1,M.anchor2),O.enableMotor(M.motorEnabled),O.setMotorSpeed(M.motorSpeed),O.setMaxMotorTorque(M.maxMotorTorque);break;case"PrismaticJoint":O=new PrismaticJoint(k,U,M.anchor1,M.anchor2);break;case"DistanceJoint":O=new DistanceJoint(k,U,M.anchor1,M.anchor2),O.setSpringFrequencyHz(M.frequencyHz),O.setSpringDampingRatio(M.dampingRatio);break;case"RopeJoint":O=new RopeJoint(k,U,M.anchor1,M.anchor2);break}O.collideConnected=M.collideConnected,O.maxForce=M.maxForce,O.breakable=M.breakable,this.addJoint(O)}};yt.prototype.addBody=function(e){var n;this.bodyArr.find(h=>h.id===e.id)||(this.bodyArr.push(e),(n=this.renderer)==null||n.addBody(e),e.awake(!0),e.world=this,e.cacheData())};yt.prototype.removeBody=function(e){var c;var n=this.bodyArr.findIndex(p=>p.id===e.id);if(n!==-1){(c=this.renderer)==null||c.removeBody(e);for(var h=0;h<e.jointArr.length;h++)this.removeJoint(e.jointArr[h]);e.world=null,this.bodyArr.splice(n,1)}};yt.prototype.addJoint=function(e){this.jointHash[e.id]==null&&(this.jointHash[e.id]=e,e.body1.jointHash[e.id]=e,e.body2.jointHash[e.id]=e,this.jointArr.push(e),e.body1.jointArr.push(e),e.body2.jointArr.push(e),e.body1.awake(!0),e.body2.awake(!0),this.renderer.addJoint(e))};yt.prototype.removeJoint=function(e){if(this.jointHash[e.id]!=null){delete this.jointHash[e.id],delete e.body1.jointHash[e.id],delete e.body2.jointHash[e.id];var n=this.jointArr.findIndex(h=>h.id===e.id);this.jointArr.splice(n,1);var n=e.body1.jointArr.findIndex(h=>h.id===e.id);e.body1.jointArr.splice(n,1);var n=e.body2.jointArr.findIndex(h=>h.id===e.id);e.body2.jointArr.splice(n,1),e.body1.awake(!0),e.body2.awake(!0),this.renderer.removeJoint(e)}};yt.prototype.findShapeByPoint=function(e,n){for(var h,c=0;c<this.bodyArr.length;c++){var p=this.bodyArr[c];if(p)for(var v=0;v<p.shapeArr.length;v++){var y=p.shapeArr[v];if(y.pointQuery(e)){if(!n)return y;h||(h=y),y==n&&(n=null)}}}return h};yt.prototype.findBodyByPoint=function(e,n){for(var h,c=0;c<this.bodyArr.length;c++){var p=this.bodyArr[c];if(p)for(var v=0;v<p.shapeArr.length;v++){var y=p.shapeArr[v];if(y.pointQuery(e)){if(!n)return y.body;h||(h=y.body),y.body==n&&(n=null);break}}}return h};yt.prototype.shapeById=function(e){for(var n,h=0;h<this.bodyArr.length;h++){var c=this.bodyArr[h];if(c){for(var p=0;p<c.shapeArr.length;p++)if(c.shapeArr[p].id==e)return c.shapeArr[p]}}return null};yt.prototype.jointById=function(e){var n=this.jointHash[e];return n!=null?this.jointArr[n]:null};yt.prototype.findVertexByPoint=function(e,n,h){var c=-1;h=h||-1;for(var p=0;p<this.bodyArr.length;p++){var v=this.bodyArr[p];if(v)for(var y=0;y<v.shapeArr.length;y++){var b=v.shapeArr[y],g=b.findVertexByPoint(e,n);if(g!=-1){var M=b.id<<16|g;if(h==-1)return M;c==-1&&(c=M),M==h&&(h=-1)}}}return c};yt.prototype.findEdgeByPoint=function(e,n,h){var c=-1;h=h||-1;for(var p=0;p<this.bodyArr.length;p++){var v=this.bodyArr[p];if(v)for(var y=0;y<v.shapeArr.length;y++){var b=v.shapeArr[y];if(b.type==nt.TYPE_POLY){var g=b.findEdgeByPoint(e,n);if(g!=-1){var M=b.id<<16|g;if(h==-1)return M;c==-1&&(c=M),M==h&&(h=-1)}}}}return c};yt.prototype.findJointByPoint=function(e,n,h){var c=-1,p=n*n;h=h||-1;for(var v=0;v<this.jointArr.length;v++){var y=this.jointArr[v];if(y){var b=-1;if(l.distsq(e,y.getWorldAnchor1())<p?b=y.id<<16|0:l.distsq(e,y.getWorldAnchor2())<p&&(b=y.id<<16|1),b!=-1){if(h==-1)return b;c==-1&&(c=b),b==h&&(h=-1)}}}return c};yt.prototype.findContactSolver=function(e,n){for(var h=0;h<this.contactSolverArr.length;h++){var c=this.contactSolverArr[h];if(e==c.shape1&&n==c.shape2)return c}return null};yt.prototype.genTemporalContactSolvers=function(){var e=Date.now(),n=[];this.numContacts=0;for(var h=0;h<this.bodyArr.length;h++){var c=this.bodyArr[h];if(c){c.stepCount=this.stepCount;for(var p=0;p<this.bodyArr.length;p++){var v=this.bodyArr[p];if(v&&c.stepCount!=v.stepCount){var y=c.isAwake()&&!c.isStatic(),b=v.isAwake()&&!v.isStatic();if(!(!y&&!b)&&c.isCollidable(v)&&c.bounds.intersectsBounds(v.bounds))for(var g=0;g<c.shapeArr.length;g++)for(var M=0;M<v.shapeArr.length;M++){var k=c.shapeArr[g],U=v.shapeArr[M],O=[];if(Re.collide(k,U,O)){if(k.type>U.type){var Z=k;k=U,U=Z}this.numContacts+=O.length;var L=this.findContactSolver(k,U);if(L)L.update(O),n.push(L);else{c.awake(!0),v.awake(!0);var R=new Gt(k,U);R.contactArr=O,R.e=Math.max(k.e,U.e),R.u=Math.sqrt(k.u*U.u),n.push(R)}}}}}}}return Xt.timeCollision=Date.now()-e,n};yt.prototype.initSolver=function(e,n,h){for(var c=Date.now(),p=0;p<this.contactSolverArr.length;p++)this.contactSolverArr[p].initSolver(n);for(var p=0;p<this.jointArr.length;p++)this.jointArr[p]&&this.jointArr[p].initSolver(e,h);if(h)for(var p=0;p<this.contactSolverArr.length;p++)this.contactSolverArr[p].warmStart();Xt.timeInitSolver=Date.now()-c};yt.prototype.velocitySolver=function(e){for(var n=Date.now(),h=0;h<e;h++){for(var c=0;c<this.jointArr.length;c++)this.jointArr[c].solveVelocityConstraints();for(var c=0;c<this.contactSolverArr.length;c++)this.contactSolverArr[c].solveVelocityConstraints()}Xt.timeVelocitySolver=Date.now()-n};yt.prototype.positionSolver=function(e){var n=Date.now(),h=!1;Xt.positionIterations=0;for(var c=0;c<e;c++){for(var p=!0,v=!0,y=0;y<this.contactSolverArr.length;y++){var b=this.contactSolverArr[y].solvePositionConstraints();p=b&&p}for(var y=0;y<this.jointArr.length;y++)if(this.jointArr[y]){var g=this.jointArr[y].solvePositionConstraints();v=g&&v}if(p&&v){h=!0;break}Xt.positionIterations++}return Xt.timePositionSolver=Date.now()-n,h};yt.prototype.step=function(e,n,h,c,p){var v=1/e;this.stepCount++,this.contactSolverArr=this.genTemporalContactSolvers(),this.initSolver(e,v,c);for(var y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.isDynamic()&&b.isAwake()&&b.updateVelocity(this.gravity,e,this.damping)}for(var y=0;y<this.jointArr.length;y++){var g=this.jointArr[y];if(g){var M=g.body1,k=g.body2,U=M.isAwake()&&!M.isStatic(),O=k.isAwake()&&!k.isStatic();U^O&&(U||M.awake(!0),O||k.awake(!0))}}this.velocitySolver(n);for(var y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.isDynamic()&&b.isAwake()&&b.updatePosition(e)}for(var y=0;y<this.jointArr.length;y++){var g=this.jointArr[y];g&&g.breakable&&g.getReactionForce(v).lengthsq()>=g.maxForce*g.maxForce&&this.removeJoint(g)}for(var Z=this.positionSolver(h),y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.syncTransform()}for(var y=0;y<this.contactSolverArr.length;y++){var L=this.contactSolverArr[y];this.postSolve(L)}for(var y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.isDynamic()&&b.isAwake()&&b.cacheData()}if(p){for(var R=999999,B=yt.SLEEP_LINEAR_TOLERANCE*yt.SLEEP_LINEAR_TOLERANCE,V=yt.SLEEP_ANGULAR_TOLERANCE*yt.SLEEP_ANGULAR_TOLERANCE,y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.isDynamic()&&(b.w*b.w>V||b.v.dot(b.v)>B?(b.sleepTime=0,R=0):(b.sleepTime+=e,R=Math.min(R,b.sleepTime)))}if(Z&&R>=yt.TIME_TO_SLEEP)for(var y=0;y<this.bodyArr.length;y++){var b=this.bodyArr[y];b&&b.awake(!1)}}};yt.prototype.getBounds=function(){for(var e=new Et,n=0;n<this.bodyArr.length;n++)for(var h=0;h<this.bodyArr[n].shapeArr.length;h++)e.addBounds(this.bodyArr[n].shapeArr[h].bounds);return e};var Kt=function(e,n,h){arguments.length!=0&&(I.call(this,I.TYPE_MOUSE,e,n,!0),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(h),this.gamma=0,this.beta_c=0,this.frequencyHz=5,this.dampingRatio=.9,this.lambda_acc=new l(0,0))};Kt.prototype=new I;Kt.prototype.constructor=Kt;Kt.prototype.setSpringFrequencyHz=function(e){this.frequencyHz=e};Kt.prototype.setSpringDampingRatio=function(e){this.dampingRatio=e};Kt.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e;var p=2*Math.PI*this.frequencyHz,v=c.m*(p*p),y=c.m*2*this.dampingRatio*p;this.gamma=(y+v*e)*e,this.gamma=this.gamma==0?0:1/this.gamma;var b=e*v*this.gamma;this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var g=this.r2,M=g.y*c.i_inv,k=c.m_inv+g.y*M+this.gamma,U=-g.x*M,O=c.m_inv+g.x*g.x*c.i_inv+this.gamma;this.em_inv=new Ct(k,U,U,O);var Z=l.sub(l.add(c.p,this.r2),h.p);this.beta_c=l.scale(Z,b),c.w*=.98,n?(c.v.mad(this.lambda_acc,c.m_inv),c.w+=l.cross(this.r2,this.lambda_acc)*c.i_inv):this.lambda_acc.set(0,0)};Kt.prototype.solveVelocityConstraints=function(){var e=this.body2,n=l.mad(e.v,l.perp(this.r2),e.w),h=l.mad(this.beta_c,this.lambda_acc,this.gamma),c=this.em_inv.solve(l.add(n,h).neg()),p=this.lambda_acc.duplicate();this.lambda_acc.addself(c);var v=this.lambda_acc.lengthsq();v>this.maxImpulse*this.maxImpulse&&this.lambda_acc.scale(this.maxImpulse/Math.sqrt(v)),c=l.sub(this.lambda_acc,p),e.v.mad(c,e.m_inv),e.w+=l.cross(this.r2,c)*e.i_inv};Kt.prototype.solvePositionConstraints=function(){return!0};Kt.prototype.getReactionForce=function(e){return l.scale(this.lambda_acc,e)};Kt.prototype.getReactionTorque=function(e){return 0};var Ne=Symbol("app"),Me=Symbol("pause"),me=Symbol("events"),ts=["beforeRenderBody","beforeRenderShape","beforeRenderFrame","afterRenderFrame"],Zr=(e,n,h,c)=>Object.defineProperty(e,n,{get(){return this[h]},set:c});function ce(e,n){this.renderer=e,this[Ne]=n,this[me]={},this.settings=Object.assign({gravity:new l(0,-10),frameRateHz:60,velocityIterations:8,positionIterations:4,warmStarting:!0,allowSleep:!0,backgroundColor:"rgb(95, 105, 118)",jointAnchorColor:"#11cf00"},n.settings||{});let h=this.camera=Object.assign({},n.camera||{}),c={showJoints:!0};Object.defineProperty(this.settings,"showJoints",{get(){return c.showJoints},set(p){e.joints_group.visible=c.showJoints=p}}),Re.init(),this.world=new yt(e),this.resetScene(),Zr(this,"app",Ne,p=>{this[Ne]=p,this.settings=Object.assign(this.settings,p.settings||{}),this.camera=Object.assign(this.camera,p.camera||{}),this.resetScene(),this[Me]&&this.start()}),Zr(this,"pause",Me,p=>{p?this[Me]=!0:this.start()}),this.onResize=()=>{this.renderer.resize(),this[Me]&&this.drawFrame(0)},window.addEventListener("resize",this.onResize),window.addEventListener("orientationchange",this.onResize),this.onResize(),this.start()}ce.prototype.start=function(){this[Me]=!1;let e=()=>{this.runFrame(),this[Me]||window.requestAnimationFrame(e)};window.requestAnimationFrame(e)};ce.prototype.destroy=function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("orientationchange",this.onResize),this[Me]=!0,this.world.clear()};ce.prototype.resetScene=function(){this.world.clear(),this.world.gravity.copy(this.settings.gravity),this[Ne].init(this.world,this),this.initFrame()};ce.prototype.initFrame=function(){this.time={fps:0,fps_frameCount:0,fps_time:0,frameCount:0,lastTime:Date.now(),timeDelta:0}};ce.prototype.runFrame=function(){var e=Date.now(),n=(e-this.time.lastTime)/1e3;n=Math.floor(n*60+.5)/60,this.time.lastTime=e;var h=1/this.settings.frameRateHz;this.time.timeDelta+=n,this[Me]&&(this.time.timeDelta=h),Xt.timeStep=0,Xt.stepCount=0;for(var c=4;c>0&&this.time.timeDelta>=h;c--){var p=Date.now();this.world.step(h,this.settings.velocityIterations,this.settings.positionIterations,this.settings.warmStarting,this.settings.allowSleep),Xt.timeStep+=Date.now()-p,Xt.stepCount++,this.time.timeDelta-=h}this.time.timeDelta>h&&(this.time.timeDelta=0),this[Ne].runFrame&&this[Ne].runFrame(),Xt.stepCount>0&&this.render(n),this.time.frameCount++,this.time.fps_frameCount++,this.time.fps_time+=n,this.time.fps_time>=1&&(this.time.fps=this.time.fps_frameCount/this.time.fps_time,this.time.fps_time-=1,this.time.fps_frameCount=0)};ce.prototype.render=function(e){var n=Date.now();this.drawFrame(e),Xt.timeDrawFrame=Date.now()-n};ce.prototype.redraw=function(){this.drawFrame(0)};ce.prototype.drawFrame=function(e=0){var c,p,v,y,b,g,M;(p=(c=this[me])==null?void 0:c.beforeRenderFrame)==null||p.forEach(k=>k(e));for(var n=0;n<this.world.bodyArr.length;n++){var h=this.world.bodyArr[n];(y=(v=this[me])==null?void 0:v.beforeRenderBody)==null||y.forEach(k=>k(h)),this.renderer.updateBody(h)}for(var n=0;n<this.world.jointArr.length;n++)(b=this.renderer)==null||b.updateJoint(this.world.jointArr[n]);(M=(g=this[me])==null?void 0:g.afterRenderFrame)==null||M.forEach(k=>k(e))};ce.prototype.on=function(e,n){if(!ts.includes(e))throw'Unknown event "'.concat(e,'"');if(this[me][e]){if(this[me][e].find(h=>h===n))return}else this[me][e]=[];this[me][e].push(n)};ce.prototype.off=function(e,n){if(!ts.includes(e))throw'Unknown event "'.concat(e,'"');if(!this[me][e])return;let h=this[me][e].findIndex(c=>c===n);h!==-1&&this[me][e].splice(h,1)};var rn=bi(Kr()?8:4),Qt=Symbol("events"),es=["mousedown","mouseup","mousemove"];function Be(e,n){if(this.settings=Object.assign({pick:!0,zoom:!0},n||{}),this.runner=e,this.runner.interaction=this,this.SELECTABLE_LINE_DIST_THREHOLD=rn,this.state={mouseDown:!1,pointerDownMoving:!1},this.mouseJoint=null,this.mouseBody=new tt(tt.KINETIC),this.mouseBody.resetMassData(),this.runner.world.addBody(this.mouseBody),this[Qt]={},!this.runner.renderer.two)return;var h=this.runner.renderer,c=this;let{Two:p,two:v,stage:y,camera:b}=h;var g=v.renderer.domElement,M=new p.Vector,k={},U=0,O=!1;let Z=(E,lt)=>{var Yt,qt;c.removeJoint();let ft=b.screenToWorld(E,lt),N=new l(ft.x,-ft.y);O=e.world.findBodyByPoint(N);var Q=!1;(qt=(Yt=this[Qt])==null?void 0:Yt.mousedown)!=null&&qt.length&&(this[Qt].mousedown.forEach(xt=>{xt(O,new l(E,lt),N)&&(Q=!0)}),this.runner.pause&&this.runner.drawFrame(0)),Q?(O=void 0,this.state.mouseDown=!1):this.settings.pick&&O&&(O.isStatic()?O=void 0:L(N))},L=E=>{c.mouseBody.p.copy(E),c.mouseBody.syncTransform(),c.mouseJoint=new Kt(c.mouseBody,O,E),c.mouseJoint.maxForce=O.m*5e4,e.world.addJoint(c.mouseJoint)},R=E=>{this.state.mouseDown=!0,this.state.pointerDownMoving=!1,M.x=E.clientX,M.y=E.clientY,Z(E.offsetX,E.offsetY)},B=E=>{var N,Q;if(this.state.mouseDown)if(this.state.pointerDownMoving=!0,O){let Yt=b.screenToWorld(E.offsetX,E.offsetY),qt=new l(Yt.x,-Yt.y);c.mouseBody.p.copy(qt),c.mouseBody.syncTransform()}else{var lt=E.clientX-M.x,ft=E.clientY-M.y;b.translateSurface(lt,ft),M.set(E.clientX,E.clientY)}if((Q=(N=this[Qt])==null?void 0:N.mousemove)!=null&&Q.length){let Yt=e.renderer.canvas.getBoundingClientRect(),qt=b.screenToWorld(E.offsetX,E.offsetY),xt=new l(qt.x,-qt.y);this[Qt].mousemove.forEach(ae=>ae(new l(E.offsetX,E.offsetY),xt)),this.runner.pause&&this.runner.drawFrame(0)}},V=E=>{var N,Q;if((Q=(N=this[Qt])==null?void 0:N.mouseup)!=null&&Q.length){let Yt=e.renderer.canvas.getBoundingClientRect();var lt=E.offsetX-Yt.left,ft=E.offsetY-Yt.top;let qt=b.screenToWorld(lt,ft),xt=new l(qt.x,-qt.y);this[Qt].mouseup.forEach(ae=>ae(E.type=="mouseleave"?void 0:e.world.findBodyByPoint(xt),new l(lt,ft),xt,this.state.pointerDownMoving))}this.state.mouseDown=!1,c.removeJoint()},H=E=>{V(E)},W=E=>{var lt=(E.wheelDeltaY||-E.deltaY)/1e3,ft=g.getBoundingClientRect();b.zoomBy(lt,E.clientX-ft.left,E.clientY-ft.top),E.preventDefault()},J=E=>{switch(E.touches.length){case 2:pt(E);break;case 1:ht(E);break}E.preventDefault()},G=E=>{switch(E.touches.length){case 2:fe(E);break;case 1:At(E);break}E.preventDefault()},K=E=>{c.removeJoint(),k={};var lt=E.touches[0];lt&&(M.x=lt.clientX,M.y=lt.clientY),E.preventDefault()},ht=E=>{var lt=E.touches[0];M.x=lt.clientX,M.y=lt.clientY;var ft=e.renderer.canvas.getBoundingClientRect();Z(M.x-ft.left,M.y-ft.top)},At=E=>{var lt=E.touches[0];if(O){let Q=e.renderer.canvas.getBoundingClientRect(),Yt=b.screenToWorld(lt.clientX-Q.left,lt.clientY-Q.top),qt=new l(Yt.x,-Yt.y);c.mouseBody.p.copy(qt),c.mouseBody.syncTransform()}else{var ft=lt.clientX-M.x,N=lt.clientY-M.y;b.translateSurface(ft,N),M.set(lt.clientX,lt.clientY)}},pt=E=>{var[lt,ft]=E.touches,N=ft.clientX-lt.clientX,Q=ft.clientY-lt.clientY;U=Math.sqrt(N*N+Q*Q),M.x=N/2+lt.clientX,M.y=Q/2+lt.clientY},fe=E=>{var[lt,ft]=E.touches,N=ft.clientX-lt.clientX,Q=ft.clientY-lt.clientY,Yt=N/2+lt.clientX,qt=Q/2+lt.clientY;b.translateSurface(Yt-M.x,qt-M.y),M.x=Yt,M.y=qt;var xt=Math.sqrt(N*N+Q*Q),ae=xt-U,xe=g.getBoundingClientRect();b.zoomBy(ae/250,M.x-xe.left,M.y-xe.top),U=xt};g.addEventListener("mousedown",R,!1),g.addEventListener("mouseleave",H,!1),g.addEventListener("mousewheel",W,!1),g.addEventListener("wheel",W,!1),g.addEventListener("touchstart",J,!1),g.addEventListener("touchmove",G,!1),g.addEventListener("touchend",K,!1),g.addEventListener("touchcancel",K,!1),g.addEventListener("mousemove",B,!1),window.addEventListener("mouseup",V,!1)}Be.prototype.destroy=function(){this.removeJoint(),this.runner.world.removeBody(this.mouseBody)};Be.prototype.removeJoint=function(){this.mouseJoint&&(this.runner.world.removeJoint(this.mouseJoint),this.mouseJoint=null)};Be.prototype.on=function(e,n){if(!es.includes(e))throw'Unknown event "'.concat(e,'"');if(this[Qt][e]){if(this[Qt][e].find(h=>h===n))return}else this[Qt][e]=[];this[Qt][e].push(n)};Be.prototype.off=function(e,n){if(!es.includes(e))throw'Unknown event "'.concat(e,'"');if(!this[Qt][e])return;let h=this[Qt][e].findIndex(c=>c===n);h!==-1&&this[Qt][e].splice(h,1)};var ie=function(e,n,h,c){I.call(this,I.TYPE_ROPE,e,n,!0),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(c),this.maxDistance=l.dist(h,c),this.lambda_acc=0};ie.prototype=new I;ie.prototype.constructor=ie;ie.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e),this.maxDistance=l.dist(e,this.getWorldAnchor2())};ie.prototype.setWorldAnchor2=function(e){this.anchor2=this.body2.getLocalPoint(e),this.maxDistance=l.dist(e,this.getWorldAnchor1())};ie.prototype.serialize=function(){return{type:"RopeJoint",body1:this.body1.id,body2:this.body2.id,anchor1:this.body1.getWorldPoint(this.anchor1),anchor2:this.body2.getWorldPoint(this.anchor2),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable}};ie.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e,this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var p=l.sub(l.add(c.p,this.r2),l.add(h.p,this.r1));this.distance=p.length();var v=this.distance-this.maxDistance;v>0?(this.cdt=0,this.limitState=I.LIMIT_STATE_AT_UPPER):(this.cdt=v/e,this.limitState=I.LIMIT_STATE_INACTIVE),this.distance>I.LINEAR_SLOP?this.u=l.scale(p,1/this.distance):this.u=l.zero,this.s1=l.cross(this.r1,this.u),this.s2=l.cross(this.r2,this.u);var y=h.m_inv+c.m_inv+h.i_inv*this.s1*this.s1+c.i_inv*this.s2*this.s2;if(this.em=y==0?0:1/y,n){var b=l.scale(this.u,this.lambda_acc);h.v.mad(b,-h.m_inv),h.w-=this.s1*this.lambda_acc*h.i_inv,c.v.mad(b,c.m_inv),c.w+=this.s2*this.lambda_acc*c.i_inv}else this.lambda_acc=0};ie.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2,h=this.u.dot(l.sub(n.v,e.v))+this.s2*n.w-this.s1*e.w,c=-this.em*(h+this.cdt),p=this.lambda_acc;this.lambda_acc=Math.min(p+c,0),c=this.lambda_acc-p;var v=l.scale(this.u,c);e.v.mad(v,-e.m_inv),e.w-=this.s1*c*e.i_inv,n.v.mad(v,n.m_inv),n.w+=this.s2*c*n.i_inv};ie.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=l.rotate(l.sub(this.anchor1,e.centroid),e.a),c=l.rotate(l.sub(this.anchor2,n.centroid),n.a),p=l.sub(l.add(n.p,c),l.add(e.p,h)),v=p.length(),y=l.scale(p,1/v),b=v-this.maxDistance,g=St(b,0,I.MAX_LINEAR_CORRECTION),M=l.cross(h,y),k=l.cross(c,y),U=e.m_inv+n.m_inv+e.i_inv*M*M+n.i_inv*k*k,O=U==0?0:-g/U,Z=l.scale(y,O);return e.p.mad(Z,-e.m_inv),e.a-=M*O*e.i_inv,n.p.mad(Z,n.m_inv),n.a+=k*O*n.i_inv,b<I.LINEAR_SLOP};ie.prototype.getReactionForce=function(e){return l.scale(this.u,this.lambda_acc*e)};ie.prototype.getReactionTorque=function(e){return 0};var Jt=function(e,n,h){I.call(this,I.TYPE_WELD,e,n,!1),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(h),this.gamma=0,this.beta_c=0,this.frequencyHz=0,this.dampingRatio=0,this.lambda_acc=new gt(0,0,0)};Jt.prototype=new I;Jt.prototype.constructor=Jt;Jt.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e),this.anchor2=this.body2.getLocalPoint(e)};Jt.prototype.setWorldAnchor2=function(e){this.anchor1=this.body1.getLocalPoint(e),this.anchor2=this.body2.getLocalPoint(e)};Jt.prototype.serialize=function(){return{type:"WeldJoint",body1:this.body1.id,body2:this.body2.id,anchor1:this.body1.getWorldPoint(this.anchor1),anchor2:this.body2.getWorldPoint(this.anchor2),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable,frequencyHz:this.frequencyHz,dampingRatio:this.dampingRatio}};Jt.prototype.setSpringFrequencyHz=function(e){this.frequencyHz=e};Jt.prototype.setSpringDampingRatio=function(e){this.dampingRatio=e};Jt.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e,this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var p=h.m_inv+c.m_inv,v=this.r1,y=this.r2,b=v.x*h.i_inv,g=v.y*h.i_inv,M=y.x*c.i_inv,k=y.y*c.i_inv,U=p+v.y*g+y.y*k,O=-v.x*g-y.x*k,Z=-g-k,L=p+v.x*b+y.x*M,R=b+M,B=h.i_inv+c.i_inv;if(this.em_inv=new Bt(U,O,Z,O,L,R,Z,R,B),this.frequencyHz>0){var V=B>0?1/B:0,H=2*Math.PI*this.frequencyHz,W=V*H*H,J=V*2*this.dampingRatio*H;this.gamma=(J+W*e)*e,this.gamma=this.gamma==0?0:1/this.gamma;var G=e*W*this.gamma,K=c.a-h.a;this.beta_c=G*K,this.em_inv._33+=this.gamma}else this.gamma=0,this.beta_c=0;if(n){var ht=new l(this.lambda_acc.x,this.lambda_acc.y),At=this.lambda_acc.z;h.v.mad(ht,-h.m_inv),h.w-=(l.cross(this.r1,ht)+At)*h.i_inv,c.v.mad(ht,c.m_inv),c.w+=(l.cross(this.r2,ht)+At)*c.i_inv}else this.lambda_acc.set(0,0,0)};Jt.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2;if(this.frequencyHz>0){var h=n.w-e.w,c=-(h+this.beta_c+this.gamma*this.lambda_acc.z)/this.em_inv._33;e.w-=c*e.i_inv,n.w+=c*n.i_inv;var p=l.mad(e.v,l.perp(this.r1),e.w),v=l.mad(n.v,l.perp(this.r2),n.w),y=l.sub(v,p),b=this.em_inv.solve2x2(y.neg());this.lambda_acc.x+=b.x,this.lambda_acc.y+=b.y,this.lambda_acc.z+=c,e.v.mad(b,-e.m_inv),e.w-=l.cross(this.r1,b)*e.i_inv,n.v.mad(b,n.m_inv),n.w+=l.cross(this.r2,b)*n.i_inv}else{var p=l.mad(e.v,l.perp(this.r1),e.w),v=l.mad(n.v,l.perp(this.r2),n.w),y=l.sub(v,p),h=n.w-e.w,g=gt.fromVec2(y,h),M=this.em_inv.solve(g.neg());this.lambda_acc.addself(M);var b=new l(M.x,M.y);e.v.mad(b,-e.m_inv),e.w-=(l.cross(this.r1,b)+M.z)*e.i_inv,n.v.mad(b,n.m_inv),n.w+=(l.cross(this.r2,b)+M.z)*n.i_inv}};Jt.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=l.rotate(l.sub(this.anchor1,e.centroid),e.a),c=l.rotate(l.sub(this.anchor2,n.centroid),n.a),p=e.m_inv+n.m_inv,v=h.x*e.i_inv,y=h.y*e.i_inv,b=c.x*n.i_inv,g=c.y*n.i_inv,M=p+h.y*y+c.y*g,k=-h.x*y-c.x*g,U=-y-g,O=p+h.x*v+c.x*b,Z=v+b,L=e.i_inv+n.i_inv,R=new Bt(M,k,U,k,O,Z,U,Z,L);if(this.frequencyHz>0){var B=l.sub(l.add(n.p,c),l.add(e.p,h)),V=0,H=l.truncate(B,I.MAX_LINEAR_CORRECTION),W=R.solve2x2(H.neg());e.p.mad(W,-e.m_inv),e.a-=l.cross(h,W)*e.i_inv,n.p.mad(W,n.m_inv),n.a+=l.cross(c,W)*n.i_inv}else{var B=l.sub(l.add(n.p,c),l.add(e.p,h)),V=n.a-e.a,H=gt.fromVec2(l.truncate(B,I.MAX_LINEAR_CORRECTION),St(V,-I.MAX_ANGULAR_CORRECTION,I.MAX_ANGULAR_CORRECTION)),J=R.solve(H.neg()),W=new l(J.x,J.y);e.p.mad(W,-e.m_inv),e.a-=(l.cross(h,W)+J.z)*e.i_inv,n.p.mad(W,n.m_inv),n.a+=(l.cross(c,W)+J.z)*n.i_inv}return B.length()<I.LINEAR_SLOP&&Math.abs(V)<=I.ANGULAR_SLOP};Jt.prototype.getReactionForce=function(e){return l.scale(this.lambda_acc.toVec2(),e)};Jt.prototype.getReactionTorque=function(e){return this.lambda_acc.z*e};var Vt=function(e,n,h,c){I.call(this,I.TYPE_WHEEL,e,n,!0),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(c);var p=l.sub(c,h);this.restLength=p.length(),this.u_local=this.body1.getLocalVector(l.normalize(p)),this.n_local=l.perp(this.u_local),this.lambda_acc=0,this.motorLambda_acc=0,this.springLambda_acc=0,this.motorEnabled=!1,this.motorSpeed=0,this.maxMotorTorque=0,this.gamma=0,this.beta_c=0,this.frequencyHz=0,this.dampingRatio=0};Vt.prototype=new I;Vt.prototype.constructor=Vt;Vt.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e);var n=l.sub(this.getWorldAnchor2(),e);this.u_local=this.body1.getLocalVector(l.normalize(n)),this.n_local=l.perp(this.u_local)};Vt.prototype.setWorldAnchor2=function(e){this.anchor2=this.body2.getLocalPoint(e);var n=l.sub(e,this.getWorldAnchor1());this.u_local=this.body1.getLocalVector(l.normalize(n)),this.n_local=l.perp(this.u_local)};Vt.prototype.serialize=function(){return{type:"WheelJoint",body1:this.body1.id,body2:this.body2.id,anchor1:this.body1.getWorldPoint(this.anchor1),anchor2:this.body2.getWorldPoint(this.anchor2),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable,motorEnabled:this.motorEnabled,motorSpeed:this.motorSpeed,maxMotorTorque:this.maxMotorTorque,frequencyHz:this.frequencyHz,dampingRatio:this.dampingRatio}};Vt.prototype.setSpringFrequencyHz=function(e){this.frequencyHz=e};Vt.prototype.setSpringDampingRatio=function(e){this.dampingRatio=e};Vt.prototype.enableMotor=function(e){this.motorEnabled=e};Vt.prototype.setMotorSpeed=function(e){this.motorSpeed=e};Vt.prototype.setMaxMotorTorque=function(e){this.maxMotorTorque=e};Vt.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e,this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var p=l.add(h.p,this.r1),v=l.add(c.p,this.r2),y=l.sub(v,p);this.r1_d=l.add(this.r1,y),this.n=l.rotate(this.n_local,h.a),this.sn1=l.cross(this.r1_d,this.n),this.sn2=l.cross(this.r2,this.n);var b=h.m_inv+c.m_inv+h.i_inv*this.sn1*this.sn1+c.i_inv*this.sn2*this.sn2;if(this.em=b>0?1/b:b,this.frequencyHz>0){this.u=l.rotate(this.u_local,h.a),this.su1=l.cross(this.r1_d,this.u),this.su2=l.cross(this.r2,this.u);var g=h.m_inv+c.m_inv+h.i_inv*this.su1*this.su1+c.i_inv*this.su2*this.su2,M=g==0?0:1/g,k=2*Math.PI*this.frequencyHz,U=M*k*k,O=M*2*this.dampingRatio*k;this.gamma=(O+U*e)*e,this.gamma=this.gamma==0?0:1/this.gamma;var Z=e*U*this.gamma,L=l.dot(y,this.u)-this.restLength;this.beta_c=Z*L,g=g+this.gamma,this.springEm=g==0?0:1/g}else this.gamma=0,this.beta_c=0,this.springLambda_acc=0;if(this.motorEnabled){this.maxMotorImpulse=this.maxMotorTorque*e;var R=h.i_inv+c.i_inv;this.motorEm=R>0?1/R:R}else this.motorEm=0,this.motorLambda_acc=0;if(n){var B=l.scale(this.n,this.lambda_acc),V=this.sn1*this.lambda_acc+this.motorLambda_acc,H=this.sn2*this.lambda_acc+this.motorLambda_acc;this.frequencyHz>0&&(B.addself(l.scale(this.u,this.springLambda_acc)),V+=this.su1*this.springLambda_acc,H+=this.su2*this.springLambda_acc),h.v.mad(B,-h.m_inv),h.w-=V*h.i_inv,c.v.mad(B,c.m_inv),c.w+=H*c.i_inv}else this.lambda_acc=0,this.springLambda_acc=0,this.motorLambda_acc=0};Vt.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2;if(this.frequencyHz>0){var p=this.u.dot(l.sub(n.v,e.v))+this.su2*n.w-this.su1*e.w,h=this.beta_c+this.gamma*this.springLambda_acc,v=-this.springEm*(p+h);this.springLambda_acc+=v;var y=l.scale(this.u,v);e.v.mad(y,-e.m_inv),e.w-=this.su1*v*e.i_inv,n.v.mad(y,n.m_inv),n.w+=this.su2*v*n.i_inv}if(this.motorEnabled){var p=n.w-e.w-this.motorSpeed,v=-this.motorEm*p,c=this.motorLambda_acc;this.motorLambda_acc=St(this.motorLambda_acc+v,-this.maxMotorImpulse,this.maxMotorImpulse),v=this.motorLambda_acc-c,e.w-=v*e.i_inv,n.w+=v*n.i_inv}var p=this.n.dot(l.sub(n.v,e.v))+this.sn2*n.w-this.sn1*e.w,v=-this.em*p;this.lambda_acc+=v;var y=l.scale(this.n,v);e.v.mad(y,-e.m_inv),e.w-=this.sn1*v*e.i_inv,n.v.mad(y,n.m_inv),n.w+=this.sn2*v*n.i_inv};Vt.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=l.rotate(l.sub(this.anchor1,e.centroid),e.a),c=l.rotate(l.sub(this.anchor2,n.centroid),n.a),p=l.add(e.p,h),v=l.add(n.p,c),y=l.sub(v,p),b=l.add(h,y),g=l.rotate(this.n_local,e.a),M=l.dot(g,y),k=St(M,-I.MAX_LINEAR_CORRECTION,I.MAX_LINEAR_CORRECTION),U=l.cross(b,g),O=l.cross(c,g),Z=e.m_inv+n.m_inv+e.i_inv*U*U+n.i_inv*O*O,L=Z==0?0:1/Z,R=L*-k,B=l.scale(g,R);return e.p.mad(B,-e.m_inv),e.a-=U*R*e.i_inv,n.p.mad(B,n.m_inv),n.a+=O*R*n.i_inv,Math.abs(M)<I.LINEAR_SLOP};Vt.prototype.getReactionForce=function(e){return l.scale(this.n,this.lambda_acc*e)};Vt.prototype.getReactionTorque=function(e){return 0};var re=function(e,n){I.call(this,I.TYPE_ANGLE,e,n,!0),this.anchor1=new l(0,0),this.anchor2=new l(0,0),this.refAngle=n.a-e.a,this.lambda_acc=0};re.prototype=new I;re.prototype.constructor=re;re.prototype.setWorldAnchor1=function(e){this.anchor1=new l(0,0)};re.prototype.setWorldAnchor2=function(e){this.anchor2=new l(0,0)};re.prototype.serialize=function(){return{type:"AngleJoint",body1:this.body1.id,body2:this.body2.id,collideConnected:this.collideConnected}};re.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e;var p=h.i_inv+c.i_inv;this.em=p==0?0:1/p,n?(h.w-=this.lambda_acc*h.i_inv,c.w+=this.lambda_acc*c.i_inv):this.lambda_acc=0};re.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2,h=n.w-e.w,c=-this.em*h;this.lambda_acc+=c,e.w-=c*e.i_inv,n.w+=c*n.i_inv};re.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=n.a-e.a-this.refAngle,c=St(h,-I.MAX_ANGULAR_CORRECTION,I.MAX_ANGULAR_CORRECTION),p=this.em*-c;return e.a-=p*e.i_inv,n.a+=p*n.i_inv,Math.abs(h)<I.ANGULAR_SLOP};re.prototype.getReactionForce=function(e){return l.zero};re.prototype.getReactionTorque=function(e){return this.lambda_acc*e};var jt=function(e,n,h,c){I.call(this,I.TYPE_DISTANCE,e,n,!0),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(c),this.restLength=l.dist(h,c),this.gamma=0,this.beta_c=0,this.frequencyHz=0,this.dampingRatio=0,this.lambda_acc=0};jt.prototype=new I;jt.prototype.constructor=jt;jt.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e),this.restLength=l.dist(e,this.getWorldAnchor2())};jt.prototype.setWorldAnchor2=function(e){this.anchor2=this.body2.getLocalPoint(e),this.restLength=l.dist(e,this.getWorldAnchor1())};jt.prototype.serialize=function(){return{type:"DistanceJoint",body1:this.body1.id,body2:this.body2.id,anchor1:this.body1.getWorldPoint(this.anchor1),anchor2:this.body2.getWorldPoint(this.anchor2),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable,frequencyHz:this.frequencyHz,dampingRatio:this.dampingRatio}};jt.prototype.setSpringFrequencyHz=function(e){this.frequencyHz=e};jt.prototype.setSpringDampingRatio=function(e){this.dampingRatio=e};jt.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e,this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var p=l.sub(l.add(c.p,this.r2),l.add(h.p,this.r1)),v=p.length();v>I.LINEAR_SLOP?this.u=l.scale(p,1/v):this.u=l.zero,this.s1=l.cross(this.r1,this.u),this.s2=l.cross(this.r2,this.u);var y=h.m_inv+c.m_inv+h.i_inv*this.s1*this.s1+c.i_inv*this.s2*this.s2;if(this.em=y==0?0:1/y,this.frequencyHz>0){var b=2*Math.PI*this.frequencyHz,g=this.em*b*b,M=this.em*2*this.dampingRatio*b;this.gamma=(M+g*e)*e,this.gamma=this.gamma==0?0:1/this.gamma;var k=e*g*this.gamma,U=v-this.restLength;this.beta_c=k*U,y=y+this.gamma,this.em=y==0?0:1/y}else this.gamma=0,this.beta_c=0;if(n){var O=l.scale(this.u,this.lambda_acc);h.v.mad(O,-h.m_inv),h.w-=this.s1*this.lambda_acc*h.i_inv,c.v.mad(O,c.m_inv),c.w+=this.s2*this.lambda_acc*c.i_inv}else this.lambda_acc=0};jt.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2,h=this.u.dot(l.sub(n.v,e.v))+this.s2*n.w-this.s1*e.w,c=this.beta_c+this.gamma*this.lambda_acc,p=-this.em*(h+c);this.lambda_acc+=p;var v=l.scale(this.u,p);e.v.mad(v,-e.m_inv),e.w-=this.s1*p*e.i_inv,n.v.mad(v,n.m_inv),n.w+=this.s2*p*n.i_inv};jt.prototype.solvePositionConstraints=function(){if(this.frequencyHz>0)return!0;var e=this.body1,n=this.body2,h=l.rotate(l.sub(this.anchor1,e.centroid),e.a),c=l.rotate(l.sub(this.anchor2,n.centroid),n.a),p=l.sub(l.add(n.p,c),l.add(e.p,h)),v=p.length(),y=l.scale(p,1/v),b=v-this.restLength,g=St(b,-I.MAX_LINEAR_CORRECTION,I.MAX_LINEAR_CORRECTION),M=l.cross(h,y),k=l.cross(c,y),U=e.m_inv+n.m_inv+e.i_inv*M*M+n.i_inv*k*k,O=U==0?0:-g/U,Z=l.scale(y,O);return e.p.mad(Z,-e.m_inv),e.a-=M*O*e.i_inv,n.p.mad(Z,n.m_inv),n.a+=k*O*n.i_inv,Math.abs(b)<I.LINEAR_SLOP};jt.prototype.getReactionForce=function(e){return l.scale(this.u,this.lambda_acc*e)};jt.prototype.getReactionTorque=function(e){return 0};var Wt=function(e,n,h){I.call(this,I.TYPE_REVOLUTE,e,n,!1),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(h),this.refAngle=n.a-e.a,this.lambda_acc=new gt(0,0,0),this.motorLambda_acc=0,this.limitEnabled=!1,this.limitLowerAngle=0,this.limitUpperAngle=0,this.limitState=I.LIMIT_STATE_INACTIVE,this.motorEnabled=!1,this.motorSpeed=0,this.maxMotorTorque=0};Wt.prototype=new I;Wt.prototype.constructor=Wt;Wt.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e),this.anchor2=this.body2.getLocalPoint(e)};Wt.prototype.setWorldAnchor2=function(e){this.anchor1=this.body1.getLocalPoint(e),this.anchor2=this.body2.getLocalPoint(e)};Wt.prototype.serialize=function(){return{type:"RevoluteJoint",body1:this.body1.id,body2:this.body2.id,anchor:this.body1.getWorldPoint(this.anchor1),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable,limitEnabled:this.limitEnabled,limitLowerAngle:this.limitLowerAngle,limitUpperAngle:this.limitUpperAngle,motorEnabled:this.motorEnabled,motorSpeed:this.motorSpeed,maxMotorTorque:this.maxMotorTorque}};Wt.prototype.enableMotor=function(e){this.motorEnabled=e};Wt.prototype.setMotorSpeed=function(e){this.motorSpeed=e};Wt.prototype.setMaxMotorTorque=function(e){this.maxMotorTorque=e};Wt.prototype.enableLimit=function(e){this.limitEnabled=e};Wt.prototype.setLimits=function(e,n){this.limitLowerAngle=e,this.limitUpperAngle=n};Wt.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;if(this.maxImpulse=this.maxForce*e,this.motorEnabled?this.maxMotorImpulse=this.maxMotorTorque*e:this.motorLambda_acc=0,this.limitEnabled){var p=c.a-h.a-this.refAngle;Math.abs(this.limitUpperAngle-this.limitLowerAngle)<I.ANGULAR_SLOP?this.limitState=I.LIMIT_STATE_EQUAL_LIMITS:p<=this.limitLowerAngle?(this.limitState!=I.LIMIT_STATE_AT_LOWER&&(this.lambda_acc.z=0),this.limitState=I.LIMIT_STATE_AT_LOWER):p>=this.limitUpperAngle?(this.limitState!=I.LIMIT_STATE_AT_UPPER&&(this.lambda_acc.z=0),this.limitState=I.LIMIT_STATE_AT_UPPER):(this.limitState=I.LIMIT_STATE_INACTIVE,this.lambda_acc.z=0)}else this.limitState=I.LIMIT_STATE_INACTIVE;this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var v=h.m_inv+c.m_inv,y=this.r1,b=this.r2,g=y.x*h.i_inv,M=y.y*h.i_inv,k=b.x*c.i_inv,U=b.y*c.i_inv,O=v+y.y*M+b.y*U,Z=-y.x*M-b.x*U,L=-M-U,R=v+y.x*g+b.x*k,B=g+k,V=h.i_inv+c.i_inv;if(this.em_inv=new Bt(O,Z,L,Z,R,B,L,B,V),V!=0&&(this.em2=1/V),n){var H=new l(this.lambda_acc.x,this.lambda_acc.y),W=this.lambda_acc.z+this.motorLambda_acc;h.v.mad(H,-h.m_inv),h.w-=(l.cross(this.r1,H)+W)*h.i_inv,c.v.mad(H,c.m_inv),c.w+=(l.cross(this.r2,H)+W)*c.i_inv}else this.lambda_acc.set(0,0,0),this.motorLambda_acc=0};Wt.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2;if(this.motorEnabled&&this.limitState!=I.LIMIT_STATE_EQUAL_LIMITS){var h=n.w-e.w-this.motorSpeed,c=-this.em2*h,p=this.motorLambda_acc;this.motorLambda_acc=St(this.motorLambda_acc+c,-this.maxMotorImpulse,this.maxMotorImpulse),c=this.motorLambda_acc-p,e.w-=c*e.i_inv,n.w+=c*n.i_inv}if(this.limitEnabled&&this.limitState!=I.LIMIT_STATE_INACTIVE){var v=l.mad(e.v,l.perp(this.r1),e.w),y=l.mad(n.v,l.perp(this.r2),n.w),b=l.sub(y,v),g=n.w-e.w,h=gt.fromVec2(b,g),c=this.em_inv.solve(h.neg());if(this.limitState==I.LIMIT_STATE_EQUAL_LIMITS)this.lambda_acc.addself(c);else if(this.limitState==I.LIMIT_STATE_AT_LOWER||this.limitState==I.LIMIT_STATE_AT_UPPER){var M=this.lambda_acc.z+c.z,k=this.limitState==I.LIMIT_STATE_AT_LOWER&&M<0,U=this.limitState==I.LIMIT_STATE_AT_UPPER&&M>0;if(k||U){var O=l.add(b,l.scale(new l(this.em_inv._13,this.em_inv._23),M)),Z=this.em_inv.solve2x2(O.neg());c.x=Z.x,c.y=Z.y,c.z=-this.lambda_acc.z,this.lambda_acc.x+=c.x,this.lambda_acc.y+=c.y,this.lambda_acc.z=0}else this.lambda_acc.addself(c)}var L=new l(c.x,c.y);e.v.mad(L,-e.m_inv),e.w-=(l.cross(this.r1,L)+c.z)*e.i_inv,n.v.mad(L,n.m_inv),n.w+=(l.cross(this.r2,L)+c.z)*n.i_inv}else{var v=l.mad(e.v,l.perp(this.r1),e.w),y=l.mad(n.v,l.perp(this.r2),n.w),h=l.sub(y,v),c=this.em_inv.solve2x2(h.neg());this.lambda_acc.addself(gt.fromVec2(c,0)),e.v.mad(c,-e.m_inv),e.w-=l.cross(this.r1,c)*e.i_inv,n.v.mad(c,n.m_inv),n.w+=l.cross(this.r2,c)*n.i_inv}};Wt.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=0,c=0;if(this.limitEnabled&&this.limitState!=I.LIMIT_STATE_INACTIVE){var p=n.a-e.a-this.refAngle,v=0;if(this.limitState==I.LIMIT_STATE_EQUAL_LIMITS){var y=St(p-this.limitLowerAngle,-I.MAX_ANGULAR_CORRECTION,I.MAX_ANGULAR_CORRECTION);h=Math.abs(y),v=-this.em2*y}else if(this.limitState==I.LIMIT_STATE_AT_LOWER){var y=p-this.limitLowerAngle;h=-y,y=St(y+I.ANGULAR_SLOP,-I.MAX_ANGULAR_CORRECTION,0),v=-this.em2*y}else if(this.limitState==I.LIMIT_STATE_AT_UPPER){var y=p-this.limitUpperAngle;h=y,y=St(y-I.ANGULAR_SLOP,0,I.MAX_ANGULAR_CORRECTION),v=-this.em2*y}e.a-=v*e.i_inv,n.a+=v*n.i_inv}{var b=l.rotate(l.sub(this.anchor1,e.centroid),e.a),g=l.rotate(l.sub(this.anchor2,n.centroid),n.a),y=l.sub(l.add(n.p,g),l.add(e.p,b)),M=l.truncate(y,I.MAX_LINEAR_CORRECTION);c=M.length();var k=e.m_inv+n.m_inv,U=b.y*e.i_inv,O=g.y*n.i_inv,Z=k+b.y*U+g.y*O,L=-b.x*U-g.x*O,R=k+b.x*b.x*e.i_inv+g.x*g.x*n.i_inv,B=new Ct(Z,L,L,R),V=B.solve(M.neg());e.p.mad(V,-e.m_inv),e.a-=l.cross(b,V)*e.i_inv,n.p.mad(V,n.m_inv),n.a+=l.cross(g,V)*n.i_inv}return c<I.LINEAR_SLOP&&h<I.ANGULAR_SLOP};Wt.prototype.getReactionForce=function(e){return l.scale(this.lambda_acc,e)};Wt.prototype.getReactionTorque=function(e){return 0};var se=function(e,n,h,c){I.call(this,I.TYPE_PRISMATIC,e,n,!0),this.anchor1=this.body1.getLocalPoint(h),this.anchor2=this.body2.getLocalPoint(c);var p=l.sub(c,h);this.n_local=this.body1.getLocalVector(l.normalize(l.perp(p))),this.da=n.a-e.a,this.lambda_acc=new l(0,0)};se.prototype=new I;se.prototype.constructor=se;se.prototype.setWorldAnchor1=function(e){this.anchor1=this.body1.getLocalPoint(e);var n=l.sub(this.getWorldAnchor2(),e);this.n_local=this.body1.getLocalVector(l.normalize(l.perp(n)))};se.prototype.setWorldAnchor2=function(e){this.anchor2=this.body2.getLocalPoint(e);var n=l.sub(e,this.getWorldAnchor1());this.n_local=this.body1.getLocalVector(l.normalize(l.perp(n)))};se.prototype.serialize=function(){return{type:"PrismaticJoint",body1:this.body1.id,body2:this.body2.id,anchor1:this.body1.getWorldPoint(this.anchor1),anchor2:this.body2.getWorldPoint(this.anchor2),collideConnected:this.collideConnected,maxForce:this.maxForce,breakable:this.breakable}};se.prototype.initSolver=function(e,n){var h=this.body1,c=this.body2;this.maxImpulse=this.maxForce*e,this.r1=h.xf.rotate(l.sub(this.anchor1,h.centroid)),this.r2=c.xf.rotate(l.sub(this.anchor2,c.centroid));var p=l.add(h.p,this.r1),v=l.add(c.p,this.r2),y=l.sub(v,p);this.r1_d=l.add(this.r1,y),this.n=l.normalize(l.perp(y)),this.s1=l.cross(this.r1_d,this.n),this.s2=l.cross(this.r2,this.n);var b=this.s1,g=this.s2,M=b*h.i_inv,k=g*c.i_inv,U=h.m_inv+c.m_inv+b*M+g*k,O=M+k,Z=h.i_inv+c.i_inv;if(this.em_inv=new Ct(U,O,O,Z),n){var L=l.scale(this.n,this.lambda_acc.x);h.v.mad(L,-h.m_inv),h.w-=(this.s1*this.lambda_acc.x+this.lambda_acc.y)*h.i_inv,c.v.mad(L,c.m_inv),c.w+=(this.s2*this.lambda_acc.x+this.lambda_acc.y)*c.i_inv}else this.lambda_acc.set(0,0)};se.prototype.solveVelocityConstraints=function(){var e=this.body1,n=this.body2,h=this.n.dot(l.sub(n.v,e.v))+this.s2*n.w-this.s1*e.w,c=n.w-e.w,p=this.em_inv.solve(new l(-h,-c));this.lambda_acc.addself(p);var v=l.scale(this.n,p.x);e.v.mad(v,-e.m_inv),e.w-=(this.s1*p.x+p.y)*e.i_inv,n.v.mad(v,n.m_inv),n.w+=(this.s2*p.x+p.y)*n.i_inv};se.prototype.solvePositionConstraints=function(){var e=this.body1,n=this.body2,h=l.rotate(l.sub(this.anchor1,e.centroid),e.a),c=l.rotate(l.sub(this.anchor2,n.centroid),n.a),p=l.add(e.p,h),v=l.add(n.p,c),y=l.sub(v,p),b=l.add(h,y),g=l.rotate(this.n_local,e.a),M=l.dot(g,y),k=n.a-e.a-this.da,U=new l;U.x=St(M,-I.MAX_LINEAR_CORRECTION,I.MAX_LINEAR_CORRECTION),U.y=St(k,-I.MAX_ANGULAR_CORRECTION,I.MAX_ANGULAR_CORRECTION);var O=l.cross(b,g),Z=l.cross(c,g),L=O*e.i_inv,R=Z*n.i_inv,B=e.m_inv+n.m_inv+O*L+Z*R,V=L+R,H=e.i_inv+n.i_inv,W=new Ct(B,V,V,H),J=W.solve(U.neg()),G=l.scale(g,J.x);return e.p.mad(G,-e.m_inv),e.a-=(l.cross(b,G)+J.y)*e.i_inv,n.p.mad(G,n.m_inv),n.a+=(l.cross(c,G)+J.y)*n.i_inv,Math.abs(M)<=I.LINEAR_SLOP&&Math.abs(k)<=I.ANGULAR_SLOP};se.prototype.getReactionForce=function(e){return l.scale(this.n,this.lambda_acc.x*e)};se.prototype.getReactionTorque=function(e){return this.lambda_acc.y*e};var sn=(()=>{var e=Object.defineProperty,n=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyNames,c=Object.prototype.hasOwnProperty,p=(i,t,r)=>t in i?e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,v=(i,t)=>{for(var r in t)e(i,r,{get:t[r],enumerable:!0})},y=(i,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of h(t))!c.call(i,a)&&a!==r&&e(i,a,{get:()=>t[a],enumerable:!(s=n(t,a))||s.enumerable});return i},b=i=>y(e({},"__esModule",{value:!0}),i),g=(i,t,r)=>(p(i,typeof t!="symbol"?t+"":t,r),r),M={};v(M,{default:()=>ot});var k={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},U={};v(U,{HALF_PI:()=>R,NumArray:()=>ht,TWO_PI:()=>L,decomposeMatrix:()=>B,getComputedMatrix:()=>H,getPoT:()=>G,lerp:()=>W,mod:()=>K,setMatrix:()=>V,toFixed:()=>pt});var O;typeof window<"u"?O=window:typeof global<"u"?O=global:typeof self<"u"&&(O=self);var Z,L=Math.PI*2,R=Math.PI*.5;function B(i,t,r,s,a,o){let d;return arguments.length<=1?(d=i.a,t=i.b,r=i.c,s=i.d,a=i.e,o=i.f):d=i,{translateX:a,translateY:o,scaleX:Math.sqrt(d*d+t*t),scaleY:Math.sqrt(r*r+s*s),rotation:180*Math.atan2(t,d)/Math.PI}}function V(i){Z=i}function H(i,t){t=t&&t.identity()||new Z;let r=i,s=[];for(;r&&r._matrix;)s.push(r._matrix),r=r.parent;s.reverse();for(let a=0;a<s.length;a++){let o=s[a].elements;t.multiply(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9])}return t}function W(i,t,r){return r*(t-i)+i}var J=[2,4,8,16,32,64,128,256,512,1024,2048,4096];function G(i){let t=0;for(;J[t]&&J[t]<i;)t++;return J[t]}function K(i,t){for(;i<0;)i+=t;return i%t}var ht=O.Float32Array||Array,At=Math.floor;function pt(i){return At(i*1e6)/1e6}var fe={};v(fe,{Curve:()=>ae,getAnchorsFromArcData:()=>as,getComponentOnCubicBezier:()=>xe,getControlPoints:()=>Xi,getCurveBoundingBox:()=>Wi,getCurveFromPoints:()=>Ui,getCurveLength:()=>Vi,getReflection:()=>wi,integrate:()=>qi,subdivide:()=>xi});var E=class{constructor(){m(this,"_events",{});m(this,"_bound",!1)}addEventListener(i,t){return(this._events[i]||(this._events[i]=[])).push(t),this._bound=!0,this}on(){return this.addEventListener.apply(this,arguments)}bind(){return this.addEventListener.apply(this,arguments)}removeEventListener(i,t){if(!this._events)return this;if(!i&&!t)return this._events={},this._bound=!1,this;let r=i?[i]:Object.keys(this._events);for(let s=0,a=r.length;s<a;s++){i=r[s];let o=this._events[i];if(o){let d=[];if(t)for(let f=0,_=o.length;f<_;f++){let u=o[f];u=u.handler?u.handler:u,t!==u&&d.push(u)}this._events[i]=d}}return this}off(){return this.removeEventListener.apply(this,arguments)}unbind(){return this.removeEventListener.apply(this,arguments)}dispatchEvent(i){if(!this._events)return this;let t=Array.prototype.slice.call(arguments,1),r=this._events[i];if(r)for(let s=0;s<r.length;s++)r[s].call(this,...t);return this}trigger(){return this.dispatchEvent.apply(this,arguments)}listen(i,t,r){let s=this;i&&(a.obj=i,a.name=t,a.handler=r,i.on(t,a));function a(){r.apply(s,arguments)}return s}ignore(i,t,r){return i.off(t,r),this}};g(E,"Types",{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"}),g(E,"Methods",["addEventListener","on","removeEventListener","off","unbind","dispatchEvent","trigger","listen","ignore"]);var lt={x:{enumerable:!0,get:function(){return this._x},set:function(i){this._x!==i&&(this._x=i,this._bound&&this.dispatchEvent(E.Types.change))}},y:{enumerable:!0,get:function(){return this._y},set:function(i){this._y!==i&&(this._y=i,this._bound&&this.dispatchEvent(E.Types.change))}}},ft=class extends E{constructor(t=0,r=0){super();m(this,"_x",0);m(this,"_y",0);for(let s in lt)Object.defineProperty(this,s,lt[s]);this.x=t,this.y=r}static add(t,r){return new ft(t.x+r.x,t.y+r.y)}static sub(t,r){return new ft(t.x-r.x,t.y-r.y)}static subtract(t,r){return ft.sub(t,r)}static ratioBetween(t,r){return(t.x*r.x+t.y*r.y)/(t.length()*r.length())}static angleBetween(t,r){if(arguments.length>=4){let o=arguments[0]-arguments[2],d=arguments[1]-arguments[3];return Math.atan2(d,o)}let s=t.x-r.x,a=t.y-r.y;return Math.atan2(a,s)}static distanceBetween(t,r){return Math.sqrt(ft.distanceBetweenSquared(t,r))}static distanceBetweenSquared(t,r){let s=t.x-r.x,a=t.y-r.y;return s*s+a*a}set(t,r){return this.x=t,this.y=r,this}copy(t){return this.x=t.x,this.y=t.y,this}clear(){return this.x=0,this.y=0,this}clone(){return new ft(this.x,this.y)}add(t,r){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x+=t,this.y+=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=r),this)}addSelf(t){return this.add.apply(this,arguments)}sub(t,r){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x-=t,this.y-=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=r),this)}subtract(){return this.sub.apply(this,arguments)}subSelf(t){return this.sub.apply(this,arguments)}subtractSelf(t){return this.sub.apply(this,arguments)}multiply(t,r){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x*=t,this.y*=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=r),this)}multiplySelf(t){return this.multiply.apply(this,arguments)}multiplyScalar(t){return this.multiply(t)}divide(t,r){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x/=t,this.y/=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=r),isNaN(this.x)&&(this.x=0),isNaN(this.y)&&(this.y=0),this)}divideSelf(t){return this.divide.apply(this,arguments)}divideScalar(t){return this.divide(t)}negate(){return this.multiply(-1)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.divideScalar(this.length())}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let r=this.x-t.x,s=this.y-t.y;return r*r+s*s}setLength(t){return this.normalize().multiplyScalar(t)}equals(t,r){return r=typeof r>"u"?1e-4:r,this.distanceTo(t)<r}lerp(t,r){let s=(t.x-this.x)*r+this.x,a=(t.y-this.y)*r+this.y;return this.set(s,a)}isZero(t){return t=typeof t>"u"?1e-4:t,this.length()<t}toString(){return this.x+", "+this.y}toObject(){return{x:this.x,y:this.y}}rotate(t){let r=this.x,s=this.y,a=Math.cos(t),o=Math.sin(t);return this.x=r*a-s*o,this.y=r*o+s*a,this}},N=ft;g(N,"zero",new ft),g(N,"left",new ft(-1,0)),g(N,"right",new ft(1,0)),g(N,"up",new ft(0,-1)),g(N,"down",new ft(0,1));var Q=class extends N{constructor(t=0,r=0,s=0,a=0,o=0,d=0,f=k.move){super(t,r);m(this,"controls",{left:new N,right:new N});m(this,"_command",k.move);m(this,"_relative",!0);m(this,"_rx",0);m(this,"_ry",0);m(this,"_xAxisRotation",0);m(this,"_largeArcFlag",0);m(this,"_sweepFlag",1);for(let u in Yt)Object.defineProperty(this,u,Yt[u]);this.command=f,this.relative=!0;let _=Q.makeBroadcast(this);this.controls.left.set(s,a).addEventListener(E.Types.change,_),this.controls.right.set(o,d).addEventListener(E.Types.change,_)}static makeBroadcast(t){return r;function r(){t._bound&&t.dispatchEvent(E.Types.change)}}copy(t){return this.x=t.x,this.y=t.y,typeof t.command=="string"&&(this.command=t.command),t.controls&&(t.controls.left&&this.controls.left.copy(t.controls.left),t.controls.right&&this.controls.right.copy(t.controls.right)),typeof t.relative=="boolean"&&(this.relative=t.relative),typeof t.rx=="number"&&(this.rx=t.rx),typeof t.ry=="number"&&(this.ry=t.ry),typeof t.xAxisRotation=="number"&&(this.xAxisRotation=t.xAxisRotation),typeof t.largeArcFlag=="number"&&(this.largeArcFlag=t.largeArcFlag),typeof t.sweepFlag=="number"&&(this.sweepFlag=t.sweepFlag),this}clone(){return new Q().copy(this)}toObject(){return{x:this.x,y:this.y,command:this.command,relative:this.relative,controls:{left:this.controls.left.toObject(),right:this.controls.right.toObject()},rx:this.rx,ry:this.ry,xAxisRotation:this.xAxisRotation,largeArcFlag:this.largeArcFlag,sweepFlag:this.sweepFlag}}toString(){return JSON.stringify(this.toObject())}},Yt={command:{enumerable:!0,get:function(){return this._command},set:function(i){this._command!==i&&(this._command=i,this._bound&&this.dispatchEvent(E.Types.change))}},relative:{enumerable:!0,get:function(){return this._relative},set:function(i){this._relative!==!!i&&(this._relative=!!i,this._bound&&this.dispatchEvent(E.Types.change))}},rx:{enumerable:!0,get:function(){return this._rx},set:function(i){this._rx!==i&&(this._rx=i,this._bound&&this.dispatchEvent(E.Types.change))}},ry:{enumerable:!0,get:function(){return this._ry},set:function(i){this._ry!==i&&(this._ry=i,this._bound&&this.dispatchEvent(E.Types.change))}},xAxisRotation:{enumerable:!0,get:function(){return this._xAxisRotation},set:function(i){this._xAxisRotation!==i&&(this._xAxisRotation=i,this._bound&&this.dispatchEvent(E.Types.change))}},largeArcFlag:{enumerable:!0,get:function(){return this._largeArcFlag},set:function(i){this._largeArcFlag!==i&&(this._largeArcFlag=i,this._bound&&this.dispatchEvent(E.Types.change))}},sweepFlag:{get:function(){return this._sweepFlag},set:function(i){this._sweepFlag!==i&&(this._sweepFlag=i,this._bound&&this.dispatchEvent(E.Types.change))}}},qt=0,xt={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.8.13",PublishDate:"2024-02-22T06:40:05.376Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return qt++}},ae={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]};function xe(i,t,r,s,a){let o=1-i;return o*o*o*t+3*o*o*i*r+3*o*i*i*s+i*i*i*a}function xi(i,t,r,s,a,o,d,f,_){_=_||ae.RecursionLimit;let u=_+1;if(Math.abs(i-d)<.001&&Math.abs(t-f)<.001)return[new Q(d,f)];let x=[];for(let w=0;w<u;w++){let S=w/u,T=xe(S,i,r,a,d),A=xe(S,t,s,o,f);x.push(new Q(T,A))}return x}function Vi(i,t,r,s,a,o,d,f,_){if(i===r&&t===s&&a===d&&o===f){let z=d-i,C=f-t;return Math.sqrt(z*z+C*C)}let u=9*(r-a)+3*(d-i),x=6*(i+a)-12*r,w=3*(r-i),S=9*(s-o)+3*(f-t),T=6*(t+o)-12*s,A=3*(s-t);function F(z){let C=(u*z+x)*z+w,P=(S*z+T)*z+A;return Math.sqrt(C*C+P*P)}return qi(F,0,1,_||ae.RecursionLimit)}function Wi(i,t,r,s,a,o,d,f){let _=[],u=[[],[]],x,w,S,T,A,F,z,C;for(let D=0;D<2;++D){if(D==0?(w=6*i-12*r+6*a,x=-3*i+9*r-9*a+3*d,S=3*r-3*i):(w=6*t-12*s+6*o,x=-3*t+9*s-9*o+3*f,S=3*s-3*t),Math.abs(x)<1e-12){if(Math.abs(w)<1e-12)continue;T=-S/w,0<T&&T<1&&_.push(T);continue}z=w*w-4*S*x,C=Math.sqrt(z),!(z<0)&&(A=(-w+C)/(2*x),0<A&&A<1&&_.push(A),F=(-w-C)/(2*x),0<F&&F<1&&_.push(F))}let P=_.length,Y=P,q;for(;P--;)T=_[P],q=1-T,u[0][P]=q*q*q*i+3*q*q*T*r+3*q*T*T*a+T*T*T*d,u[1][P]=q*q*q*t+3*q*q*T*s+3*q*T*T*o+T*T*T*f;return u[0][Y]=i,u[1][Y]=t,u[0][Y+1]=d,u[1][Y+1]=f,u[0].length=u[1].length=Y+2,{min:{x:Math.min.apply(0,u[0]),y:Math.min.apply(0,u[1])},max:{x:Math.max.apply(0,u[0]),y:Math.max.apply(0,u[1])}}}function qi(i,t,r,s){let a=ae.abscissas[s-2],o=ae.weights[s-2],d=.5*(r-t),f=d+t,_=0,u=s+1>>1,x=s&1?o[_++]*i(f):0;for(;_<u;){let w=d*a[_];x+=o[_++]*(i(f+w)+i(f-w))}return d*x}function Ui(i,t){let r=i.length,s=r-1;for(let a=0;a<r;a++){let o=i[a],d=t?K(a-1,r):Math.max(a-1,0),f=t?K(a+1,r):Math.min(a+1,s),_=i[d],u=o,x=i[f];Xi(_,u,x),u.command=a===0?k.move:k.curve}}function Xi(i,t,r){let s=N.angleBetween(i,t),a=N.angleBetween(r,t),o=N.distanceBetween(i,t),d=N.distanceBetween(r,t),f=(s+a)/2;return o<1e-4||d<1e-4?(typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.copy(t),t.controls.right.copy(t)),t):(o*=.33,d*=.33,a<s?f+=R:f-=R,t.controls.left.x=Math.cos(f)*o,t.controls.left.y=Math.sin(f)*o,f-=Math.PI,t.controls.right.x=Math.cos(f)*d,t.controls.right.y=Math.sin(f)*d,typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.x+=t.x,t.controls.left.y+=t.y,t.controls.right.x+=t.x,t.controls.right.y+=t.y),t)}function wi(i,t,r){return new N(2*i.x-(t.x+i.x)-(r?i.x:0),2*i.y-(t.y+i.y)-(r?i.y:0))}function as(i,t,r,s,a,o,d){let f=xt.Resolution,_=[];for(let u=0;u<f;u++){let x=(u+1)/f;d&&(x=1-x);let w=x*o+a,S=r*Math.cos(w),T=s*Math.sin(w),A=new Q(S,T);A.command=k.line,_.push(A)}}var os=O.devicePixelRatio||1;function hs(i){return i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1}function Ai(i){return os/hs(i)}var Hi=Array.prototype.slice;function ls(i){if(i==null)return!1;let t=i.length;return typeof t=="number"&&t>=0&&t<4294967296}var j={isNaN:function(i){return typeof i=="number"&&i!==+i},isElement:function(i){return!!(i&&i.nodeType===1)},isObject:function(i){let t=typeof i;return t==="function"||t==="object"&&!!i},extend:function(i){let t=Hi.call(arguments,1);for(let r=0;r<t.length;r++){let s=t[r];for(let a in s)i[a]=s[a]}return i},defaults:function(i){let t=Hi.call(arguments,1);for(let r=0;r<t.length;r++){let s=t[r];for(let a in s)i[a]===void 0&&(i[a]=s[a])}return i},each:function(i,t,r){let s=r||this,a=!ls(i)&&Object.keys(i),o=(a||i).length;for(let d=0;d<o;d++){let f=a?a[d]:d;t.call(s,i[f],f,i)}return i},performance:O.performance&&O.performance.now?O.performance:Date},Ge=class extends E{constructor(){super();m(this,"_flagId",!1);m(this,"_flagClassName",!1);m(this,"_renderer",{});m(this,"_id","");m(this,"_className","");m(this,"classList",[]);for(let t in Ji)Object.defineProperty(this,t,Ji[t])}flagReset(){this._flagId=this._flagClassName=!1}},Ji={renderer:{enumerable:!1,get:function(){return this._renderer}},id:{enumerable:!0,get:function(){return this._id},set:function(i){let t=this._id;i!==this._id&&(this._id=i,this._flagId=!0,this.parent&&(delete this.parent.children.ids[t],this.parent.children.ids[this._id]=this))}},className:{enumerable:!0,get:function(){return this._className},set:function(i){this._className!==i&&(this._flagClassName=!0,this.classList=i.split(/\s+?/),this._className=i)}}},cs=Math.cos,ds=Math.sin,ji=Math.tan,ki=[],oe=class extends E{constructor(t,r,s,a,o,d){super();m(this,"elements",new ht(9));m(this,"manual",!1);let f=t;Array.isArray(f)||(f=Array.prototype.slice.call(arguments)),this.identity(),f.length>0&&this.set(f)}static Multiply(t,r,s){if(r.length<=3){let X=t,$,at,rt,et=r[0]||0,dt=r[1]||0,ct=r[2]||0;return $=X[0]*et+X[1]*dt+X[2]*ct,at=X[3]*et+X[4]*dt+X[5]*ct,rt=X[6]*et+X[7]*dt+X[8]*ct,[$,at,rt]}let a=t[0],o=t[1],d=t[2],f=t[3],_=t[4],u=t[5],x=t[6],w=t[7],S=t[8],T=r[0],A=r[1],F=r[2],z=r[3],C=r[4],P=r[5],Y=r[6],q=r[7],D=r[8];return s=s||new ht(9),s[0]=a*T+o*z+d*Y,s[1]=a*A+o*C+d*q,s[2]=a*F+o*P+d*D,s[3]=f*T+_*z+u*Y,s[4]=f*A+_*C+u*q,s[5]=f*F+_*P+u*D,s[6]=x*T+w*z+S*Y,s[7]=x*A+w*C+S*q,s[8]=x*F+w*P+S*D,s}set(t,r,s,a,o,d,f,_,u){if(typeof r>"u"){let x=t;t=x[0],r=x[1],s=x[2],a=x[3],o=x[4],d=x[5],f=x[6],_=x[7],u=x[8]}return this.elements[0]=t,this.elements[1]=r,this.elements[2]=s,this.elements[3]=a,this.elements[4]=o,this.elements[5]=d,this.elements[6]=f,this.elements[7]=_,this.elements[8]=u,this.trigger(E.Types.change)}copy(t){return this.elements[0]=t.elements[0],this.elements[1]=t.elements[1],this.elements[2]=t.elements[2],this.elements[3]=t.elements[3],this.elements[4]=t.elements[4],this.elements[5]=t.elements[5],this.elements[6]=t.elements[6],this.elements[7]=t.elements[7],this.elements[8]=t.elements[8],this.manual=t.manual,this.trigger(E.Types.change)}identity(){return this.elements[0]=oe.Identity[0],this.elements[1]=oe.Identity[1],this.elements[2]=oe.Identity[2],this.elements[3]=oe.Identity[3],this.elements[4]=oe.Identity[4],this.elements[5]=oe.Identity[5],this.elements[6]=oe.Identity[6],this.elements[7]=oe.Identity[7],this.elements[8]=oe.Identity[8],this.trigger(E.Types.change)}multiply(t,r,s,a,o,d,f,_,u){if(typeof r>"u")return this.elements[0]*=t,this.elements[1]*=t,this.elements[2]*=t,this.elements[3]*=t,this.elements[4]*=t,this.elements[5]*=t,this.elements[6]*=t,this.elements[7]*=t,this.elements[8]*=t,this.trigger(E.Types.change);if(typeof s>"u"&&(s=1),typeof a>"u"){t=t||0,r=r||0,s=s||0,o=this.elements;let mt=o[0]*t+o[1]*r+o[2]*s,Nt=o[3]*t+o[4]*r+o[5]*s,Ht=o[6]*t+o[7]*r+o[8]*s;return[mt,Nt,Ht]}let x=this.elements,w=[t,r,s,a,o,d,f,_,u],S=x[0],T=x[1],A=x[2],F=x[3],z=x[4],C=x[5],P=x[6],Y=x[7],q=x[8],D=w[0],X=w[1],$=w[2],at=w[3],rt=w[4],et=w[5],dt=w[6],ct=w[7],bt=w[8];return this.elements[0]=S*D+T*at+A*dt,this.elements[1]=S*X+T*rt+A*ct,this.elements[2]=S*$+T*et+A*bt,this.elements[3]=F*D+z*at+C*dt,this.elements[4]=F*X+z*rt+C*ct,this.elements[5]=F*$+z*et+C*bt,this.elements[6]=P*D+Y*at+q*dt,this.elements[7]=P*X+Y*rt+q*ct,this.elements[8]=P*$+Y*et+q*bt,this.trigger(E.Types.change)}inverse(t){let r=this.elements;t=t||new oe;let s=r[0],a=r[1],o=r[2],d=r[3],f=r[4],_=r[5],u=r[6],x=r[7],w=r[8],S=w*f-_*x,T=-w*d+_*u,A=x*d-f*u,F=s*S+a*T+o*A;return F?(F=1/F,t.elements[0]=S*F,t.elements[1]=(-w*a+o*x)*F,t.elements[2]=(_*a-o*f)*F,t.elements[3]=T*F,t.elements[4]=(w*s-o*u)*F,t.elements[5]=(-_*s+o*d)*F,t.elements[6]=A*F,t.elements[7]=(-x*s+a*u)*F,t.elements[8]=(f*s-a*d)*F,t):null}scale(t,r){return arguments.length<=1&&(r=t),this.multiply(t,0,0,0,r,0,0,0,1)}rotate(t){let r=cs(t),s=ds(t);return this.multiply(r,-s,0,s,r,0,0,0,1)}translate(t,r){return this.multiply(1,0,t,0,1,r,0,0,1)}skewX(t){let r=ji(t);return this.multiply(1,r,0,0,1,0,0,0,1)}skewY(t){let r=ji(t);return this.multiply(1,0,0,r,1,0,0,0,1)}toString(t){return ki.length=0,this.toTransformArray(t,ki),ki.map(pt).join(" ")}toTransformArray(t,r){let s=this.elements,a=!!r,o=s[0],d=s[1],f=s[2],_=s[3],u=s[4],x=s[5];if(t){let w=s[6],S=s[7],T=s[8];if(a){r[0]=o,r[1]=_,r[2]=w,r[3]=d,r[4]=u,r[5]=S,r[6]=f,r[7]=x,r[8]=T;return}return[o,_,w,d,u,S,f,x,T]}if(a){r[0]=o,r[1]=_,r[2]=d,r[3]=u,r[4]=f,r[5]=x;return}return[o,_,d,u,f,x]}toArray(t,r){let s=this.elements,a=!!r,o=s[0],d=s[1],f=s[2],_=s[3],u=s[4],x=s[5];if(t){let w=s[6],S=s[7],T=s[8];if(a){r[0]=o,r[1]=d,r[2]=f,r[3]=_,r[4]=u,r[5]=x,r[6]=w,r[7]=S,r[8]=T;return}return[o,d,f,_,u,x,w,S,T]}if(a){r[0]=o,r[1]=d,r[2]=f,r[3]=_,r[4]=u,r[5]=x;return}return[o,d,f,_,u,x]}toObject(){return{elements:this.toArray(!0),manual:!!this.manual}}clone(){return new oe().copy(this)}},Le=oe;g(Le,"Identity",[1,0,0,0,1,0,0,0,1]),V(Le);var we=class extends Ge{constructor(){super();m(this,"_flagMatrix",!0);m(this,"_flagScale",!1);m(this,"_matrix",null);m(this,"_worldMatrix",null);m(this,"_position",null);m(this,"_rotation",0);m(this,"_scale",1);m(this,"_skewX",0);m(this,"_skewY",0);for(let t in Ke)Object.defineProperty(this,t,Ke[t]);this._renderer.flagMatrix=Gi.bind(this),this.isShape=!0,this.id=xt.Identifier+xt.uniqueId(),this.matrix=new Le,this.worldMatrix=new Le,this.position=new N,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}get renderer(){return this._renderer}set renderer(t){this._renderer=t}get translation(){return Ke.position.get.apply(this,arguments)}set translation(t){Ke.position.set.apply(this,arguments)}addTo(t){return t.add(this),this}remove(){return this.parent?(this.parent.remove(this),this):this}clone(t){let r=new we;return r.position.copy(this.position),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),t&&t.add(r),r._update()}_update(t){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.position.x,this.position.y),this._scale instanceof N?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),t&&this.parent&&this.parent._update&&this.parent._update(),this}flagReset(){return this._flagMatrix=this._flagScale=!1,super.flagReset.call(this),this}},Ke={position:{enumerable:!0,get:function(){return this._position},set:function(i){this._position&&this._position.unbind(E.Types.change,this._renderer.flagMatrix),this._position=i,this._position.bind(E.Types.change,this._renderer.flagMatrix),Gi.call(this)}},rotation:{enumerable:!0,get:function(){return this._rotation},set:function(i){this._rotation=i,this._flagMatrix=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof N&&this._scale.unbind(E.Types.change,this._renderer.flagMatrix),this._scale=i,this._scale instanceof N&&this._scale.bind(E.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}},skewX:{enumerable:!0,get:function(){return this._skewX},set:function(i){this._skewX=i,this._flagMatrix=!0}},skewY:{enumerable:!0,get:function(){return this._skewY},set:function(i){this._skewY=i,this._flagMatrix=!0}},matrix:{enumerable:!0,get:function(){return this._matrix},set:function(i){this._matrix=i,this._flagMatrix=!0}},worldMatrix:{enumerable:!0,get:function(){return H(this,this._worldMatrix),this._worldMatrix},set:function(i){this._worldMatrix=i}}};function Gi(){this._flagMatrix=!0}var Ae=class extends Array{constructor(){super();m(this,"_events",new E);arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&this.push.apply(this,arguments[0]):arguments.length>0&&this.push.apply(this,arguments)}get _bound(){return this._events._bound}set _bound(t){this._events._bound=t}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.on.apply(this,arguments)}bind(){return this._events.bind.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.off.apply(this,arguments)}unbind(){return this._events.unbind.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.trigger.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}pop(){let t=super.pop.apply(this,arguments);return this.trigger(E.Types.remove,[t]),t}shift(){let t=super.shift.apply(this,arguments);return this.trigger(E.Types.remove,[t]),t}push(){let t=super.push.apply(this,arguments);return this.trigger(E.Types.insert,arguments),t}unshift(){let t=super.unshift.apply(this,arguments);return this.trigger(E.Types.insert,arguments),t}splice(){let t=super.splice.apply(this,arguments);if(this.trigger(E.Types.remove,t),arguments.length>2){let r=this.slice(arguments[0],arguments[0]+arguments.length-2);this.trigger(E.Types.insert,r),this.trigger(E.Types.order)}return t}sort(){return super.sort.apply(this,arguments),this.trigger(E.Types.order),this}reverse(){return super.reverse.apply(this,arguments),this.trigger(E.Types.order),this}indexOf(){return super.indexOf.apply(this,arguments)}map(t,r){let s=[];for(let a=0;a<this.length;a++){let o=this[a],d;r?d=t.call(r,o,a):d=t(o,a),s.push(d)}return s}},Ki=class extends Ae{constructor(t){t=Array.isArray(t)?t:Array.prototype.slice.call(arguments);super(t);m(this,"ids",{});this.attach(t),this.on(E.Types.insert,this.attach),this.on(E.Types.remove,this.detach)}attach(t){for(let r=0;r<t.length;r++){let s=t[r];s&&s.id&&(this.ids[s.id]=s)}return this}detach(t){for(let r=0;r<t.length;r++)delete this.ids[t[r].id];return this}},Qe=Math.min,$e=Math.max,Qi=class extends we{constructor(t){super();m(this,"_flagAdditions",!1);m(this,"_flagSubtractions",!1);m(this,"_flagOrder",!1);m(this,"_flagOpacity",!0);m(this,"_flagBeginning",!1);m(this,"_flagEnding",!1);m(this,"_flagLength",!1);m(this,"_flagMask",!1);m(this,"_fill","#fff");m(this,"_stroke","#000");m(this,"_linewidth",1);m(this,"_opacity",1);m(this,"_visible",!0);m(this,"_cap","round");m(this,"_join","round");m(this,"_miter",4);m(this,"_closed",!0);m(this,"_curved",!1);m(this,"_automatic",!0);m(this,"_beginning",0);m(this,"_ending",1);m(this,"_length",0);m(this,"_mask",null);for(let r in $i)Object.defineProperty(this,r,$i[r]);this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(t)?t:Array.prototype.slice.call(arguments)}static InsertChildren(t){for(let r=0;r<t.length;r++)Zi.call(this,t[r],this)}static RemoveChildren(t){for(let r=0;r<t.length;r++)Zi.call(this,t[r])}static OrderChildren(t){this._flagOrder=!0}clone(t){let r=new Qi,s=this.children.map(function(a){return a.clone()});return r.add(s),r.opacity=this.opacity,this.mask&&(r.mask=this.mask),r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.className=this.className,this.matrix.manual&&r.matrix.copy(this.matrix),t&&t.add(r),r._update()}toObject(){let t={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof N?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(t.matrix=this.matrix.toObject()),j.each(this.children,function(r,s){t.children[s]=r.toObject()},this),t}corner(){let t=this.getBoundingClientRect(!0);for(let r=0;r<this.children.length;r++){let s=this.children[r];s.translation.x-=t.left,s.translation.y-=t.top}return this.mask&&(this.mask.translation.x-=t.left,this.mask.translation.y-=t.top),this}center(){let t=this.getBoundingClientRect(!0),r=t.left+t.width/2-this.translation.x,s=t.top+t.height/2-this.translation.y;for(let a=0;a<this.children.length;a++){let o=this.children[a];o.isShape&&(o.translation.x-=r,o.translation.y-=s)}return this.mask&&(this.mask.translation.x-=r,this.mask.translation.y-=s),this}getById(t){let r=null;function s(a){if(a.id===t)return a;if(a.children){for(let o=0;o<a.children.length;o++)if(r=s(a.children[o]),r)return r}return null}return s(this)}getByClassName(t){let r=[];function s(a){if(Array.prototype.indexOf.call(a.classList,t)>=0&&r.push(a),a.children)for(let o=0;o<a.children.length;o++){let d=a.children[o];s(d)}return r}return s(this)}getByType(t){let r=[];function s(a){if(a instanceof t&&r.push(a),a.children)for(let o=0;o<a.children.length;o++){let d=a.children[o];s(d)}return r}return s(this)}add(t){t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(let r=0;r<t.length;r++){let s=t[r];if(!(s&&s.id))continue;let a=Array.prototype.indexOf.call(this.children,s);a>=0&&this.children.splice(a,1),this.children.push(s)}return this}remove(t){let r=arguments.length,s=this.parent;if(r<=0&&s)return s.remove(this),this;t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(let a=0;a<t.length;a++){let o=t[a];if(!o||!this.children.ids[o.id])continue;let d=this.children.indexOf(o);d>=0&&this.children.splice(d,1)}return this}getBoundingClientRect(t){let r,s,a,o,d,f;this._update(!0);let _=1/0,u=-1/0,x=1/0,w=-1/0,S=/texture|gradient/i;s=t?this.matrix:this.worldMatrix;for(let T=0;T<this.children.length;T++){let A=this.children[T];if(!(!A.visible||S.test(A._renderer.type))&&(r=A.getBoundingClientRect(t),a=typeof r.top!="number"||j.isNaN(r.top)||!isFinite(r.top),o=typeof r.left!="number"||j.isNaN(r.left)||!isFinite(r.left),d=typeof r.right!="number"||j.isNaN(r.right)||!isFinite(r.right),f=typeof r.bottom!="number"||j.isNaN(r.bottom)||!isFinite(r.bottom),!(a||o||d||f)))if(t){let[F,z]=s.multiply(r.left,r.top),[C,P]=s.multiply(r.right,r.top),[Y,q]=s.multiply(r.left,r.bottom),[D,X]=s.multiply(r.right,r.bottom);x=Qe(z,P,q,X),_=Qe(F,C,Y,D),u=$e(F,C,Y,D),w=$e(z,P,q,X)}else x=Qe(r.top,x),_=Qe(r.left,_),u=$e(r.right,u),w=$e(r.bottom,w)}return{top:x,left:_,right:u,bottom:w,width:u-_,height:w-x}}noFill(){return this.children.forEach(function(t){t.noFill()}),this}noStroke(){return this.children.forEach(function(t){t.noStroke()}),this}subdivide(){let t=arguments;return this.children.forEach(function(r){r.subdivide.apply(r,t)}),this}_update(){let t,r,s;if(this._flagBeginning||this._flagEnding){let a=Math.min(this._beginning,this._ending),o=Math.max(this._beginning,this._ending),d=this.length,f=0,_=a*d,u=o*d;for(t=0;t<this.children.length;t++)s=this.children[t],r=s.length,_>f+r?(s.beginning=1,s.ending=1):u<f?(s.beginning=0,s.ending=0):_>f&&_<f+r?(s.beginning=(_-f)/r,s.ending=1):u>f&&u<f+r?(s.beginning=0,s.ending=(u-f)/r):(s.beginning=0,s.ending=1),f+=r}return super._update.apply(this,arguments)}flagReset(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,super.flagReset.call(this),this}},Ot=Qi;g(Ot,"Children",Ki),g(Ot,"Properties",["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"]);var $i={visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._flagVisible=this._visible!==i||this._flagVisible,this._visible=i}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._flagOpacity=this._opacity!==i||this._flagOpacity,this._opacity=i}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._flagBeginning=this._beginning!==i||this._flagBeginning,this._beginning=i}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._flagEnding=this._ending!==i||this._flagEnding,this._ending=i}},length:{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(let i=0;i<this.children.length;i++){let t=this.children[i];this._length+=t.length}}return this._length}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){this._fill=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.fill=i}}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){this._stroke=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.stroke=i}}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.linewidth=i}}},join:{enumerable:!0,get:function(){return this._join},set:function(i){this._join=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.join=i}}},miter:{enumerable:!0,get:function(){return this._miter},set:function(i){this._miter=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.miter=i}}},cap:{enumerable:!0,get:function(){return this._cap},set:function(i){this._cap=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.cap=i}}},closed:{enumerable:!0,get:function(){return this._closed},set:function(i){this._closed=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.closed=i}}},curved:{enumerable:!0,get:function(){return this._curved},set:function(i){this._curved=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.curved=i}}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(i){this._automatic=i;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.automatic=i}}},children:{enumerable:!0,get:function(){return this._children},set:function(i){let t=Ot.InsertChildren.bind(this),r=Ot.RemoveChildren.bind(this),s=Ot.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&r(this._children)),this._children=new Ki(i),this._children.bind(E.Types.insert,t),this._children.bind(E.Types.remove,r),this._children.bind(E.Types.order,s),i.length>0&&t(i)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,j.isObject(i)&&!i.clip&&(i.clip=!0)}}};function Zi(i,t){let r=i.parent,s;if(r===t){a();return}if(r&&r.children.ids[i.id]&&(s=Array.prototype.indexOf.call(r.children,i),r.children.splice(s,1),o()),t){a();return}o(),r._flagAdditions&&r.additions.length===0&&(r._flagAdditions=!1),r._flagSubtractions&&r.subtractions.length===0&&(r._flagSubtractions=!1),delete i.parent;function a(){t.subtractions.length>0&&(s=Array.prototype.indexOf.call(t.subtractions,i),s>=0&&t.subtractions.splice(s,1)),t.additions.length>0&&(s=Array.prototype.indexOf.call(t.additions,i),s>=0&&t.additions.splice(s,1)),i.parent=t,t.additions.push(i),t._flagAdditions=!0}function o(){s=Array.prototype.indexOf.call(r.additions,i),s>=0&&r.additions.splice(s,1),s=Array.prototype.indexOf.call(r.subtractions,i),s<0&&(r.subtractions.push(i),r._flagSubtractions=!0)}}var Ei=[],Si=Math.max,fs=Math.min,tr=Math.abs,Ze=Math.sin,ti=Math.cos,us=Math.acos,ei=Math.sqrt,Lt={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},baselines:{top:"top",middle:"middle",bottom:"bottom",baseline:"alphabetic"},shim:function(i,t){return i.tagName=i.nodeName=t||"canvas",i.nodeType=1,i.getAttribute=function(r){return this[r]},i.setAttribute=function(r,s){return this[r]=s,this},i},group:{renderChild:function(i){Lt[i._renderer.type].render.call(i,this.ctx,!0,this.clip)},render:function(i){if(!this._visible)return this;this._update();let t=this._matrix.elements,r=this.parent;this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);let s=this._mask,a=ii(t),o=!a||!!s;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=i,o&&(i.save(),a||i.transform(t[0],t[3],t[1],t[4],t[2],t[5])),s&&Lt[s._renderer.type].render.call(s,i,!0),this._opacity>0&&this._scale!==0)for(let d=0;d<this.children.length;d++){let f=this.children[d];Lt[f._renderer.type].render.call(f,i)}return o&&i.restore(),this.flagReset()}},path:{render:function(i,t,r){let s,a,o,d,f,_,u,x,w,S,T,A,F,z,C,P,Y,q,D,X,$,at,rt,et,dt,ct,bt,mt,Nt,Ht,Pt,ee,Ut,be;if(be=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,Nt=this._mask,Ht=this._clip,f=this._opacity*(be||1),_=this._visible,!t&&(!_||Ht||f===0))return this;this._update(),s=this._matrix.elements,a=this._stroke,o=this._linewidth,d=this._fill,u=this._cap,x=this._join,w=this._miter,S=this._closed,T=this._renderer.vertices,A=T.length,F=A-1,Pt=ii(s),Ut=this.dashes,Pt||(i.save(),i.transform(s[0],s[3],s[1],s[4],s[2],s[5])),Nt&&Lt[Nt._renderer.type].render.call(Nt,i,!0),d&&(typeof d=="string"?i.fillStyle=d:(Lt[d._renderer.type].render.call(d,i,this),i.fillStyle=d._renderer.effect)),a&&(typeof a=="string"?i.strokeStyle=a:(Lt[a._renderer.type].render.call(a,i,this),i.strokeStyle=a._renderer.effect),o&&(i.lineWidth=o),w&&(i.miterLimit=w),x&&(i.lineJoin=x),!S&&u&&(i.lineCap=u)),typeof f=="number"&&(i.globalAlpha=f),Ut&&Ut.length>0&&(i.lineDashOffset=Ut.offset||0,i.setLineDash(Ut)),i.beginPath();let Te,Ue,Xe,He,Je,je,_e;for(let wt=0;wt<A;wt++)switch(P=T[wt],bt=P.x,mt=P.y,P.command){case k.close:i.closePath();break;case k.arc:Te=P.rx,Ue=P.ry,Xe=P.xAxisRotation,He=P.largeArcFlag,Je=P.sweepFlag,z=S?K(wt-1,A):Si(wt-1,0),C=T[z],je=C.x,_e=C.y,Lt.renderSvgArcCommand(i,je,_e,Te,Ue,He,Je,Xe,bt,mt);break;case k.curve:z=S?K(wt-1,A):Math.max(wt-1,0),C=T[z],rt=C.controls&&C.controls.right||N.zero,et=P.controls&&P.controls.left||N.zero,C._relative?($=rt.x+C.x,at=rt.y+C.y):($=rt.x,at=rt.y),P._relative?(D=et.x+P.x,X=et.y+P.y):(D=et.x,X=et.y),i.bezierCurveTo($,at,D,X,bt,mt),wt>=F&&S&&(Y=q,dt=P.controls&&P.controls.right||N.zero,ct=Y.controls&&Y.controls.left||N.zero,P._relative?($=dt.x+P.x,at=dt.y+P.y):($=dt.x,at=dt.y),Y._relative?(D=ct.x+Y.x,X=ct.y+Y.y):(D=ct.x,X=ct.y),bt=Y.x,mt=Y.y,i.bezierCurveTo($,at,D,X,bt,mt));break;case k.line:i.lineTo(bt,mt);break;case k.move:q=P,i.moveTo(bt,mt);break}return S&&i.closePath(),!Ht&&!r&&(Lt.isHidden.test(d)||(ee=d._renderer&&d._renderer.offset,ee&&(i.save(),i.translate(-d._renderer.offset.x,-d._renderer.offset.y),i.scale(d._renderer.scale.x,d._renderer.scale.y)),i.fill(),ee&&i.restore()),Lt.isHidden.test(a)||(ee=a._renderer&&a._renderer.offset,ee&&(i.save(),i.translate(-a._renderer.offset.x,-a._renderer.offset.y),i.scale(a._renderer.scale.x,a._renderer.scale.y),i.lineWidth=o/a._renderer.scale.x),i.stroke(),ee&&i.restore())),Pt||i.restore(),Ht&&!r&&i.clip(),Ut&&Ut.length>0&&i.setLineDash(Ei),this.flagReset()}},points:{render:function(i,t,r){let s,a,o,d,f,_,u,x,w,S,T,A,F,z,C,P;if(P=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,f=this._opacity*(P||1),_=this._visible,!t&&(!_||f===0))return this;this._update(),s=this._matrix.elements,a=this._stroke,o=this._linewidth,d=this._fill,x=this._renderer.collection,w=x.length,F=ii(s),C=this.dashes,u=this._size,F||(i.save(),i.transform(s[0],s[3],s[1],s[4],s[2],s[5])),d&&(typeof d=="string"?i.fillStyle=d:(Lt[d._renderer.type].render.call(d,i,this),i.fillStyle=d._renderer.effect)),a&&(typeof a=="string"?i.strokeStyle=a:(Lt[a._renderer.type].render.call(a,i,this),i.strokeStyle=a._renderer.effect),o&&(i.lineWidth=o)),typeof f=="number"&&(i.globalAlpha=f),C&&C.length>0&&(i.lineDashOffset=C.offset||0,i.setLineDash(C)),i.beginPath();let Y=u*.5,q;this._sizeAttenuation||(q=this.worldMatrix.elements,q=B(q[0],q[3],q[1],q[4],q[2],q[5]),Y/=Math.max(q.scaleX,q.scaleY));for(let D=0;D<w;D++)S=x[D],T=S.x,A=S.y,i.moveTo(T+Y,A),i.arc(T,A,Y,0,L);return r||(Lt.isHidden.test(d)||(z=d._renderer&&d._renderer.offset,z&&(i.save(),i.translate(-d._renderer.offset.x,-d._renderer.offset.y),i.scale(d._renderer.scale.x,d._renderer.scale.y)),i.fill(),z&&i.restore()),Lt.isHidden.test(a)||(z=a._renderer&&a._renderer.offset,z&&(i.save(),i.translate(-a._renderer.offset.x,-a._renderer.offset.y),i.scale(a._renderer.scale.x,a._renderer.scale.y),i.lineWidth=o/a._renderer.scale.x),i.stroke(),z&&i.restore())),F||i.restore(),C&&C.length>0&&i.setLineDash(Ei),this.flagReset()}},text:{render:function(i,t,r){let s=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,a=this._opacity*s,o=this._visible,d=this._mask,f=this._clip;if(!t&&(!o||f||a===0))return this;this._update();let _=this._matrix.elements,u=this._stroke,x=this._linewidth,w=this._fill,S=this._decoration,T=this._direction,A=ii(_),F=w._renderer&&w._renderer.offset&&u._renderer&&u._renderer.offset,z=this.dashes,C=Lt.alignments[this._alignment]||this._alignment,P=Lt.baselines[this._baseline]||this._baseline,Y,q,D,X,$,at,rt,et,dt,ct,bt;if(A||(i.save(),i.transform(_[0],_[3],_[1],_[4],_[2],_[5])),d&&Lt[d._renderer.type].render.call(d,i,!0),F||(i.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),i.textAlign=C,i.textBaseline=P,i.direction=T,w&&(typeof w=="string"?i.fillStyle=w:(Lt[w._renderer.type].render.call(w,i,this),i.fillStyle=w._renderer.effect)),u&&(typeof u=="string"?i.strokeStyle=u:(Lt[u._renderer.type].render.call(u,i,this),i.strokeStyle=u._renderer.effect),x&&(i.lineWidth=x)),typeof a=="number"&&(i.globalAlpha=a),z&&z.length>0&&(i.lineDashOffset=z.offset||0,i.setLineDash(z)),!f&&!r&&(Lt.isHidden.test(w)||(w._renderer&&w._renderer.offset?(at=w._renderer.scale.x,rt=w._renderer.scale.y,i.save(),i.translate(-w._renderer.offset.x,-w._renderer.offset.y),i.scale(at,rt),Y=this._size/w._renderer.scale.y,q=this._leading/w._renderer.scale.y,i.font=[this._style,this._weight,Y+"px/",q+"px",this._family].join(" "),D=w._renderer.offset.x/w._renderer.scale.x,X=w._renderer.offset.y/w._renderer.scale.y,i.fillText(this.value,D,X),i.restore()):i.fillText(this.value,0,0)),Lt.isHidden.test(u)||(u._renderer&&u._renderer.offset?(at=u._renderer.scale.x,rt=u._renderer.scale.y,i.save(),i.translate(-u._renderer.offset.x,-u._renderer.offset.y),i.scale(at,rt),Y=this._size/u._renderer.scale.y,q=this._leading/u._renderer.scale.y,i.font=[this._style,this._weight,Y+"px/",q+"px",this._family].join(" "),D=u._renderer.offset.x/u._renderer.scale.x,X=u._renderer.offset.y/u._renderer.scale.y,$=x/u._renderer.scale.x,i.lineWidth=$,i.strokeText(this.value,D,X),i.restore()):i.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(S)){let mt=i.measureText(this.value),Nt=1;switch(S){case"underline":dt=mt.actualBoundingBoxDescent,bt=mt.actualBoundingBoxDescent;break;case"strikethrough":dt=0,bt=0,Nt=.5;break}switch(P){case"top":dt+=this._size*Nt,bt+=this._size*Nt;break;case"baseline":case"bottom":dt-=this._size*Nt,bt-=this._size*Nt;break}switch(C){case"left":case"start":et=0,ct=mt.width;break;case"right":case"end":et=-mt.width,ct=0;break;default:et=-mt.width/2,ct=mt.width/2}i.lineWidth=Math.max(Math.floor(this._size/15),1),i.strokeStyle=i.fillStyle,i.beginPath(),i.moveTo(et,dt),i.lineTo(ct,bt),i.stroke()}return A||i.restore(),f&&!r&&i.clip(),z&&z.length>0&&i.setLineDash(Ei),this.flagReset()}},"linear-gradient":{render:function(i,t){if(t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,s=this.left._x,a=this.left._y,o=this.right._x,d=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),s=(s-.5)*r.width,a=(a-.5)*r.height,o=(o-.5)*r.width,d=(d-.5)*r.height),this._renderer.effect=i.createLinearGradient(s,a,o,d);for(let f=0;f<this.stops.length;f++){let _=this.stops[f];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},"radial-gradient":{render:function(i,t){if(t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,s=this.center._x,a=this.center._y,o=this.focal._x,d=this.focal._y,f=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),s=s*r.width*.5,a=a*r.height*.5,o=o*r.width*.5,d=d*r.height*.5,f*=Math.min(r.width,r.height)*.5),this._renderer.effect=i.createRadialGradient(s,a,0,o,d,f);for(let _=0;_<this.stops.length;_++){let u=this.stops[_];this._renderer.effect.addColorStop(u._offset,u._color)}}return this.flagReset()}}},texture:{render:function(i){this._update();let t=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=i.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof N||(this._renderer.offset=new N),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,t&&(this._renderer.offset.x+=t.width/2,this._renderer.offset.y+=t.height/2,this._scale instanceof N?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(i,t,r,s,a,o,d,f,_,u){f=f*Math.PI/180,s=tr(s),a=tr(a);let x=(t-_)/2,w=(r-u)/2,S=ti(f)*x+Ze(f)*w,T=-Ze(f)*x+ti(f)*w,A=S*S,F=T*T,z=s*s,C=a*a,P=A/z+F/C;if(P>1){let bt=ei(P);s=bt*s,a=bt*a,z=s*s,C=a*a}let Y=z*F+C*A,q=(z*C-Y)/Y,D=ei(Si(0,q));o===d&&(D=-D);let X=D*s*T/a,$=-D*a*S/s,at=ti(f)*X-Ze(f)*$+(t+_)/2,rt=Ze(f)*X+ti(f)*$+(r+u)/2,et=er(1,0,(S-X)/s,(T-$)/a),dt=er((S-X)/s,(T-$)/a,(-S-X)/s,(-T-$)/a)%L,ct=et+dt;_s(i,at,rt,s,a,et,ct,d===0,f)}},Fe=class extends E{constructor(i){super();let t=i.smoothing!==!1;this.domElement=i.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=i.overdraw||!1,typeof this.ctx.imageSmoothingEnabled<"u"&&(this.ctx.imageSmoothingEnabled=t),this.scene=new Ot,this.scene.parent=this}setSize(i,t,r){return this.width=i,this.height=t,this.ratio=typeof r>"u"?Ai(this.ctx):r,this.domElement.width=i*this.ratio,this.domElement.height=t*this.ratio,this.domElement.style&&j.extend(this.domElement.style,{width:i+"px",height:t+"px"}),this.trigger(E.Types.resize,i,t,r)}render(){let i=this.ratio===1;return i||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),Lt.group.render.call(this.scene,this.ctx),i||this.ctx.restore(),this}};g(Fe,"Utils",Lt);function _s(i,t,r,s,a,o,d,f,_){let u=d-o,x=ae.Tolerance.epsilon,w=Math.abs(u)<x,S=K(u,L);S<x&&(w?S=0:S=L),f===!0&&!w&&(S===L?S=-L:S=S-L);for(let T=0;T<xt.Resolution;T++){let A=T/(xt.Resolution-1),F=o+A*S,z=t+s*Math.cos(F),C=r+a*Math.sin(F);if(_!==0){let P=Math.cos(_),Y=Math.sin(_),q=z-t,D=C-r;z=q*P-D*Y+t,C=q*Y+D*P+r}i.lineTo(z,C)}}function er(i,t,r,s){let a=i*r+t*s,o=ei(i*i+t*t)*ei(r*r+s*s),d=us(Si(-1,fs(1,a/o)));return i*s-t*r<0&&(d=-d),d}function ii(i){return i[0]==1&&i[3]==0&&i[1]==0&&i[4]==1&&i[2]==0&&i[5]==0}var $t={Image:null,isHeadless:!1,shim:function(i,t){return Fe.Utils.shim(i),typeof t<"u"&&($t.Image=t),$t.isHeadless=!0,i}},Zt={hasEventListeners:typeof O.addEventListener=="function",bind:function(i,t,r,s){return this.hasEventListeners?i.addEventListener(t,r,!!s):i.attachEvent("on"+t,r),Zt},unbind:function(i,t,r,s){return Zt.hasEventListeners?i.removeEventListeners(t,r,!!s):i.detachEvent("on"+t,r),Zt},getRequestAnimationFrame:function(){let i=["ms","moz","webkit","o"],t=0,r=O.requestAnimationFrame;if(!r){for(let a=0;a<i.length;a++)r=O[i[a]+"RequestAnimationFrame"]||r;r=r||s}function s(a,o){let d=new Date().getTime(),f=Math.max(0,16-(d-t)),_=O.setTimeout(u,f);t=d+f;function u(){a(d+f)}return _}return r}},Ie=O.document?O.document.createElement("div"):{};Ie.id="help-two-load",Object.defineProperty(Zt,"temp",{enumerable:!0,get:function(){return j.isElement(Ie)&&!O.document.head.contains(Ie)&&(Ie.style.display="none",O.document.head.appendChild(Ie)),Ie}});var te=class extends Error{constructor(t){super();m(this,"name","Two.js");m(this,"message");this.message=t}},ri=class{constructor(){m(this,"map",{})}add(i,t){return this.map[i]=t,this}remove(i){return delete this.map[i],this}get(i){return this.map[i]}contains(i){return i in this.map}};function ir(i,t){if(t===0||t===1)return!0;let r=i._length*t,s=0;for(let a=0;a<i._lengths.length;a++){let o=i._lengths[a];if(s>=r)return r-s>=0;s+=o}return!1}function si(i,t){let r=i._length;if(t<=0)return 0;if(t>=r)return i._lengths.length-1;for(let s=0,a=0;s<i._lengths.length;s++){if(a+i._lengths[s]>=t)return t-=a,Math.max(s-1,0)+t/i._lengths[s];a+=i._lengths[s]}return-1}function Ti(i,t,r){let s,a,o,d,f,_,u,x,w=t.controls&&t.controls.right,S=i.controls&&i.controls.left;return s=t.x,f=t.y,a=(w||t).x,_=(w||t).y,o=(S||i).x,u=(S||i).y,d=i.x,x=i.y,w&&t._relative&&(a+=t.x,_+=t.y),S&&i._relative&&(o+=i.x,u+=i.y),Vi(s,f,a,_,o,u,d,x,r)}function rr(i,t,r){let s,a,o,d,f,_,u,x,w=t.controls&&t.controls.right,S=i.controls&&i.controls.left;return s=t.x,f=t.y,a=(w||t).x,_=(w||t).y,o=(S||i).x,u=(S||i).y,d=i.x,x=i.y,w&&t._relative&&(a+=t.x,_+=t.y),S&&i._relative&&(o+=i.x,u+=i.y),xi(s,f,a,_,o,u,d,x,r)}var ke=class extends Ge{constructor(t,r,s){super();m(this,"_flagOffset",!0);m(this,"_flagOpacity",!0);m(this,"_flagColor",!0);m(this,"_offset",0);m(this,"_opacity",1);m(this,"_color","#fff");for(let a in sr)Object.defineProperty(this,a,sr[a]);this._renderer.type="stop",this.offset=typeof t=="number"?t:ke.Index<=0?0:1,this.opacity=typeof s=="number"?s:1,this.color=typeof r=="string"?r:ke.Index<=0?"#fff":"#000",ke.Index=(ke.Index+1)%2}clone(t){let r=new ke;return j.each(ke.Properties,function(s){r[s]=this[s]},this),t&&t.stops&&t.stops.push(r),r}toObject(){let t={};return j.each(ke.Properties,function(r){t[r]=this[r]},this),t}flagReset(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,super.flagReset.call(this),this}},Ee=ke;g(Ee,"Index",0),g(Ee,"Properties",["offset","opacity","color"]);var sr={offset:{enumerable:!0,get:function(){return this._offset},set:function(i){this._offset=i,this._flagOffset=!0,this.parent&&(this.parent._flagStops=!0)}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0,this.parent&&(this.parent._flagStops=!0)}},color:{enumerable:!0,get:function(){return this._color},set:function(i){this._color=i,this._flagColor=!0,this.parent&&(this.parent._flagStops=!0)}}},ni=class extends Ge{constructor(t){super();m(this,"_flagStops",!1);m(this,"_flagSpread",!1);m(this,"_flagUnits",!1);m(this,"_spread","");m(this,"_units","");for(let r in nr)Object.defineProperty(this,r,nr[r]);this._renderer.type="gradient",this.id=xt.Identifier+xt.uniqueId(),this.classList=[],this._renderer.flagStops=ps.bind(this),this._renderer.bindStops=ms.bind(this),this._renderer.unbindStops=gs.bind(this),this.spread="pad",this.units="objectBoundingBox",t&&(this.stops=t)}clone(t){let r=this.stops.map(function(a){return a.clone()}),s=new ni(r);return j.each(ni.Properties,function(a){s[a]=this[a]},this),t&&t.add(s),s}toObject(){let t={stops:this.stops.map(function(r){return r.toObject()})};return j.each(ni.Properties,function(r){t[r]=this[r]},this),t}_update(){return(this._flagSpread||this._flagStops)&&this.trigger(E.Types.change),this}flagReset(){return this._flagSpread=this._flagUnits=this._flagStops=!1,super.flagReset.call(this),this}},zt=ni;g(zt,"Stop",Ee),g(zt,"Properties",["spread","stops","renderer","units"]);var nr={spread:{enumerable:!0,get:function(){return this._spread},set:function(i){this._spread=i,this._flagSpread=!0}},units:{enumerable:!0,get:function(){return this._units},set:function(i){this._units=i,this._flagUnits=!0}},stops:{enumerable:!0,get:function(){return this._stops},set:function(i){let t=this._renderer.bindStops,r=this._renderer.unbindStops;this._stops&&this._stops.unbind(E.Types.insert,t).unbind(E.Types.remove,r),this._stops=new Ae((i||[]).slice(0)),this._stops.bind(E.Types.insert,t).bind(E.Types.remove,r),t(this._stops)}}};function ps(){this._flagStops=!0}function ms(i){let t=i.length;for(;t--;)i[t].bind(E.Types.change,this._renderer.flagStops),i[t].parent=this;this._renderer.flagStops()}function gs(i){let t=i.length;for(;t--;)i[t].unbind(E.Types.change,this._renderer.flagStops),delete i[t].parent;this._renderer.flagStops()}var ar=class extends zt{constructor(t,r,s,a,o){super(o);m(this,"_flagEndPoints",!1);m(this,"_left",null);m(this,"_right",null);for(let d in or)Object.defineProperty(this,d,or[d]);this._renderer.type="linear-gradient",this._renderer.flagEndPoints=ys.bind(this),this.left=new N,this.right=new N,typeof t=="number"&&(this.left.x=t),typeof r=="number"&&(this.left.y=r),typeof s=="number"&&(this.right.x=s),typeof a=="number"&&(this.right.y=a)}clone(t){let r=this.stops.map(function(a){return a.clone()}),s=new ar(this.left._x,this.left._y,this.right._x,this.right._y,r);return j.each(zt.Properties,function(a){s[a]=this[a]},this),t&&t.add(s),s}toObject(){let t=super.toObject.call(this);return t.left=this.left.toObject(),t.right=this.right.toObject(),t}_update(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(E.Types.change),this}flagReset(){return this._flagEndPoints=!1,super.flagReset.call(this),this}},Tt=ar;g(Tt,"Properties",["left","right"]),g(Tt,"Stop",Ee);var or={left:{enumerable:!0,get:function(){return this._left},set:function(i){this._left instanceof N&&this._left.unbind(E.Types.change,this._renderer.flagEndPoints),this._left=i,this._left.bind(E.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}},right:{enumerable:!0,get:function(){return this._right},set:function(i){this._right instanceof N&&this._right.unbind(E.Types.change,this._renderer.flagEndPoints),this._right=i,this._right.bind(E.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}}};function ys(){this._flagEndPoints=!0}var ai=class extends zt{constructor(t,r,s,a,o,d){super(a);m(this,"_flagRadius",!1);m(this,"_flagCenter",!1);m(this,"_flagFocal",!1);m(this,"_radius",0);m(this,"_center",null);m(this,"_focal",null);for(let f in hr)Object.defineProperty(this,f,hr[f]);this._renderer.type="radial-gradient",this._renderer.flagCenter=vs.bind(this),this._renderer.flagFocal=bs.bind(this),this.center=new N,this.radius=typeof s=="number"?s:1,this.focal=new N,typeof t=="number"&&(this.center.x=t),typeof r=="number"&&(this.center.y=r),this.focal.copy(this.center),typeof o=="number"&&(this.focal.x=o),typeof d=="number"&&(this.focal.y=d)}clone(t){let r=this.stops.map(function(a){return a.clone()}),s=new ai(this.center._x,this.center._y,this._radius,r,this.focal._x,this.focal._y);return j.each(zt.Properties.concat(ai.Properties),function(a){s[a]=this[a]},this),t&&t.add(s),s}toObject(){let t=super.toObject.call(this);return j.each(ai.Properties,function(r){t[r]=this[r]},this),t.center=this.center.toObject(),t.focal=this.focal.toObject(),t}_update(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(E.Types.change),this}flagReset(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,super.flagReset.call(this),this}},Rt=ai;g(Rt,"Stop",Ee),g(Rt,"Properties",["center","radius","focal"]);var hr={radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius=i,this._flagRadius=!0}},center:{enumerable:!0,get:function(){return this._center},set:function(i){this._center&&this._center.unbind(E.Types.change,this._renderer.flagCenter),this._center=i,this._center.bind(E.Types.change,this._renderer.flagCenter),this._flagCenter=!0}},focal:{enumerable:!0,get:function(){return this._focal},set:function(i){this._focal&&this._focal.unbind(E.Types.change,this._renderer.flagFocal),this._focal=i,this._focal.bind(E.Types.change,this._renderer.flagFocal),this._flagFocal=!0}}};function vs(){this._flagCenter=!0}function bs(){this._flagFocal=!0}var oi,lr={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};O.document&&(oi=document.createElement("a"));var Dt=class extends Ge{constructor(t,r){super();m(this,"_flagSrc",!1);m(this,"_flagImage",!1);m(this,"_flagVideo",!1);m(this,"_flagLoaded",!1);m(this,"_flagRepeat",!1);m(this,"_flagOffset",!1);m(this,"_flagScale",!1);m(this,"_src","");m(this,"_image",null);m(this,"_loaded",!1);m(this,"_repeat","no-repeat");m(this,"_scale",1);m(this,"_offset",null);this._renderer={};for(let s in cr)Object.defineProperty(this,s,cr[s]);if(this._renderer.type="texture",this._renderer.flagOffset=xs.bind(this),this._renderer.flagScale=ws.bind(this),this.id=xt.Identifier+xt.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new N,typeof r=="function"){let s=(function(){this.unbind(E.Types.load,s),typeof r=="function"&&r()}).bind(this);this.bind(E.Types.load,s)}if(typeof t=="string")this.src=t;else if(typeof t=="object"){let s=Object.prototype.toString.call(t);(s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]"||s==="[object HTMLVideoElement]"||s==="[object Image]")&&(this.image=t)}this._update()}static getAbsoluteURL(t){return oi?(oi.href=t,oi.href):t}static loadHeadlessBuffer(t,r){t.image.onload=r,t.image.src=t.src}static getTag(t){return t&&t.nodeName&&t.nodeName.toLowerCase()||"img"}static getImage(t){let r=Dt.getAbsoluteURL(t);if(Dt.ImageRegistry.contains(r))return Dt.ImageRegistry.get(r);let s;return $t.Image?(s=new $t.Image,Fe.Utils.shim(s,"img")):O.document?lr.video.test(r)?s=document.createElement("video"):s=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),s.crossOrigin="anonymous",s.referrerPolicy="no-referrer",s}static load(t,r){let s=t.image,a=Dt.getTag(s);t._flagImage&&(/canvas/i.test(a)?Dt.Register.canvas(t,r):(t._src=!$t.isHeadless&&s.getAttribute("two-src")||s.src,Dt.Register[a](t,r))),t._flagSrc&&(s||(s=Dt.getImage(t.src),t.image=s),a=Dt.getTag(s),Dt.Register[a](t,r))}clone(){let t=new Dt(this.src);return t.repeat=this.repeat,t.offset.copy(this.origin),t.scale=this.scale,t}toObject(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}}_update(){return(this._flagSrc||this._flagImage)&&(this.trigger(E.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,Dt.load(this,(function(){this.loaded=!0,this.trigger(E.Types.change).trigger(E.Types.load)}).bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this}flagReset(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagRepeat=this._flagVideo=this._flagScale=this._flagOffset=!1,super.flagReset.call(this),this}},vt=Dt;g(vt,"Properties",["src","loaded","repeat","scale","offset","image"]),g(vt,"RegularExpressions",lr),g(vt,"ImageRegistry",new ri),g(vt,"Register",{canvas:function(i,t){i._src="#"+i.id,Dt.ImageRegistry.add(i.src,i.image),typeof t=="function"&&t()},img:function(i,t){let r=i.image,s=function(o){!$t.isHeadless&&r.removeEventListener&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",s,!1),r.removeEventListener("error",a,!1)),typeof t=="function"&&t()},a=function(o){throw!$t.isHeadless&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",s,!1),r.removeEventListener("error",a,!1)),new te("unable to load "+i.src)};typeof r.width=="number"&&r.width>0&&typeof r.height=="number"&&r.height>0?s():!$t.isHeadless&&typeof r.addEventListener=="function"&&(r.addEventListener("load",s,!1),r.addEventListener("error",a,!1)),i._src=Dt.getAbsoluteURL(i._src),!(!$t.isHeadless&&r&&r.getAttribute("two-src"))&&($t.isHeadless||r.setAttribute("two-src",i.src),Dt.ImageRegistry.add(i.src,r),$t.isHeadless?Dt.loadHeadlessBuffer(i,s):i.image.src=i.src)},video:function(i,t){if($t.isHeadless)throw new te("video textures are not implemented in headless environments.");let r=function(a){i.image.removeEventListener("canplaythrough",r,!1),i.image.removeEventListener("error",s,!1),i.image.width=i.image.videoWidth,i.image.height=i.image.videoHeight,typeof t=="function"&&t()},s=function(a){throw i.image.removeEventListener("canplaythrough",r,!1),i.image.removeEventListener("error",s,!1),new te("unable to load "+i.src)};i._src=Dt.getAbsoluteURL(i._src),i.image.getAttribute("two-src")||(i.image.setAttribute("two-src",i.src),Dt.ImageRegistry.add(i.src,i.image)),i.image.readyState>=4?r():(i.image.addEventListener("canplaythrough",r,!1),i.image.addEventListener("error",s,!1),i.image.src=i.src,i.image.load())}});var cr={src:{enumerable:!0,get:function(){return this._src},set:function(i){this._src=i,this._flagSrc=!0}},loaded:{enumerable:!0,get:function(){return this._loaded},set:function(i){this._loaded=i,this._flagLoaded=!0}},repeat:{enumerable:!0,get:function(){return this._repeat},set:function(i){this._repeat=i,this._flagRepeat=!0}},image:{enumerable:!0,get:function(){return this._image},set:function(i){let t=vt.getTag(i),r;switch(t){case"canvas":r="#"+i.id;break;default:r=i.src}vt.ImageRegistry.contains(r)?this._image=vt.ImageRegistry.get(i.src):this._image=i,this._flagImage=!0}},offset:{enumerable:!0,get:function(){return this._offset},set:function(i){this._offset&&this._offset.unbind(E.Types.change,this._renderer.flagOffset),this._offset=i,this._offset.bind(E.Types.change,this._renderer.flagOffset),this._flagOffset=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof N&&this._scale.unbind(E.Types.change,this._renderer.flagScale),this._scale=i,this._scale instanceof N&&this._scale.bind(E.Types.change,this._renderer.flagScale),this._flagScale=!0}}};function xs(){this._flagOffset=!0}function ws(){this._flagScale=!0}var Oe=Math.min,ze=Math.max,As=Math.ceil,ks=Math.floor,Es=new N,Ye=class extends we{constructor(t,r,s,a){super();m(this,"_flagVertices",!0);m(this,"_flagLength",!0);m(this,"_flagFill",!0);m(this,"_flagStroke",!0);m(this,"_flagLinewidth",!0);m(this,"_flagOpacity",!0);m(this,"_flagVisible",!0);m(this,"_flagCap",!0);m(this,"_flagJoin",!0);m(this,"_flagMiter",!0);m(this,"_flagMask",!1);m(this,"_flagClip",!1);m(this,"_length",0);m(this,"_fill","#fff");m(this,"_stroke","#000");m(this,"_linewidth",1);m(this,"_opacity",1);m(this,"_visible",!0);m(this,"_cap","round");m(this,"_join","round");m(this,"_miter",4);m(this,"_closed",!0);m(this,"_curved",!1);m(this,"_automatic",!0);m(this,"_beginning",0);m(this,"_ending",1);m(this,"_mask",null);m(this,"_clip",!1);m(this,"_dashes",null);for(let o in dr)Object.defineProperty(this,o,dr[o]);this._renderer.type="path",this._renderer.flagVertices=fr.bind(this),this._renderer.bindVertices=ur.bind(this),this._renderer.unbindVertices=_r.bind(this),this._renderer.flagFill=pr.bind(this),this._renderer.flagStroke=mr.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this.closed=!!r,this.curved=!!s,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=t,this.automatic=!a,this.dashes=[],this.dashes.offset=0}clone(t){let r=new Ye;for(let s=0;s<this.vertices.length;s++)r.vertices.push(this.vertices[s].clone());for(let s=0;s<Ye.Properties.length;s++){let a=Ye.Properties[s];r[a]=this[a]}return r.className=this.className,r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),t&&t.add(r),r._update()}toObject(){let t={vertices:this.vertices.map(function(r){return r.toObject()})};return j.each(Ye.Properties,function(r){typeof this[r]<"u"&&(this[r].toObject?t[r]=this[r].toObject():t[r]=this[r])},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof N?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this}corner(){let t=this.getBoundingClientRect(!0),r=t.width/2,s=t.height/2,a=t.left+t.width/2,o=t.top+t.height/2;for(let d=0;d<this.vertices.length;d++){let f=this.vertices[d];f.x-=a,f.y-=o,f.x+=r,f.y+=s}return this.mask&&(this.mask.translation.x-=a,this.mask.translation.x+=r,this.mask.translation.y-=o,this.mask.translation.y+=s),this}center(){let t=this.getBoundingClientRect(!0),r=t.left+t.width/2-this.translation.x,s=t.top+t.height/2-this.translation.y;for(let a=0;a<this.vertices.length;a++){let o=this.vertices[a];o.x-=r,o.y-=s}return this.mask&&(this.mask.translation.x-=r,this.mask.translation.y-=s),this}getBoundingClientRect(t){let r,s,a,o,d,f,_=1/0,u=-1/0,x=1/0,w=-1/0;if(this._update(!0),r=t?this.matrix:this.worldMatrix,s=(this.linewidth||0)/2,a=this._renderer.vertices.length,this.linewidth>0||this.stroke&&!/(transparent|none)/i.test(this.stroke))if(this.matrix.manual){let{scaleX:S,scaleY:T}=B(r.elements[0],r.elements[3],r.elements[1],r.elements[4],r.elements[2],r.elements[5]);typeof S=="number"&&typeof T=="number"&&(s=Math.max(S,T)*(this.linewidth||0)/2)}else s*=typeof this.scale=="number"?this.scale:Math.max(this.scale.x,this.scale.y);if(a<=0)return{width:0,height:0};for(o=0;o<a;o++){f=this._renderer.vertices[o],d=this._renderer.vertices[(o+a-1)%a];let[S,T]=r.multiply(d.x,d.y),[A,F]=r.multiply(f.x,f.y);if(d.controls&&f.controls){let z=d.controls.right.x,C=d.controls.right.y;d.relative&&(z+=d.x,C+=d.y);let[P,Y]=r.multiply(z,C),q=f.controls.left.x,D=f.controls.left.y;f.relative&&(q+=f.x,D+=f.y);let[X,$]=r.multiply(q,D),at=Wi(S,T,P,Y,X,$,A,F);x=Oe(at.min.y-s,x),_=Oe(at.min.x-s,_),u=ze(at.max.x+s,u),w=ze(at.max.y+s,w)}else o<=1&&(x=Oe(T-s,x),_=Oe(S-s,_),u=ze(S+s,u),w=ze(T+s,w)),x=Oe(F-s,x),_=Oe(A-s,_),u=ze(A+s,u),w=ze(F+s,w)}return{top:x,left:_,right:u,bottom:w,width:u-_,height:w-x}}getPointAt(t,r){let s,a,o,d,f,_,u,x,w,S,T,A,F,z,C,P=this.length*Math.min(Math.max(t,0),1),Y=this.vertices.length,q=Y-1,D=null,X=null;for(let Pt=0,ee=this._lengths.length,Ut=0;Pt<ee;Pt++){if(Ut+this._lengths[Pt]>=P){this._closed?(s=K(Pt,Y),a=K(Pt-1,Y),Pt===0&&(s=a,a=Pt)):(s=Pt,a=Math.min(Math.max(Pt-1,0),q)),D=this.vertices[s],X=this.vertices[a],P-=Ut,this._lengths[Pt]!==0?t=P/this._lengths[Pt]:t=0;break}Ut+=this._lengths[Pt]}if(D===null||X===null)return null;if(D){if(!X)return D}else return X;C=X.controls&&X.controls.right,z=D.controls&&D.controls.left,f=X.x,S=X.y,_=(C||X).x,T=(C||X).y,u=(z||D).x,A=(z||D).y,x=D.x,F=D.y,C&&X.relative&&(_+=X.x,T+=X.y),z&&D.relative&&(u+=D.x,A+=D.y),d=xe(t,f,_,u,x),w=xe(t,S,T,A,F);let $=W(f,_,t),at=W(S,T,t),rt=W(_,u,t),et=W(T,A,t),dt=W(u,x,t),ct=W(A,F,t),bt=W($,rt,t),mt=W(at,et,t),Nt=W(rt,dt,t),Ht=W(et,ct,t);return j.isObject(r)?(r.x=d,r.y=w,r instanceof Q&&(r.controls.left.x=bt,r.controls.left.y=mt,r.controls.right.x=Nt,r.controls.right.y=Ht,(typeof r.relative!="boolean"||r.relative)&&(r.controls.left.x-=d,r.controls.left.y-=w,r.controls.right.x-=d,r.controls.right.y-=w)),r.t=t,r):(o=new Q(d,w,bt-d,mt-w,Nt-d,Ht-w,this._curved?k.curve:k.line),o.t=t,o)}plot(){if(this.curved)return Ui(this._collection,this.closed),this;for(let t=0;t<this._collection.length;t++)this._collection[t].command=t===0?k.move:k.line;return this}subdivide(t){this._update();let r=this.vertices.length-1,s=this._closed||this.vertices[r]._command===k.close,a=this.vertices[r],o=[],d;return j.each(this.vertices,function(f,_){if(_<=0&&!s){a=f;return}if(f.command===k.move){o.push(new Q(a.x,a.y)),_>0&&(o[o.length-1].command=k.line),a=f;return}d=rr(f,a,t),o=o.concat(d),j.each(d,function(u,x){x<=0&&a.command===k.move?u.command=k.move:u.command=k.line}),_>=r&&(this._closed&&this._automatic?(a=f,d=rr(f,a,t),o=o.concat(d),j.each(d,function(u,x){x<=0&&a.command===k.move?u.command=k.move:u.command=k.line})):s&&o.push(new Q(f.x,f.y)),o[o.length-1].command=s?k.close:k.line),a=f},this),this._automatic=!1,this._curved=!1,this.vertices=o,this}_updateLength(t,r){r||this._update();let s=this.vertices.length,a=s-1,o=!1,d=this.vertices[a],f=0;return typeof this._lengths>"u"&&(this._lengths=[]),j.each(this.vertices,function(_,u){if(u<=0&&!o||_.command===k.move){d=_,this._lengths[u]=0;return}this._lengths[u]=Ti(_,d,t),f+=this._lengths[u],u>=a&&o&&(d=this.vertices[(u+1)%s],this._lengths[u+1]=Ti(_,d,t),f+=this._lengths[u+1]),d=_},this),this._length=f,this._flagLength=!1,this}_update(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);let t=this._collection.length,r=this._closed,s=Math.min(this._beginning,this._ending),a=Math.max(this._beginning,this._ending),o=si(this,s*this._length),d=si(this,a*this._length),f=As(o),_=ks(d),u,x,w,S,T,A;for(this._renderer.vertices.length=0,A=0;A<t;A++)this._renderer.collection.length<=A&&this._renderer.collection.push(new Q),A>_&&!x?(T=this._renderer.collection[A].copy(this._collection[A]),this.getPointAt(a,T),T.command=this._renderer.collection[A].command,this._renderer.vertices.push(T),x=T,w=this._collection[A-1],w&&w.controls&&(T.relative?T.controls.right.clear():T.controls.right.copy(T),w.relative?this._renderer.collection[A-1].controls.right.copy(w.controls.right).lerp(N.zero,1-T.t):this._renderer.collection[A-1].controls.right.copy(w.controls.right).lerp(w,1-T.t))):A>=f&&A<=_&&(T=this._renderer.collection[A].copy(this._collection[A]),this._renderer.vertices.push(T),A===_&&ir(this,a)?(x=T,!r&&x.controls&&(x.relative?x.controls.right.clear():x.controls.right.copy(x))):A===f&&ir(this,s)&&(u=T,u.command=k.move,!r&&u.controls&&(u.relative?u.controls.left.clear():u.controls.left.copy(u))));f>0&&!u&&(A=f-1,T=this._renderer.collection[A].copy(this._collection[A]),this.getPointAt(s,T),T.command=k.move,this._renderer.vertices.unshift(T),S=this._collection[A+1],S&&S.controls&&(T.controls.left.clear(),S.relative?this._renderer.collection[A+1].controls.left.copy(S.controls.left).lerp(N.zero,T.t):(Es.copy(S),this._renderer.collection[A+1].controls.left.copy(S.controls.left).lerp(S,T.t))))}return we.prototype._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,we.prototype.flagReset.call(this),this}},ut=Ye;g(ut,"Properties",["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"]),g(ut,"Utils",{getCurveLength:Ti});var dr={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},cap:{enumerable:!0,get:function(){return this._cap},set:function(i){this._cap=i,this._flagCap=!0}},join:{enumerable:!0,get:function(){return this._join},set:function(i){this._join=i,this._flagJoin=!0}},miter:{enumerable:!0,get:function(){return this._miter},set:function(i){this._miter=i,this._flagMiter=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.unbind(E.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.bind(E.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.unbind(E.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.bind(E.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},closed:{enumerable:!0,get:function(){return this._closed},set:function(i){this._closed=!!i,this._flagVertices=!0}},curved:{enumerable:!0,get:function(){return this._curved},set:function(i){this._curved=!!i,this._flagVertices=!0}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(i){if(i===this._automatic)return;this._automatic=!!i;let t=this._automatic?"ignore":"listen";j.each(this.vertices,function(r){r[t]()})}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._beginning=i,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._ending=i,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(i){let t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(E.Types.insert,t).unbind(E.Types.remove,r),i instanceof Ae?this._collection=i:this._collection=new Ae(i||[]),this._collection.bind(E.Types.insert,t).bind(E.Types.remove,r),t(this._collection)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,j.isObject(i)&&!i.clip&&(i.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(i){this._clip=i,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){typeof i.offset!="number"&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}};function fr(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)}function ur(i){let t=i.length;for(;t--;)i[t].bind(E.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function _r(i){let t=i.length;for(;t--;)i[t].unbind(E.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function pr(){this._flagFill=!0}function mr(){this._flagStroke=!0}var gr=class extends ut{constructor(t,r,s,a){let o=[new Q,new Q,new Q,new Q];super(o,!0,!1,!0);m(this,"_flagWidth",0);m(this,"_flagHeight",0);m(this,"_width",0);m(this,"_height",0);m(this,"_origin",null);for(let d in yr)Object.defineProperty(this,d,yr[d]);this.width=typeof s=="number"?s:1,this.height=typeof a=="number"?a:1,this.origin=new N,typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r),this._update()}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let t=this._width/2,r=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new Q),this.vertices[0].set(-t,-r).sub(this._origin).command=k.move,this.vertices[1].set(t,-r).sub(this._origin).command=k.line,this.vertices[2].set(t,r).sub(this._origin).command=k.line,this.vertices[3].set(-t,r).sub(this._origin).command=k.line,this.vertices[4]&&(this.vertices[4].set(-t,-r).sub(this._origin).command=k.line)}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(t){let r=new gr(0,0,this.width,this.height);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<ut.Properties.length;s++){let a=ut.Properties[s];r[a]=this[a]}return t&&t.add(r),r}toObject(){let t=super.toObject.call(this);return t.width=this.width,t.height=this.height,t.origin=this.origin.toObject(),t}},Pe=gr;g(Pe,"Properties",["width","height"]);var yr={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}},origin:{enumerable:!0,get:function(){return this._origin},set:function(i){this._origin&&this._origin.unbind(E.Types.change,this._renderer.flagVertices),this._origin=i,this._origin.bind(E.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}}},vr=class extends Pe{constructor(t,r,s,a,o,d){super(r,s,0,0);m(this,"_flagTexture",!1);m(this,"_flagColumns",!1);m(this,"_flagRows",!1);m(this,"_flagFrameRate",!1);m(this,"_flagIndex",!1);m(this,"_amount",1);m(this,"_duration",0);m(this,"_startTime",0);m(this,"_playing",!1);m(this,"_firstFrame",0);m(this,"_lastFrame",0);m(this,"_loop",!0);m(this,"_texture",null);m(this,"_columns",1);m(this,"_rows",1);m(this,"_frameRate",0);m(this,"_index",0);m(this,"_origin",null);for(let f in br)Object.defineProperty(this,f,br[f]);this.noStroke(),this.noFill(),t instanceof vt?this.texture=t:typeof t=="string"&&(this.texture=new vt(t)),this.origin=new N,this._update(),typeof a=="number"&&(this.columns=a),typeof o=="number"&&(this.rows=o),typeof d=="number"&&(this.frameRate=d),this.index=0}play(t,r,s){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=j.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof r=="number"&&(this._lastFrame=r),typeof s=="function"?this._onLastFrame=s:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=0,this}clone(t){let r=new vr(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(r.play(this._firstFrame,this._lastFrame),r._loop=this._loop),t&&t.add(r),r}toObject(){let t=super.toObject.call(this);return t.texture=this.texture.toObject(),t.columns=this.columns,t.rows=this.rows,t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t}_update(){let t=this._texture,r=this._columns,s=this._rows,a,o,d,f,_,u,x,w,S;if(t&&((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=t),t.loaded)){x=t.image.width,w=t.image.height,a=x/r,o=w/s,f=this._amount,this.width!==a&&(this.width=a),this.height!==o&&(this.height=o),this._playing&&this._frameRate>0&&(j.isNaN(this._lastFrame)&&(this._lastFrame=f-1),d=j.performance.now()-this._startTime,S=this._lastFrame+1,_=1e3*(S-this._firstFrame)/this._frameRate,this._loop?d=d%_:d=Math.min(d,_),u=W(this._firstFrame,S,d/_),u=Math.floor(u),u!==this._index&&(this._index=u,u>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));let T=this._index%r,A=Math.floor(this._index/r),F=-a*T+(x-a)/2,z=-o*A+(w-o)/2;F!==t.offset.x&&(t.offset.x=F),z!==t.offset.y&&(t.offset.y=z)}return super._update.call(this),this}flagReset(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,super.flagReset.call(this),this}},hi=vr;g(hi,"Properties",["texture","columns","rows","frameRate","index"]);var br={texture:{enumerable:!0,get:function(){return this._texture},set:function(i){this._texture=i,this._flagTexture=!0}},columns:{enumerable:!0,get:function(){return this._columns},set:function(i){this._columns=i,this._flagColumns=!0}},rows:{enumerable:!0,get:function(){return this._rows},set:function(i){this._rows=i,this._flagRows=!0}},frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(i){this._frameRate=i,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(i){this._index=i,this._flagIndex=!0}}},Ri=Math.cos,Mi=Math.sin,li=class extends ut{constructor(t,r,s,a){let o=a?Math.max(a,2):4,d=[];for(let f=0;f<o;f++)d.push(new Q(0,0,0,0,0,0));super(d,!0,!0,!0);m(this,"_flagRadius",!1);m(this,"_radius",0);for(let f in xr)Object.defineProperty(this,f,xr[f]);typeof s=="number"&&(this.radius=s),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagRadius){let t=this.vertices.length;!this._closed&&t>2&&(t-=1);let r=4/3*Math.tan(Math.PI/(t*2)),s=this._radius,a=s*r;for(let o=0;o<this.vertices.length;o++){let d=o/t*L,f=s*Ri(d),_=s*Mi(d),u=a*Ri(d-R),x=a*Mi(d-R),w=a*Ri(d+R),S=a*Mi(d+R),T=this.vertices[o];T.command=o===0?k.move:k.curve,T.set(f,_),T.controls.left.set(u,x),T.controls.right.set(w,S)}}return super._update.call(this),this}flagReset(){return this._flagRadius=!1,super.flagReset.call(this),this}clone(t){let r=new li(0,0,this.radius,this.vertices.length);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<ut.Properties.length;s++){let a=ut.Properties[s];r[a]=this[a]}return t&&t.add(r),r}toObject(){let t=super.toObject.call(this);for(let r=0;r<li.Properties.length;r++){let s=li.Properties[r];t[s]=this[s]}return t}},ci=li;g(ci,"Properties",["radius"]);var xr={radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius=i,this._flagRadius=!0}}},Li=Math.cos,Pi=Math.sin,di=class extends ut{constructor(t,r,s,a,o){typeof a!="number"&&typeof s=="number"&&(a=s);let d=o?Math.max(o,2):4,f=[];for(let _=0;_<d;_++)f.push(new Q);super(f,!0,!0,!0);m(this,"_flagWidth",!1);m(this,"_flagHeight",!1);m(this,"_width",0);m(this,"_height",0);for(let _ in wr)Object.defineProperty(this,_,wr[_]);typeof s=="number"&&(this.width=s*2),typeof a=="number"&&(this.height=a*2),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let t=this.vertices.length;!this._closed&&t>2&&(t-=1);let r=4/3*Math.tan(Math.PI/(this.vertices.length*2)),s=this._width/2,a=this._height/2;for(let o=0;o<this.vertices.length;o++){let d=o/t*L,f=s*Li(d),_=a*Pi(d),u=s*r*Li(d-R),x=a*r*Pi(d-R),w=s*r*Li(d+R),S=a*r*Pi(d+R),T=this.vertices[o];T.command=o===0?k.move:k.curve,T.set(f,_),T.controls.left.set(u,x),T.controls.right.set(w,S)}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(t){let r=this.width/2,s=this.height/2,a=this.vertices.length,o=new di(0,0,r,s,a);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let d=0;d<ut.Properties.length;d++){let f=ut.Properties[d];o[f]=this[f]}return t&&t.add(o),o}toObject(){let t=super.toObject.call(this);for(let r=0;r<di.Properties.length;r++){let s=di.Properties[r];t[s]=this[s]}return t}},fi=di;g(fi,"Properties",["width","height"]);var wr={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}}},Ci=class extends ut{constructor(i,t,r,s){let a=[new Q(i,t),new Q(r,s)];super(a);for(let o in Ar)Object.defineProperty(this,o,Ar[o]);this.vertices[0].command=k.move,this.vertices[1].command=k.line,this.automatic=!1}},Ar={left:{enumerable:!0,get:function(){return this.vertices[0]},set:function(i){if(j.isObject(i))this.vertices.splice(0,1,i);else{let t=new te("Two.Line.x argument is not an object.");console.warn(t.name,t.message)}}},right:{enumerable:!0,get:function(){return this.vertices[1]},set:function(i){if(j.isObject(i))this.vertices.splice(1,1,i);else{let t=new te("Two.Line.y argument is not an object.");console.warn(t.name,t.message)}}}},ui=class extends ut{constructor(t,r,s,a,o){typeof o>"u"&&typeof s=="number"&&typeof a=="number"&&(o=Math.floor(Math.min(s,a)/12));let d=[];for(let f=0;f<10;f++)d.push(new Q(0,0,0,0,0,0,f===0?k.move:k.curve));super(d);m(this,"_flagWidth",!1);m(this,"_flagHeight",!1);m(this,"_flagRadius",!1);m(this,"_width",0);m(this,"_height",0);m(this,"_radius",12);for(let f in kr)Object.defineProperty(this,f,kr[f]);this.closed=!0,this.automatic=!1,this._renderer.flagRadius=Ss.bind(this),typeof s=="number"&&(this.width=s),typeof a=="number"&&(this.height=a),typeof o=="number"&&(this.radius=o),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){let t=this._width,r=this._height,s,a;this._radius instanceof N?(s=this._radius.x,a=this._radius.y):(s=this._radius,a=this._radius);let o,d=t/2,f=r/2;o=this.vertices[0],o.x=-(d-s),o.y=-f,o=this.vertices[1],o.x=d-s,o.y=-f,o.controls.left.clear(),o.controls.right.x=s,o.controls.right.y=0,o=this.vertices[2],o.x=d,o.y=-(f-a),o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[3],o.x=d,o.y=f-a,o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=a,o=this.vertices[4],o.x=d-s,o.y=f,o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[5],o.x=-(d-s),o.y=f,o.controls.left.clear(),o.controls.right.x=-s,o.controls.right.y=0,o=this.vertices[6],o.x=-d,o.y=f-a,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[7],o.x=-d,o.y=-(f-a),o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=-a,o=this.vertices[8],o.x=-(d-s),o.y=-f,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[9],o.copy(this.vertices[8])}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,super.flagReset.call(this),this}clone(t){let r=this.width,s=this.height,a=this.radius,o=new ui(0,0,r,s,a);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let d=0;d<ut.Properties.length;d++){let f=ut.Properties[d];o[f]=this[f]}return t&&t.add(o),o}toObject(){let t=super.toObject.call(this);for(let r=0;r<ui.Properties.length;r++){let s=ui.Properties[r];t[s]=this[s]}return t.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),t}},_i=ui;g(_i,"Properties",["width","height","radius"]);var kr={width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0}},radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius instanceof N&&this._radius.unbind(E.Types.change,this._renderer.flagRadius),this._radius=i,this._radius instanceof N&&this._radius.bind(E.Types.change,this._renderer.flagRadius),this._flagRadius=!0}}};function Ss(){this._flagRadius=!0}var Fi,Er=Math.min,Sr=Math.max;O.document&&(Fi=document.createElement("canvas"));var ge=class extends we{constructor(t,r,s,a){super();m(this,"_flagValue",!0);m(this,"_flagFamily",!0);m(this,"_flagSize",!0);m(this,"_flagLeading",!0);m(this,"_flagAlignment",!0);m(this,"_flagBaseline",!0);m(this,"_flagStyle",!0);m(this,"_flagWeight",!0);m(this,"_flagDecoration",!0);m(this,"_flagFill",!0);m(this,"_flagStroke",!0);m(this,"_flagLinewidth",!0);m(this,"_flagOpacity",!0);m(this,"_flagVisible",!0);m(this,"_flagMask",!1);m(this,"_flagClip",!1);m(this,"_value","");m(this,"_family","sans-serif");m(this,"_size",13);m(this,"_leading",17);m(this,"_alignment","center");m(this,"_baseline","middle");m(this,"_style","normal");m(this,"_weight",500);m(this,"_decoration","none");m(this,"_direction","ltr");m(this,"_fill","#000");m(this,"_stroke","none");m(this,"_linewidth",1);m(this,"_opacity",1);m(this,"_visible",!0);m(this,"_mask",null);m(this,"_clip",!1);m(this,"_dashes",null);for(let o in Tr)Object.defineProperty(this,o,Tr[o]);if(this._renderer.type="text",this._renderer.flagFill=Ts.bind(this),this._renderer.flagStroke=Rs.bind(this),this.value=t,typeof r=="number"&&(this.translation.x=r),typeof s=="number"&&(this.translation.y=s),this.dashes=[],this.dashes.offset=0,!j.isObject(a))return this;for(let o=0;o<ge.Properties.length;o++){let d=ge.Properties[o];d in a&&(this[d]=a[d])}}static Measure(t){if(Fi){let r=Fi.getContext("2d");r.font=[t._style,t._weight,"".concat(t._size,"px/").concat(t._leading,"px"),t._family].join(" ");let s=r.measureText(t.value,0,0),a=s.actualBoundingBoxDescent+s.actualBoundingBoxAscent;return{width:s.width,height:a}}else{let r=this.value.length*this.size*ge.Ratio,s=this.leading;return console.warn("Two.Text: unable to accurately measure text, so using an approximation."),{width:r,height:s}}}clone(t){let r=new ge(this.value);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale;for(let s=0;s<ge.Properties.length;s++){let a=ge.Properties[s];r[a]=this[a]}return this.matrix.manual&&r.matrix.copy(this.matrix),t&&t.add(r),r._update()}toObject(){let t={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};this.matrix.manual&&(t.matrix=this.matrix.toObject());for(let r=0;r<ge.Properties.length;r++){let s=ge.Properties[r];t[s]=this[s]}return t}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this.linewidth=0,this}getBoundingClientRect(t){let r,s,a,o,d;this._update(!0),r=t?this.matrix:this.worldMatrix;let{width:f,height:_}=ge.Measure(this),u=(this._linewidth||0)/2;switch(this.alignment){case"left":s=-u,a=f+u;break;case"right":s=-(f+u),a=u;break;default:s=-(f/2+u),a=f/2+u}switch(this.baseline){case"middle":o=-(_/2+u),d=_/2+u;break;default:o=-(_+u),d=u}let[x,w]=r.multiply(s,o),[S,T]=r.multiply(s,d),[A,F]=r.multiply(a,o),[z,C]=r.multiply(a,d);return o=Er(w,T,F,C),s=Er(x,S,A,z),a=Sr(x,S,A,z),d=Sr(w,T,F,C),{top:o,left:s,right:a,bottom:d,width:a-s,height:d-o}}flagReset(){return super.flagReset.call(this),this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=!1,this}},ue=ge;g(ue,"Ratio",.6),g(ue,"Properties",["value","family","size","leading","alignment","linewidth","style","weight","decoration","direction","baseline","opacity","visible","fill","stroke"]);var Tr={value:{enumerable:!0,get:function(){return this._value},set:function(i){this._value=i,this._flagValue=!0}},family:{enumerable:!0,get:function(){return this._family},set:function(i){this._family=i,this._flagFamily=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(i){this._size=i,this._flagSize=!0}},leading:{enumerable:!0,get:function(){return this._leading},set:function(i){this._leading=i,this._flagLeading=!0}},alignment:{enumerable:!0,get:function(){return this._alignment},set:function(i){this._alignment=i,this._flagAlignment=!0}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},style:{enumerable:!0,get:function(){return this._style},set:function(i){this._style=i,this._flagStyle=!0}},weight:{enumerable:!0,get:function(){return this._weight},set:function(i){this._weight=i,this._flagWeight=!0}},decoration:{enumerable:!0,get:function(){return this._decoration},set:function(i){this._decoration=i,this._flagDecoration=!0}},direction:{enumerable:!0,get:function(){return this._direction},set:function(i){this._direction=i,this._flagDirection=!0}},baseline:{enumerable:!0,get:function(){return this._baseline},set:function(i){this._baseline=i,this._flagBaseline=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.unbind(E.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.bind(E.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.unbind(E.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.bind(E.Types.change,this._renderer.flagStroke)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask=i,this._flagMask=!0,j.isObject(i)&&!i.clip&&(i.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(i){this._clip=i,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){typeof i.offset!="number"&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}};function Ts(){this._flagFill=!0}function Rs(){this._flagStroke=!0}var ye={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},Ms={start:"left",middle:"center",end:"right"},Rr=["id","class","transform","xmlns","viewBox"],Ls=["x","y","width","height","href","xlink:href"];function Ps(i){return Ms[i]}function Cs(i){let t=i.getAttribute("dominant-baseline"),r=i.getAttribute("alignment-baseline");return t||r}function De(i){return i.replace(/svg:/ig,"").toLowerCase()}function Mr(i,t){if(t.x+=i.translateX,t.y+=i.translateY,t.x*=i.scaleX,t.y*=i.scaleY,i.rotation!==0){let r=t.length();t.x=r*Math.cos(i.rotation),t.y=r*Math.sin(i.rotation)}}function Fs(i,t){t||(t={});let r=i.split(";");for(let s=0;s<r.length;s++){let a=r[s].split(":"),o=a[0],d=a[1];typeof o>"u"||typeof d>"u"||(t[o]=d.replace(/\s/,""))}return t}function Is(i){let t={},r=Os(i),s=Math.max(r.length,i.style.length);for(let a=0;a<s;a++){let o=i.style[a],d=r[a];o&&(t[o]=i.style[o]),d&&(t[d]=i.getAttribute(d))}return t}function Os(i){let t=i.getAttributeNames();for(let r=0;r<Rr.length;r++){let s=Rr[r],a=Array.prototype.indexOf.call(t,s);a>=0&&t.splice(a,1)}return t}function zs(i,t){let r=t.split(/[\s,]/),s=-parseFloat(r[0]),a=-parseFloat(r[1]),o=parseFloat(r[2]),d=parseFloat(r[3]);if(s&&a)for(let w=0;w<i.children.length;w++){let S=i.children[w];"translation"in S?S.translation.add(s,a):"x"in S?S.x=s:"y"in S&&(S.y=a)}let f=typeof i.x=="number",_=typeof i.y=="number",u=typeof i.width=="number",x=typeof i.height=="number";return f&&(i.translation.x+=i.x),_&&(i.translation.y+=i.y),(u||x)&&(i.scale=new N(1,1)),u&&(i.scale.x=i.width/o),x&&(i.scale.y=i.height/d),i.mask=new Pe(0,0,o,d),i.mask.origin.set(-o/2,-d/2),i}function he(i,t,r){let s={},a={},o={},d,f,_,u,x,w,S,T,A,F,z,C,P,Y,q,D,X;if(i===null)return s;if(O.getComputedStyle){let $=O.getComputedStyle(i);for(d=$.length;d--;)_=$[d],u=$[_],typeof u<"u"&&(s[_]=u)}for(d=0;d<i.attributes.length;d++)w=i.attributes[d],/style/i.test(w.nodeName)?Fs(w.value,o):a[w.nodeName]=w.value;typeof s.opacity<"u"&&(s["stroke-opacity"]=s.opacity,s["fill-opacity"]=s.opacity,delete s.opacity),r&&j.defaults(s,r),j.extend(s,o,a),s.visible=!(typeof s.display>"u"&&/none/i.test(s.display))||typeof s.visibility>"u"&&/hidden/i.test(s.visibility);for(_ in s)switch(u=s[_],_){case"gradientTransform":if(/none/i.test(u)||(f=i.gradientTransform&&i.gradientTransform.baseVal&&i.gradientTransform.baseVal.length>0?i.gradientTransform.baseVal[0].matrix:i.getCTM?i.getCTM():null,f===null))break;switch(S=B(f),t._renderer.type){case"linear-gradient":Mr(S,t.left),Mr(S,t.right);break;case"radial-gradient":t.center.x+=S.translateX,t.center.y+=S.translateY,t.focal.x+=S.translateX,t.focal.y+=S.translateY,t.radius*=Math.max(S.scaleX,S.scaleY);break}break;case"transform":if(/none/i.test(u)||(f=i.transform&&i.transform.baseVal&&i.transform.baseVal.length>0?i.transform.baseVal[0].matrix:i.getCTM?i.getCTM():null,f===null))break;xt.AutoCalculateImportedMatrices?(S=B(f),t.translation.set(S.translateX,S.translateY),t.rotation=Math.PI*(S.rotation/180),t.scale=new N(S.scaleX,S.scaleY),T=parseFloat((s.x+"").replace("px")),A=parseFloat((s.y+"").replace("px")),T&&(t.translation.x=T),A&&(t.translation.y=A)):(f=i.getCTM(),t._matrix.manual=!0,t._matrix.set(f.a,f.b,f.c,f.d,f.e,f.f));break;case"visible":if(t instanceof Ot){t._visible=u;break}t.visible=u;break;case"stroke-linecap":if(t instanceof Ot){t._cap=u;break}t.cap=u;break;case"stroke-linejoin":if(t instanceof Ot){t._join=u;break}t.join=u;break;case"stroke-miterlimit":if(t instanceof Ot){t._miter=u;break}t.miter=u;break;case"stroke-width":if(t instanceof Ot){t._linewidth=parseFloat(u);break}t.linewidth=parseFloat(u);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(t instanceof Ot){t._opacity=parseFloat(u);break}t.opacity=parseFloat(u);break;case"clip-path":if(ye.cssBackgroundImage.test(u)&&(F=u.replace(ye.cssBackgroundImage,"$1"),Mt.defs.current&&Mt.defs.current.contains(F)&&(C=Mt.defs.current.get(F),C&&C.childNodes.length>0)))switch(C=C.childNodes[0],P=De(C.nodeName),t.mask=Mt[P].call(this,C,{}),t._renderer.type){case"text":case"path":t.position.add(t.mask.position),t.mask.position.clear();break}break;case"fill":case"stroke":x=(t instanceof Ot?"_":"")+_,ye.cssBackgroundImage.test(u)?(F=u.replace(ye.cssBackgroundImage,"$1"),Mt.defs.current&&Mt.defs.current.contains(F)?(C=Mt.defs.current.get(F),C.object||(P=De(C.nodeName),C.object=Mt[P].call(this,C,{})),C=C.object):(z=Bs(this),C=z.getById(F)),t[x]=C):t[x]=u;break;case"id":t.id=u;break;case"class":case"className":t.classList=u.split(" "),t._flagClassName=!0;break;case"x":case"y":if(Y=t instanceof zt,q=t instanceof Tt,D=t instanceof Rt,Y||q||D)break;u.match("[a-z%]$")&&!u.endsWith("px")&&(X=new te("only pixel values are supported with the "+_+" attribute."),console.warn(X.name,X.message)),t.translation[_]=parseFloat(u);break;case"font-family":t instanceof ue&&(t.family=u);break;case"font-size":t instanceof ue&&(t.size=u);break;case"font-weight":t instanceof ue&&(t.weight=u);break;case"font-style":t instanceof ue&&(t.style=u);break;case"text-decoration":t instanceof ue&&(t.decoration=u);break;case"line-height":t instanceof ue&&(t.leading=u);break}return Object.keys(i.dataset).length&&(t.dataset=i.dataset),s}function Ns(i,t){for(let r=0,s=i.childNodes.length;r<s;r++){let a=i.childNodes[r];!a.id||De(i.nodeName)==="#text"||t.add(a.id,a)}}function Bs(i){for(;i.parent;)i=i.parent;return i.scene}var Mt={svg:function(i){let t=Mt.defs.current=new ri,r=i.getElementsByTagName("defs");for(let A=0;A<r.length;A++)Ns(r[A],t);let s=Mt.g.call(this,i),a=i.getAttribute("viewBox"),o=i.getAttribute("x"),d=i.getAttribute("y"),f=i.getAttribute("width"),_=i.getAttribute("height");s.defs=t;let u=a!==null,x=o!==null,w=d!==null,S=f!==null,T=_!==null;return x&&(s.x=parseFloat(o.replace(ye.unitSuffix,""))),w&&(s.y=parseFloat(d.replace(ye.unitSuffix,""))),S&&(s.width=parseFloat(f.replace(ye.unitSuffix,""))),T&&(s.height=parseFloat(_.replace(ye.unitSuffix,""))),u&&zs(s,a),delete Mt.defs.current,s},defs:function(i){return null},use:function(i,t){let r,s=i.getAttribute("href")||i.getAttribute("xlink:href");if(!s)return r=new te("encountered <use /> with no href."),console.warn(r.name,r.message),null;let a=s.slice(1);if(!Mt.defs.current.contains(a))return r=new te("unable to find element for reference "+s+"."),console.warn(r.name,r.message),null;let o=Mt.defs.current.get(a).cloneNode(!0);for(let f=0;f<i.attributes.length;f++){let _=i.attributes[f],u=Ls.includes(_.nodeName),x=!o.hasAttribute(_.nodeName);(u||x)&&o.setAttribute(_.nodeName,_.value)}let d=De(o.nodeName);return Mt[d].call(this,o,t)},g:function(i,t){let r=new Ot;he.call(this,i,r,t),this.add(r);let s=Is.call(this,i);for(let a=0,o=i.childNodes.length;a<o;a++){let d=i.childNodes[a],f=d.nodeName;if(!f)return;let _=De(f);if(_ in Mt){let u=Mt[_].call(r,d,s);u&&!u.parent&&r.add(u)}}return r},polygon:function(i,t){let r;typeof i=="string"?r=i:r=i.getAttribute("points");let s=[];r.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(o,d,f){s.push(new Q(parseFloat(d),parseFloat(f)))});let a=new ut(s,!0).noStroke();return a.fill="black",he.call(this,i,a,t),a},polyline:function(i,t){let r=Mt.polygon.call(this,i,t);return r.closed=!1,r},path:function(i,t){let r;typeof i=="string"?(r=i,i=null):r=i.getAttribute("d");let s=[],a=!1,o=!1;if(r){let f=new Q,_,u,x=r.match(/[a-df-z][^a-df-z]*/ig),w=x.length-1;j.each(x.slice(0),function(S,T){let A=S.slice(1).trim().match(ye.path),F=S[0],z=F.toLowerCase(),C,P,Y,q,D,X=[];switch(T===0&&(x=[]),z){case"h":case"v":A.length>1&&(C=1);break;case"m":case"l":case"t":A.length>2&&(C=2);break;case"s":case"q":A.length>4&&(C=4);break;case"c":A.length>6&&(C=6);break;case"a":A.length>7&&(C=7);break}if(C){for(P=0,Y=A.length,D=0;P<Y;P+=C){if(q=F,D>0)switch(F){case"m":q="l";break;case"M":q="L";break}X.push(q+A.slice(P,P+C).join(" ")),D++}x=Array.prototype.concat.apply(x,X)}else x.push(S)}),j.each(x,function(S,T){let A,F,z,C=S[0],P=C.toLowerCase();u=S.slice(1).trim().match(ye.path),o=C===P;let Y,q,D,X,$,at,rt,et,dt,ct,bt,mt,Nt,Ht,Pt,ee,Ut;switch(P){case"z":if(T>=w)a=!0;else{F=f.x,z=f.y,A=new Q(F,z,void 0,void 0,void 0,void 0,k.close);for(let be=s.length-1;be>=0;be--){let Te=s[be];if(/m/i.test(Te.command)){f=Te;break}}}break;case"m":case"l":_=void 0,F=parseFloat(u[0]),z=parseFloat(u[1]),A=new Q(F,z,void 0,void 0,void 0,void 0,/m/i.test(P)?k.move:k.line),o&&A.addSelf(f),f=A;break;case"h":case"v":ct=/h/i.test(P)?"x":"y",bt=/x/i.test(ct)?"y":"x",A=new Q(void 0,void 0,void 0,void 0,void 0,void 0,k.line),A[ct]=parseFloat(u[0]),A[bt]=f[bt],o&&(A[ct]+=f[ct]),f=A;break;case"c":case"s":Y=f.x,q=f.y,_||(_=new N),/c/i.test(P)?(D=parseFloat(u[0]),X=parseFloat(u[1]),$=parseFloat(u[2]),at=parseFloat(u[3]),rt=parseFloat(u[4]),et=parseFloat(u[5])):(dt=wi(f,_,o),D=dt.x,X=dt.y,$=parseFloat(u[0]),at=parseFloat(u[1]),rt=parseFloat(u[2]),et=parseFloat(u[3])),o&&(D+=Y,X+=q,$+=Y,at+=q,rt+=Y,et+=q),f.controls.right.set(D-f.x,X-f.y),A=new Q(rt,et,$-rt,at-et,void 0,void 0,k.curve),f=A,_=A.controls.left;break;case"t":case"q":Y=f.x,q=f.y,_||(_=new N),/q/i.test(P)?(D=parseFloat(u[0]),X=parseFloat(u[1]),$=parseFloat(u[0]),at=parseFloat(u[1]),rt=parseFloat(u[2]),et=parseFloat(u[3])):(dt=wi(f,_,o),D=dt.x,X=dt.y,$=dt.x,at=dt.y,rt=parseFloat(u[0]),et=parseFloat(u[1])),o&&(D+=Y,X+=q,$+=Y,at+=q,rt+=Y,et+=q),f.controls.right.set((D-f.x)*.33,(X-f.y)*.33),A=new Q(rt,et,$-rt,at-et,void 0,void 0,k.curve),f=A,_=A.controls.left;break;case"a":Y=f.x,q=f.y,Nt=parseFloat(u[0]),Ht=parseFloat(u[1]),Pt=parseFloat(u[2]),ee=parseFloat(u[3]),Ut=parseFloat(u[4]),rt=parseFloat(u[5]),et=parseFloat(u[6]),o&&(rt+=Y,et+=q),mt=new Q(rt,et),mt.command=k.arc,mt.rx=Nt,mt.ry=Ht,mt.xAxisRotation=Pt,mt.largeArcFlag=ee,mt.sweepFlag=Ut,A=mt,f=mt,_=void 0;break}A&&(Array.isArray(A)?s=s.concat(A):s.push(A))})}r=new ut(s,a,void 0,!0).noStroke(),r.fill="black";let d=r.getBoundingClientRect(!0);return d.centroid={x:d.left+d.width/2,y:d.top+d.height/2},j.each(r.vertices,function(f){f.subSelf(d.centroid)}),he.call(this,i,r,t),r.translation.addSelf(d.centroid),r},circle:function(i,t){let r=parseFloat(i.getAttribute("cx")),s=parseFloat(i.getAttribute("cy")),a=parseFloat(i.getAttribute("r")),o=new ci(0,0,a).noStroke();return o.fill="black",he.call(this,i,o,t),o.translation.x=r,o.translation.y=s,o},ellipse:function(i,t){let r=parseFloat(i.getAttribute("cx")),s=parseFloat(i.getAttribute("cy")),a=parseFloat(i.getAttribute("rx")),o=parseFloat(i.getAttribute("ry")),d=new fi(0,0,a,o).noStroke();return d.fill="black",he.call(this,i,d,t),d.translation.x=r,d.translation.y=s,d},rect:function(i,t){let r=parseFloat(i.getAttribute("rx")),s=parseFloat(i.getAttribute("ry"));if(!j.isNaN(r)||!j.isNaN(s))return Mt["rounded-rect"](i);let a=parseFloat(i.getAttribute("width")),o=parseFloat(i.getAttribute("height")),d=a/2,f=o/2,_=new Pe(0,0,a,o).noStroke();return _.fill="black",he.call(this,i,_,t),_.translation.x+=d,_.translation.y+=f,_},"rounded-rect":function(i,t){let r=parseFloat(i.getAttribute("rx"))||0,s=parseFloat(i.getAttribute("ry"))||0,a=parseFloat(i.getAttribute("width")),o=parseFloat(i.getAttribute("height")),d=a/2,f=o/2,_=new N(r,s),u=new _i(0,0,a,o,_).noStroke();return u.fill="black",he.call(this,i,u,t),u.translation.x+=d,u.translation.y+=f,u},line:function(i,t){let r=parseFloat(i.getAttribute("x1")),s=parseFloat(i.getAttribute("y1")),a=parseFloat(i.getAttribute("x2")),o=parseFloat(i.getAttribute("y2")),d=new Ci(r,s,a,o).noFill();return he.call(this,i,d,t),d},lineargradient:function(i,t){let r=i.getAttribute("gradientUnits"),s=i.getAttribute("spreadMethod");r||(r="objectBoundingBox"),s||(s="pad");let a=parseFloat(i.getAttribute("x1")||0),o=parseFloat(i.getAttribute("y1")||0),d=parseFloat(i.getAttribute("x2")||0),f=parseFloat(i.getAttribute("y2")||0),_=(d+a)/2,u=(f+o)/2;/userSpaceOnUse/i.test(r)&&(a-=_,o-=u,d-=_,f-=u);let x=[];for(let S=0;S<i.children.length;S++){let T=i.children[S],A=T.getAttribute("offset");/%/ig.test(A)&&(A=parseFloat(A.replace(/%/ig,""))/100),A=parseFloat(A);let F=T.getAttribute("stop-color"),z=T.getAttribute("stop-opacity"),C=T.getAttribute("style"),P;F===null&&(P=C?C.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,F=P&&P.length>1?P[1]:void 0),z===null?(P=C?C.match(/stop-opacity:\s?([0-9.-]*)/):!1,z=P&&P.length>1?parseFloat(P[1]):1):z=parseFloat(z),x.push(new Ee(A,F,z))}let w=new Tt(a,o,d,f,x);return w.spread=s,w.units=r,he.call(this,i,w,t),w},radialgradient:function(i,t){let r=i.getAttribute("gradientUnits"),s=i.getAttribute("spreadMethod");r||(r="objectBoundingBox"),s||(s="pad");let a=parseFloat(i.getAttribute("cx"))||0,o=parseFloat(i.getAttribute("cy"))||0,d=parseFloat(i.getAttribute("r")),f=parseFloat(i.getAttribute("fx")),_=parseFloat(i.getAttribute("fy"));j.isNaN(f)&&(f=a),j.isNaN(_)&&(_=o);let u=Math.abs(a+f)/2,x=Math.abs(o+_)/2;/userSpaceOnUse/i.test(r)&&(a-=u,o-=x,f-=u,_-=x);let w=[];for(let T=0;T<i.children.length;T++){let A=i.children[T],F=A.getAttribute("offset");/%/ig.test(F)&&(F=parseFloat(F.replace(/%/ig,""))/100),F=parseFloat(F);let z=A.getAttribute("stop-color"),C=A.getAttribute("stop-opacity"),P=A.getAttribute("style"),Y;z===null&&(Y=P?P.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,z=Y&&Y.length>1?Y[1]:void 0),C===null?(Y=P?P.match(/stop-opacity:\s?([0-9.-]*)/):!1,C=Y&&Y.length>1?parseFloat(Y[1]):1):C=parseFloat(C),w.push(new Ee(F,z,C))}let S=new Rt(a,o,d,w,f,_);return S.spread=s,S.units=r,he.call(this,i,S,t),S},text:function(i,t){let r=Ps(i.getAttribute("text-anchor"))||"left",s=Cs(i)||"baseline",a=i.textContent,o=new ue(a);return he.call(this,i,o,t),o.alignment=r,o.baseline=s,o},clippath:function(i,t){return Mt.defs.current&&!Mt.defs.current.contains(i.id)&&Mt.defs.current.add(i.id,i),null},image:function(i,t){let r,s=i.getAttribute("href")||i.getAttribute("xlink:href");if(!s)return r=new te("encountered <image /> with no href."),console.warn(r.name,r.message),null;let a=parseFloat(i.getAttribute("x"))||0,o=parseFloat(i.getAttribute("y"))||0,d=parseFloat(i.getAttribute("width")),f=parseFloat(i.getAttribute("height")),_=new hi(s,a,o);return j.isNaN(d)||(_.width=d),j.isNaN(f)||(_.height=f),he.call(this,i,_,t),_}};function Lr(i,t){let r=new XMLHttpRequest;return r.open("GET",i),r.onreadystatechange=function(){r.readyState===4&&r.status===200&&t(r.responseText)},r.send(),r}var Ii=class extends Pe{constructor(t,r,s,a){super(r,s,0,0);m(this,"_flagTextures",!1);m(this,"_flagFrameRate",!1);m(this,"_flagIndex",!1);m(this,"_amount",1);m(this,"_duration",0);m(this,"_index",0);m(this,"_startTime",0);m(this,"_playing",!1);m(this,"_firstFrame",0);m(this,"_lastFrame",0);m(this,"_loop",!0);m(this,"_textures",null);m(this,"_frameRate",0);m(this,"_origin",null);for(let o in Pr)Object.defineProperty(this,o,Pr[o]);this._renderer.flagTextures=Ys.bind(this),this._renderer.bindTextures=Ds.bind(this),this._renderer.unbindTextures=Vs.bind(this),this.noStroke(),this.noFill(),Array.isArray(t)?this.textures=t.map(Cr.bind(this)):this.textures=[Cr(t)],this.origin=new N,this._update(),typeof a=="number"?this.frameRate=a:this.frameRate=Ii.DefaultFrameRate,this.index=0}play(t,r,s){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=j.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof r=="number"&&(this._lastFrame=r),typeof s=="function"?this._onLastFrame=s:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=this._firstFrame,this}clone(t){let r=new Ii(this.textures,this.translation.x,this.translation.y,this.frameRate);return r._loop=this._loop,this._playing&&r.play(),t&&t.add(r),r}toObject(){let t=super.toObject.call(this);return t.textures=this.textures.map(function(r){return r.toObject()}),t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t}_update(){let t=this._textures,r,s,a,o,d,f,_,u;return t&&(this._flagTextures&&(this._amount=t.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(o=this._amount,j.isNaN(this._lastFrame)&&(this._lastFrame=o-1),a=j.performance.now()-this._startTime,u=this._lastFrame+1,d=1e3*(u-this._firstFrame)/this._frameRate,this._loop?a=a%d:a=Math.min(a,d),_=W(this._firstFrame,u,a/d),_=Math.floor(_),_!==this._index&&(this._index=_,f=t[this._index],f.loaded&&(r=f.image.width,s=f.image.height,this.width!==r&&(this.width=r),this.height!==s&&(this.height=s),this.fill=f,_>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof vt))&&(f=t[this._index],f.loaded&&(r=f.image.width,s=f.image.height,this.width!==r&&(this.width=r),this.height!==s&&(this.height=s)),this.fill=f)),super._update.call(this),this}flagReset(){return this._flagTextures=this._flagFrameRate=!1,super.flagReset.call(this),this}},pi=Ii;g(pi,"Properties",["textures","frameRate","index"]),g(pi,"DefaultFrameRate",30);var Pr={frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(i){this._frameRate=i,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(i){this._index=i,this._flagIndex=!0}},textures:{enumerable:!0,get:function(){return this._textures},set:function(i){let t=this._renderer.bindTextures,r=this._renderer.unbindTextures;this._textures&&this._textures.unbind(E.Types.insert,t).unbind(E.Types.remove,r),this._textures=new Ae((i||[]).slice(0)),this._textures.bind(E.Types.insert,t).bind(E.Types.remove,r),t(this._textures)}}};function Ys(){this._flagTextures=!0}function Ds(i){let t=i.length;for(;t--;)i[t].bind(E.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function Vs(i){let t=i.length;for(;t--;)i[t].unbind(E.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function Cr(i){if(i instanceof vt)return i;if(typeof i=="string")return new vt(i)}var mi=class extends ut{constructor(t,r,s,a,o,d,f){let _=f||xt.Resolution*3,u=[];for(let x=0;x<_;x++)u.push(new Q);super(u,!0,!1,!0);m(this,"_flagStartAngle",!1);m(this,"_flagEndAngle",!1);m(this,"_flagInnerRadius",!1);m(this,"_flagOuterRadius",!1);m(this,"_startAngle",0);m(this,"_endAngle",L);m(this,"_innerRadius",0);m(this,"_outerRadius",0);for(let x in Fr)Object.defineProperty(this,x,Fr[x]);typeof s=="number"&&(this.innerRadius=s),typeof a=="number"&&(this.outerRadius=a),typeof o=="number"&&(this.startAngle=o),typeof d=="number"&&(this.endAngle=d),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){let t=this._startAngle,r=this._endAngle,s=this._innerRadius,a=this._outerRadius,o=K(t,L)===K(r,L),d=s>0,f=this.vertices,_=d?f.length/2:f.length,u,x=0,w,S,T,A,F,z,C,P,Y;for(o?_--:d||(_-=2),w=0,S=_-1;w<_;w++){switch(T=w/S,A=f[x],F=T*(r-t)+t,z=(r-t)/_,C=a*Math.cos(F),P=a*Math.sin(F),w){case 0:u=k.move;break;default:u=k.curve}A.command=u,A.x=C,A.y=P,A.controls.left.clear(),A.controls.right.clear(),A.command===k.curve&&(Y=a*z/Math.PI,A.controls.left.x=Y*Math.cos(F-R),A.controls.left.y=Y*Math.sin(F-R),A.controls.right.x=Y*Math.cos(F+R),A.controls.right.y=Y*Math.sin(F+R),w===1&&A.controls.left.multiplyScalar(2),w===S&&A.controls.right.multiplyScalar(2)),x++}if(d){for(o?(f[x].command=k.close,x++):(_--,S=_-1),w=0;w<_;w++)T=w/S,A=f[x],F=(1-T)*(r-t)+t,z=(r-t)/_,C=s*Math.cos(F),P=s*Math.sin(F),u=k.curve,w<=0&&(u=o?k.move:k.line),A.command=u,A.x=C,A.y=P,A.controls.left.clear(),A.controls.right.clear(),A.command===k.curve&&(Y=s*z/Math.PI,A.controls.left.x=Y*Math.cos(F+R),A.controls.left.y=Y*Math.sin(F+R),A.controls.right.x=Y*Math.cos(F-R),A.controls.right.y=Y*Math.sin(F-R),w===1&&A.controls.left.multiplyScalar(2),w===S&&A.controls.right.multiplyScalar(2)),x++;f[x].copy(f[0]),f[x].command=k.line}else o||(f[x].command=k.line,f[x].x=0,f[x].y=0,x++,f[x].copy(f[0]),f[x].command=k.line)}return super._update.call(this),this}flagReset(){return super.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this}clone(t){let r=this.innerRadius,s=this.outerRadius,a=this.startAngle,o=this.endAngle,d=this.vertices.length,f=new mi(0,0,r,s,a,o,d);f.translation.copy(this.translation),f.rotation=this.rotation,f.scale=this.scale,f.skewX=this.skewX,f.skewY=this.skewY,this.matrix.manual&&f.matrix.copy(this.matrix);for(let _=0;_<ut.Properties.length;_++){let u=ut.Properties[_];f[u]=this[u]}return t&&t.add(f),f}toObject(){let t=super.toObject.call(this);for(let r=0;r<mi.Properties.length;r++){let s=mi.Properties[r];t[s]=this[s]}return t}},Oi=mi;g(Oi,"Properties",["startAngle","endAngle","innerRadius","outerRadius"]);var Fr={startAngle:{enumerable:!0,get:function(){return this._startAngle},set:function(i){this._startAngle=i,this._flagStartAngle=!0}},endAngle:{enumerable:!0,get:function(){return this._endAngle},set:function(i){this._endAngle=i,this._flagEndAngle=!0}},innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(i){this._innerRadius=i,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(i){this._outerRadius=i,this._flagOuterRadius=!0}}},Ws=Math.ceil,qs=Math.floor,Ve=class extends we{constructor(t){super();m(this,"_flagVertices",!0);m(this,"_flagLength",!0);m(this,"_flagFill",!0);m(this,"_flagStroke",!0);m(this,"_flagLinewidth",!0);m(this,"_flagOpacity",!0);m(this,"_flagVisible",!0);m(this,"_flagSize",!0);m(this,"_flagSizeAttenuation",!0);m(this,"_length",0);m(this,"_fill","#fff");m(this,"_stroke","#000");m(this,"_linewidth",1);m(this,"_opacity",1);m(this,"_visible",!0);m(this,"_size",1);m(this,"_sizeAttenuation",!1);m(this,"_beginning",0);m(this,"_ending",1);m(this,"_dashes",null);m(this,"noFill",ut.prototype.noFill);m(this,"noStroke",ut.prototype.noStroke);m(this,"corner",ut.prototype.corner);m(this,"center",ut.prototype.center);m(this,"getBoundingClientRect",ut.prototype.getBoundingClientRect);m(this,"_updateLength",ut.prototype._updateLength);for(let r in Ir)Object.defineProperty(this,r,Ir[r]);this._renderer.type="points",this._renderer.flagVertices=fr.bind(this),this._renderer.bindVertices=ur.bind(this),this._renderer.unbindVertices=_r.bind(this),this._renderer.flagFill=pr.bind(this),this._renderer.flagStroke=mr.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=t,this.dashes=[],this.dashes.offset=0}clone(t){let r=new Ve;for(let s=0;s<this.vertices.length;s++)r.vertices.push(this.vertices[s].clone());for(let s=0;s<Ve.Properties.length;s++){let a=Ve.Properties[s];r[a]=this[a]}return r.className=this.className,r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),t&&t.add(r),r._update()}toObject(){let t={vertices:this.vertices.map(function(r){return r.toObject()})};return j.each(Ve.Properties,function(r){t[r]=this[r]},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof N?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t}subdivide(t){this._update();let r=[];for(let s=0;s<this.vertices.length;s++){let a=this.vertices[s],o=this.vertices[s-1];if(!o)continue;let d=a.x,f=a.y,_=o.x,u=o.y,x=xi(d,f,d,f,_,u,_,u,t);r=r.concat(x)}return this.vertices=r,this}_update(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);let t=Math.min(this._beginning,this._ending),r=Math.max(this._beginning,this._ending),s=si(this,t*this._length),a=si(this,r*this._length),o=Ws(s),d=qs(a),f=0,_;this._renderer.vertices=[],this._renderer.collection=[];for(let u=0;u<this._collection.length;u++)u>=o&&u<=d&&(_=this._collection[u],this._renderer.collection.push(_),this._renderer.vertices[f*2+0]=_.x,this._renderer.vertices[f*2+1]=_.y,f++)}return super._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,super.flagReset.call(this),this}},zi=Ve;g(zi,"Properties",["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"]);var Ir={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(i){this._linewidth=i,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(i){this._opacity=i,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(i){this._visible=i,this._flagVisible=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(i){this._size=i,this._flagSize=!0}},sizeAttenuation:{enumerable:!0,get:function(){return this._sizeAttenuation},set:function(i){this._sizeAttenuation=i,this._flagSizeAttenuation=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(i){(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.unbind(E.Types.change,this._renderer.flagFill),this._fill=i,this._flagFill=!0,(this._fill instanceof zt||this._fill instanceof Tt||this._fill instanceof Rt||this._fill instanceof vt)&&this._fill.bind(E.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(i){(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.unbind(E.Types.change,this._renderer.flagStroke),this._stroke=i,this._flagStroke=!0,(this._stroke instanceof zt||this._stroke instanceof Tt||this._stroke instanceof Rt||this._stroke instanceof vt)&&this._stroke.bind(E.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(i){this._beginning=i,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(i){this._ending=i,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(i){let t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(E.Types.insert,t).unbind(E.Types.remove,r),i instanceof Ae?this._collection=i:this._collection=new Ae(i||[]),this._collection.bind(E.Types.insert,t).bind(E.Types.remove,r),t(this._collection)}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(i){typeof i.offset!="number"&&(i.offset=this.dashes&&this._dashes.offset||0),this._dashes=i}}},Us=Math.cos,Xs=Math.sin,gi=class extends ut{constructor(t,r,s,a){a=Math.max(a||0,3);super();m(this,"_flagWidth",!1);m(this,"_flagHeight",!1);m(this,"_flagSides",!1);m(this,"_radius",0);m(this,"_width",0);m(this,"_height",0);m(this,"_sides",0);for(let o in Or)Object.defineProperty(this,o,Or[o]);this.closed=!0,this.automatic=!1,typeof s=="number"&&(this.radius=s),typeof a=="number"&&(this.sides=a),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){let t=this._sides,r=t+1,s=this.vertices.length;s>t&&(this.vertices.splice(t-1,s-t),s=t);for(let a=0;a<r;a++){let o=(a+.5)/t,d=L*o+Math.PI/2,f=this._width*Us(d)/2,_=this._height*Xs(d)/2;a>=s?this.vertices.push(new Q(f,_)):this.vertices[a].set(f,_),this.vertices[a].command=a===0?k.move:k.line}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagSides=!1,super.flagReset.call(this),this}clone(t){let r=new gi(0,0,0,this.sides);r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,r.width=this.width,r.height=this.height,this.matrix.manual&&r.matrix.copy(this.matrix);for(let s=0;s<ut.Properties.length;s++){let a=ut.Properties[s];r[a]=this[a]}return t&&t.add(r),r}toObject(){let t=super.toObject.call(this);for(let r=0;r<gi.Properties.length;r++){let s=gi.Properties[r];t[s]=this[s]}return t}},Ni=gi;g(Ni,"Properties",["width","height","sides"]);var Or={radius:{enumerable:!0,get:function(){return this._radius},set:function(i){this._radius=i,this.width=i*2,this.height=i*2}},width:{enumerable:!0,get:function(){return this._width},set:function(i){this._width=i,this._flagWidth=!0,this._radius=Math.max(this.width,this.height)/2}},height:{enumerable:!0,get:function(){return this._height},set:function(i){this._height=i,this._flagHeight=!0,this._radius=Math.max(this.width,this.height)/2}},sides:{enumerable:!0,get:function(){return this._sides},set:function(i){this._sides=i,this._flagSides=!0}}},Hs=Math.cos,Js=Math.sin,yi=class extends ut{constructor(t,r,s,a,o){arguments.length<=3&&(a=s,s=a/2),(typeof o!="number"||o<=0)&&(o=5);super();m(this,"_flagInnerRadius",!1);m(this,"_flagOuterRadius",!1);m(this,"_flagSides",!1);m(this,"_innerRadius",0);m(this,"_outerRadius",0);m(this,"_sides",0);for(let d in zr)Object.defineProperty(this,d,zr[d]);this.closed=!0,this.automatic=!1,typeof s=="number"&&(this.innerRadius=s),typeof a=="number"&&(this.outerRadius=a),typeof o=="number"&&(this.sides=o),this._update(),typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r)}_update(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){let t=this._sides*2,r=t+1,s=this.vertices.length;s>t&&(this.vertices.splice(t-1,s-t),s=t);for(let a=0;a<r;a++){let o=(a+.5)/t,d=L*o,f=(a%2?this._outerRadius:this._innerRadius)/2,_=f*Hs(d),u=f*Js(d);a>=s?this.vertices.push(new Q(_,u)):this.vertices[a].set(_,u),this.vertices[a].command=a===0?k.move:k.line}}return super._update.call(this),this}flagReset(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,super.flagReset.call(this),this}clone(t){let r=this.innerRadius,s=this.outerRadius,a=this.sides,o=new yi(0,0,r,s,a);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let d=0;d<ut.Properties.length;d++){let f=ut.Properties[d];o[f]=this[f]}return t&&t.add(o),o}toObject(){let t=super.toObject.call(this);for(let r=0;r<yi.Properties.length;r++){let s=yi.Properties[r];t[s]=this[s]}return t}},Bi=yi;g(Bi,"Properties",["innerRadius","outerRadius","sides"]);var zr={innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(i){this._innerRadius=i,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(i){this._outerRadius=i,this._flagOuterRadius=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(i){this._sides=i,this._flagSides=!0}}},it={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},baselines:{top:"hanging",middle:"middle",bottom:"ideographic",baseline:"alphabetic"},createElement:function(i,t){let r=i,s=document.createElementNS(it.ns,r);return r==="svg"&&(t=j.defaults(t||{},{version:it.version})),t&&Object.keys(t).length>0&&it.setAttributes(s,t),s},setAttributes:function(i,t){let r=Object.keys(t);for(let s=0;s<r.length;s++)/href/.test(r[s])?i.setAttributeNS(it.xlink,r[s],t[r[s]]):i.setAttribute(r[s],t[r[s]]);return this},removeAttributes:function(i,t){for(let r in t)i.removeAttribute(r);return this},toString:function(i,t){let r=i.length,s=r-1,a,o="";for(let d=0;d<r;d++){let f=i[d],_=t?K(d-1,r):Math.max(d-1,0),u=i[_],x,w,S,T,A,F,z,C,P,Y,q,D,X,$,at,rt=pt(f.x),et=pt(f.y);switch(f.command){case k.close:x=k.close;break;case k.arc:q=f.rx,D=f.ry,X=f.xAxisRotation,$=f.largeArcFlag,at=f.sweepFlag,x=k.arc+" "+q+" "+D+" "+X+" "+$+" "+at+" "+rt+" "+et;break;case k.curve:z=u.controls&&u.controls.right||N.zero,C=f.controls&&f.controls.left||N.zero,u.relative?(S=pt(z.x+u.x),T=pt(z.y+u.y)):(S=pt(z.x),T=pt(z.y)),f.relative?(A=pt(C.x+f.x),F=pt(C.y+f.y)):(A=pt(C.x),F=pt(C.y)),x=(d===0?k.move:k.curve)+" "+S+" "+T+" "+A+" "+F+" "+rt+" "+et;break;case k.move:a=f,x=k.move+" "+rt+" "+et;break;default:x=f.command+" "+rt+" "+et}d>=s&&t&&(f.command===k.curve&&(w=a,P=f.controls&&f.controls.right||f,Y=w.controls&&w.controls.left||w,f.relative?(S=pt(P.x+f.x),T=pt(P.y+f.y)):(S=pt(P.x),T=pt(P.y)),w.relative?(A=pt(Y.x+w.x),F=pt(Y.y+w.y)):(A=pt(Y.x),F=pt(Y.y)),rt=pt(w.x),et=pt(w.y),x+=" C "+S+" "+T+" "+A+" "+F+" "+rt+" "+et),f.command!==k.close&&(x+=" Z")),o+=x+" "}return o},pointsToString:function(i,t){let r="",s=t*.5;for(let a=0;a<i.length;a++){let o=i[a].x,d=i[a].y-s;r+=k.move+" "+o+" "+d+" ",r+="a "+s+" "+s+" 0 1 0 0.001 0 Z"}return r},getClip:function(i,t){let r=i._renderer.clip;return r||(r=i._renderer.clip=it.createElement("clipPath",{"clip-rule":"nonzero"})),r.parentNode===null&&t.defs.appendChild(r),r},defs:{update:function(i){let{defs:t}=i;if(t._flagUpdate){let r=Array.prototype.slice.call(t.children,0);for(let s=0;s<r.length;s++){let a=r[s],o=a.id,d='[fill="url(#'.concat(o,')"],[stroke="url(#').concat(o,')"],[clip-path="url(#').concat(o,')"]');i.querySelector(d)||t.removeChild(a)}t._flagUpdate=!1}}},group:{appendChild:function(i){let t=i._renderer.elem;if(!t)return;let r=t.nodeName;!r||/(radial|linear)gradient/i.test(r)||i._clip||this.elem.appendChild(t)},removeChild:function(i){let t=i._renderer.elem;!t||t.parentNode!=this.elem||!t.nodeName||i._clip||this.elem.removeChild(t)},orderChild:function(i){this.elem.appendChild(i._renderer.elem)},renderChild:function(i){it[i._renderer.type].render.call(i,this)},render:function(i){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=it.createElement("g",{id:this.id}),i.appendChild(this._renderer.elem));let t=this._matrix.manual||this._flagMatrix,r={domElement:i,elem:this._renderer.elem};t&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(let s=0;s<this.children.length;s++){let a=this.children[s];it[a._renderer.type].render.call(a,i)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(it.group.appendChild,r),this._flagSubtractions&&this.subtractions.forEach(it.group.removeChild,r),this._flagOrder&&this.children.forEach(it.group.orderChild,r),this._flagMask&&(this._mask?(it[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset&&Object.assign(this._renderer.elem.dataset,this.dataset),this.flagReset()}},path:{render:function(i){if(this._opacity===0&&!this._flagOpacity)return this;this._update();let t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices){let r=it.toString(this._renderer.vertices,this._closed);t.d=r}if(this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),it[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),it[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this._flagCap&&(t["stroke-linecap"]=this._cap),this._flagJoin&&(t["stroke-linejoin"]=this._join),this._flagMiter&&(t["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?it.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=it.createElement("path",t),i.appendChild(this._renderer.elem)),this._flagClip){let r=it.getClip(this,i),s=this._renderer.elem;this._clip?(s.removeAttribute("id"),r.setAttribute("id",this.id),r.appendChild(s)):(r.removeAttribute("id"),s.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(s))}return this._flagMask&&(this._mask?(it[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(i){if(this._opacity===0&&!this._flagOpacity)return this;this._update();let t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){let r=this._size;if(!this._sizeAttenuation){let a=this.worldMatrix.elements,o=B(a[0],a[3],a[1],a[4],a[2],a[5]);r/=Math.max(o.scaleX,o.scaleY)}let s=it.pointsToString(this._renderer.collection,r);t.d=s}return this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),it[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),it[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?it.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=it.createElement("path",t),i.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(i){this._update();let t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagFamily&&(t["font-family"]=this._family),this._flagSize&&(t["font-size"]=this._size),this._flagLeading&&(t["line-height"]=this._leading),this._flagAlignment&&(t["text-anchor"]=it.alignments[this._alignment]||this._alignment),this._flagBaseline&&(t["dominant-baseline"]=it.baselines[this._baseline]||this._baseline),this._flagStyle&&(t["font-style"]=this._style),this._flagWeight&&(t["font-weight"]=this._weight),this._flagDecoration&&(t["text-decoration"]=this._decoration),this._flagDirection&&(t.direction=this._direction),this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),it[this._fill._renderer.type].render.call(this._fill,i,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),it[this._stroke._renderer.type].render.call(this._stroke,i,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(i.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t.opacity=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?it.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=it.createElement("text",t),i.appendChild(this._renderer.elem)),this._flagClip){let r=it.getClip(this,i),s=this._renderer.elem;this._clip?(s.removeAttribute("id"),r.setAttribute("id",this.id),r.appendChild(s)):(r.removeAttribute("id"),s.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(s))}return this._flagMask&&(this._mask?(it[this._mask._renderer.type].render.call(this._mask,i),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(i,t){t||this._update();let r={};if(this._flagId&&(r.id=this._id),this._flagEndPoints&&(r.x1=this.left._x,r.y1=this.left._y,r.x2=this.right._x,r.y2=this.right._y),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?it.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=it.createElement("linearGradient",r)),this._renderer.elem.parentNode===null&&i.defs.appendChild(this._renderer.elem),this._flagStops){let s=this._renderer.elem.childNodes.length!==this.stops.length;if(s)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let a=0;a<this.stops.length;a++){let o=this.stops[a],d={};o._flagOffset&&(d.offset=100*o._offset+"%"),o._flagColor&&(d["stop-color"]=o._color),o._flagOpacity&&(d["stop-opacity"]=o._opacity),o._renderer.elem?it.setAttributes(o._renderer.elem,d):o._renderer.elem=it.createElement("stop",d),s&&this._renderer.elem.appendChild(o._renderer.elem),o.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(i,t){t||this._update();let r={};if(this._flagId&&(r.id=this._id),this._flagCenter&&(r.cx=this.center._x,r.cy=this.center._y),this._flagFocal&&(r.fx=this.focal._x,r.fy=this.focal._y),this._flagRadius&&(r.r=this._radius),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?it.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=it.createElement("radialGradient",r)),this._renderer.elem.parentNode===null&&i.defs.appendChild(this._renderer.elem),this._flagStops){let s=this._renderer.elem.childNodes.length!==this.stops.length;if(s)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let a=0;a<this.stops.length;a++){let o=this.stops[a],d={};o._flagOffset&&(d.offset=100*o._offset+"%"),o._flagColor&&(d["stop-color"]=o._color),o._flagOpacity&&(d["stop-opacity"]=o._opacity),o._renderer.elem?it.setAttributes(o._renderer.elem,d):o._renderer.elem=it.createElement("stop",d),s&&this._renderer.elem.appendChild(o._renderer.elem),o.flagReset()}}return this.flagReset()}},texture:{render:function(i,t){t||this._update();let r={},s={x:0,y:0},a=this.image;if(this._flagId&&(r.id=this._id),this._flagLoaded&&this.loaded)switch(a.nodeName.toLowerCase()){case"canvas":s.href=s["xlink:href"]=a.toDataURL("image/png");break;case"img":case"image":s.href=s["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(r.x=this._offset.x,r.y=this._offset.y,a&&(r.x-=a.width/2,r.y-=a.height/2,this._scale instanceof N?(r.x*=this._scale.x,r.y*=this._scale.y):(r.x*=this._scale,r.y*=this._scale)),r.x>0&&(r.x*=-1),r.y>0&&(r.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(r.width=0,r.height=0,a)){switch(s.width=r.width=a.width,s.height=r.height=a.height,this._repeat){case"no-repeat":r.width+=1,r.height+=1;break}this._scale instanceof N?(r.width*=this._scale.x,r.height*=this._scale.y):(r.width*=this._scale,r.height*=this._scale)}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?it.setAttributes(this._renderer.image,s):this._renderer.image=it.createElement("image",s)),this._renderer.elem?Object.keys(r).length!==0&&it.setAttributes(this._renderer.elem,r):(r.id=this._id,r.patternUnits="userSpaceOnUse",this._renderer.elem=it.createElement("pattern",r)),this._renderer.elem.parentNode===null&&i.defs.appendChild(this._renderer.elem),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}},Nr=class extends E{constructor(i){super(),this.domElement=i.domElement||it.createElement("svg"),this.scene=new Ot,this.scene.parent=this,this.defs=it.createElement("defs"),this.defs._flagUpdate=!1,this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}setSize(i,t){return this.width=i,this.height=t,it.setAttributes(this.domElement,{width:i,height:t}),this.trigger(E.Types.resize,i,t)}render(){return it.group.render.call(this.scene,this.domElement),it.defs.update(this.domElement),this}};g(Nr,"Utils",it);var le={create:function(i,t,r){let s=i.createShader(i[r]);if(i.shaderSource(s,t),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){let a=i.getShaderInfoLog(s);throw i.deleteShader(s),new te("unable to compile shader "+s+": "+a)}return s},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:"\n      precision mediump float;\n      attribute vec2 a_position;\n\n      uniform mat3 u_matrix;\n      uniform vec2 u_resolution;\n      uniform vec4 u_rect;\n\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;\n        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;\n        vec2 normal = projected / u_resolution;\n        vec2 clipspace = (normal * 2.0) - 1.0;\n\n        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n        v_textureCoords = a_position;\n      }\n    ",fragment:"\n      precision mediump float;\n\n      uniform sampler2D u_image;\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec4 texel = texture2D(u_image, v_textureCoords);\n        if (texel.a == 0.0) {\n          discard;\n        }\n        gl_FragColor = texel;\n      }\n    "},points:{vertex:"\n      precision mediump float;\n      attribute vec2 a_position;\n\n      uniform float u_size;\n      uniform mat3 u_matrix;\n      uniform vec2 u_resolution;\n\n      varying vec2 v_textureCoords;\n\n      void main() {\n        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n        vec2 normal = projected / u_resolution;\n        vec2 clipspace = (normal * 2.0) - 1.0;\n\n        gl_PointSize = u_size;\n        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n        v_textureCoords = a_position;\n      }\n    ",fragment:"\n      precision mediump float;\n\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texel = texture2D(u_image, gl_PointCoord);\n        if (texel.a == 0.0) {\n          discard;\n        }\n        gl_FragColor = texel;\n      }\n    "}},vi=Le.Multiply,js=[1,0,0,0,1,0,0,0,1],Se=new ht(9),Gs=Fe.Utils,Br=new N,Yi=new ht([0,0,1,0,0,1,0,1,1,0,1,1]),st={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:O.document?O.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Le,group:{removeChild:function(i,t){if(i.children)for(let r=0;r<i.children.length;r++)st.group.removeChild(i.children[r],t);i._renderer.texture&&(t.deleteTexture(i._renderer.texture),delete i._renderer.texture),i._renderer.positionBuffer&&(t.deleteBuffer(i._renderer.positionBuffer),delete i._renderer.positionBuffer)},render:function(i,t){if(!this._visible)return;this._update();let r=this.parent,s=r._matrix&&r._matrix.manual||r._flagMatrix,a=this._matrix.manual||this._flagMatrix;(s||a)&&(this._renderer.matrix||(this._renderer.matrix=new ht(9)),this._matrix.toTransformArray(!0,Se),vi(Se,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(r._renderer.type)||(this._renderer.scale.x*=r._renderer.scale.x,this._renderer.scale.y*=r._renderer.scale.y),s&&(this._flagMatrix=!0)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),st[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);let o;if(this._flagSubtractions)for(o=0;o<this.subtractions.length;o++)st.group.removeChild(this.subtractions[o],i);for(o=0;o<this.children.length;o++){let d=this.children[o];st[d._renderer.type].render.call(d,i,t)}return this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},path:{updateCanvas:function(i,t){let r,s,a,o,d,f,_,u,x,w,S,T,A,F,z=t._renderer.vertices,C=this.canvas,P=this.ctx,Y=i.renderer.ratio,q=Br.copy(t._renderer.scale).multiply(Y),D=t._stroke,X=t._linewidth,$=t._fill,at=t._renderer.opacity||t._opacity,rt=t._cap,et=t._join,dt=t._miter,ct=t._closed,bt=t.dashes,mt=z.length,Nt=mt-1;C.width=Math.max(Math.ceil(t._renderer.rect.width*q.x),1),C.height=Math.max(Math.ceil(t._renderer.rect.height*q.y),1);let Ht=t._renderer.rect.centroid,Pt=Ht.x,ee=Ht.y;P.clearRect(0,0,C.width,C.height),$&&(typeof $=="string"?P.fillStyle=$:(st[$._renderer.type].render.call($,P,t),P.fillStyle=$._renderer.effect)),D&&(typeof D=="string"?P.strokeStyle=D:(st[D._renderer.type].render.call(D,P,t),P.strokeStyle=D._renderer.effect),X&&(P.lineWidth=X),dt&&(P.miterLimit=dt),et&&(P.lineJoin=et),!ct&&rt&&(P.lineCap=rt)),typeof at=="number"&&(P.globalAlpha=at),bt&&bt.length>0&&(P.lineDashOffset=bt.offset||0,P.setLineDash(bt));let Ut,be,Te,Ue,Xe,He,Je,je;P.save(),P.scale(q.x,q.y),P.translate(Pt,ee),P.beginPath();for(let _e=0;_e<z.length;_e++){let wt=z[_e];switch(T=wt.x,A=wt.y,wt.command){case k.close:P.closePath();break;case k.arc:be=wt.rx,Te=wt.ry,Ue=wt.xAxisRotation,Xe=wt.largeArcFlag,He=wt.sweepFlag,r=ct?K(_e-1,mt):Math.max(_e-1,0),s=z[r],Je=s.x,je=s.y,Gs.renderSvgArcCommand(P,Je,je,be,Te,Xe,He,Ue,T,A);break;case k.curve:r=ct?K(_e-1,mt):Math.max(_e-1,0),s=z[r],u=s.controls&&s.controls.right||N.zero,x=wt.controls&&wt.controls.left||N.zero,s._relative?(f=u.x+s.x,_=u.y+s.y):(f=u.x,_=u.y),wt._relative?(o=x.x+wt.x,d=x.y+wt.y):(o=x.x,d=x.y),P.bezierCurveTo(f,_,o,d,T,A),_e>=Nt&&ct&&(a=Ut,w=wt.controls&&wt.controls.right||N.zero,S=a.controls&&a.controls.left||N.zero,wt._relative?(f=w.x+wt.x,_=w.y+wt.y):(f=w.x,_=w.y),a._relative?(o=S.x+a.x,d=S.y+a.y):(o=S.x,d=S.y),T=a.x,A=a.y,P.bezierCurveTo(f,_,o,d,T,A));break;case k.line:P.lineTo(T,A);break;case k.move:Ut=wt,P.moveTo(T,A);break}}ct&&P.closePath(),st.isHidden.test($)||(F=$._renderer&&$._renderer.offset,F&&(P.save(),P.translate(-$._renderer.offset.x,-$._renderer.offset.y),P.scale($._renderer.scale.x,$._renderer.scale.y)),P.fill(),F&&P.restore()),st.isHidden.test(D)||(F=D._renderer&&D._renderer.offset,F&&(P.save(),P.translate(-D._renderer.offset.x,-D._renderer.offset.y),P.scale(D._renderer.scale.x,D._renderer.scale.y),P.lineWidth=X/D._renderer.scale.x),P.stroke(),F&&P.restore()),P.restore()},getBoundingClientRect:function(i,t,r){let s=1/0,a=-1/0,o=1/0,d=-1/0,f,_;i.forEach(function(u){let x=u.x,w=u.y,S=u.controls,T,A,F,z,C,P;o=Math.min(w,o),s=Math.min(x,s),a=Math.max(x,a),d=Math.max(w,d),u.controls&&(C=S.left,P=S.right,!(!C||!P)&&(T=u._relative?C.x+x:C.x,A=u._relative?C.y+w:C.y,F=u._relative?P.x+x:P.x,z=u._relative?P.y+w:P.y,!(!T||!A||!F||!z)&&(o=Math.min(A,z,o),s=Math.min(T,F,s),a=Math.max(T,F,a),d=Math.max(A,z,d))))}),typeof t=="number"&&(o-=t,s-=t,a+=t,d+=t),f=a-s,_=d-o,r.top=o,r.left=s,r.right=a,r.bottom=d,r.width=f,r.height=_,r.centroid||(r.centroid={}),r.centroid.x=-s,r.centroid.y=-o},render:function(i,t,r){if(!this._visible||!this._opacity)return this;this._update();let s=r||this.parent,a=t[this._renderer.type],o=s._matrix.manual||s._flagMatrix,d=this._matrix.manual||this._flagMatrix,f=this._renderer.parent!==s,_=this._flagVertices||this._flagFill||this._fill instanceof Tt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Rt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof vt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Tt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Rt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof vt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((o||d||f)&&(this._renderer.matrix||(this._renderer.matrix=new ht(9)),this._matrix.toTransformArray(!0,Se),vi(Se,s._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?(this._renderer.scale.x=this._scale.x*s._renderer.scale.x,this._renderer.scale.y=this._scale.y*s._renderer.scale.y):(this._renderer.scale.x=this._scale*s._renderer.scale.x,this._renderer.scale.y=this._scale*s._renderer.scale.y),f&&(this._renderer.parent=s)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),st[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),_?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*s._renderer.opacity,st.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),st.updateTexture.call(st,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==a&&(i.useProgram(a),i.bindBuffer(i.ARRAY_BUFFER,t.buffers.position),i.vertexAttribPointer(a.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a.position),i.bufferData(i.ARRAY_BUFFER,Yi,i.STATIC_DRAW),t.resolution.flagged||i.uniform2f(i.getUniformLocation(a,"u_resolution"),t.resolution.width,t.resolution.height),t.current=a),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(a,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture);let u=this._renderer.rect;return i.uniformMatrix3fv(a.matrix,!1,this._renderer.matrix),i.uniform4f(a.rect,u.left,u.top,u.right,u.bottom),i.drawArrays(i.TRIANGLES,0,6),this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(i,t){let r,s=this.canvas,a=this.ctx,o=i.renderer.ratio,d=t._stroke,f=t._linewidth,_=t._fill,u=t._renderer.opacity||t._opacity,x=t.dashes,w=t._size*o,S=w;st.isHidden.test(d)||(S+=f),s.width=G(S),s.height=s.width;let T=S/s.width,A=s.width/2,F=s.height/2;a.clearRect(0,0,s.width,s.height),_&&(typeof _=="string"?a.fillStyle=_:(st[_._renderer.type].render.call(_,a,t),a.fillStyle=_._renderer.effect)),d&&(typeof d=="string"?a.strokeStyle=d:(st[d._renderer.type].render.call(d,a,t),a.strokeStyle=d._renderer.effect),f&&(a.lineWidth=f/T)),typeof u=="number"&&(a.globalAlpha=u),x&&x.length>0&&(a.lineDashOffset=x.offset||0,a.setLineDash(x)),a.save(),a.translate(A,F),a.scale(st.precision,st.precision),a.beginPath(),a.arc(0,0,w/T*.5,0,L),a.restore(),closed&&a.closePath(),st.isHidden.test(_)||(r=_._renderer&&_._renderer.offset,r&&(a.save(),a.translate(-_._renderer.offset.x,-_._renderer.offset.y),a.scale(_._renderer.scale.x,_._renderer.scale.y)),a.fill(),r&&a.restore()),st.isHidden.test(d)||(r=d._renderer&&d._renderer.offset,r&&(a.save(),a.translate(-d._renderer.offset.x,-d._renderer.offset.y),a.scale(d._renderer.scale.x,d._renderer.scale.y),a.lineWidth=f/d._renderer.scale.x),a.stroke(),r&&a.restore())},render:function(i,t,r){if(!this._visible||!this._opacity)return this;this._update();let s=this._size,a=r||this.parent,o=t[this._renderer.type],d=this._sizeAttenuation,f=this._stroke,_=this._linewidth,u=a._matrix.manual||a._flagMatrix,x=this._matrix.manual||this._flagMatrix,w=this._renderer.parent!==a,S=this._renderer.vertices,T=this._renderer.collection.length,A=this._flagVertices,F=this._flagFill||this._fill instanceof Tt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Rt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof vt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Tt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Rt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof vt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||a._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((u||x||w)&&(this._renderer.matrix||(this._renderer.matrix=new ht(9)),this._matrix.toTransformArray(!0,Se),vi(Se,a._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?(this._renderer.scale.x=this._scale.x*a._renderer.scale.x,this._renderer.scale.y=this._scale.y*a._renderer.scale.y):(this._renderer.scale.x=this._scale*a._renderer.scale.x,this._renderer.scale.y=this._scale*a._renderer.scale.y),w&&(this._renderer.parent=a)),A){let z=this._renderer.positionBuffer;z&&i.deleteBuffer(z),this._renderer.positionBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this._renderer.positionBuffer),i.vertexAttribPointer(o.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(o.position),i.bufferData(i.ARRAY_BUFFER,S,i.STATIC_DRAW)}return F?(this._renderer.opacity=this._opacity*a._renderer.opacity,st.updateTexture.call(st,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture?this:(st.isHidden.test(f)||(s+=_),s/=st.precision,d&&(s*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),t.current!==o&&(i.useProgram(o),t.resolution.flagged||i.uniform2f(i.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),t.current=o),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture),i.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),i.uniform1f(o.size,s*t.resolution.ratio),i.drawArrays(i.POINTS,0,T),this.flagReset())}},text:{updateCanvas:function(i,t){let r=this.canvas,s=this.ctx,a=i.renderer.ratio,o=Br.copy(t._renderer.scale).multiply(a),d=t._stroke,f=t._linewidth,_=t._fill,u=t._renderer.opacity||t._opacity,x=t.dashes,w=t._decoration,S=t._direction;r.width=Math.max(Math.ceil(t._renderer.rect.width*o.x),1),r.height=Math.max(Math.ceil(t._renderer.rect.height*o.y),1);let T=t._renderer.rect.centroid,A=T.x,F=T.y,z,C,P,Y,q,D,X,$,at,rt,et,dt=_._renderer&&_._renderer.offset&&d._renderer&&d._renderer.offset;if(s.clearRect(0,0,r.width,r.height),dt||(s.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" ")),s.textAlign="center",s.textBaseline="middle",s.textDirection=S,_&&(typeof _=="string"?s.fillStyle=_:(st[_._renderer.type].render.call(_,s,t),s.fillStyle=_._renderer.effect)),d&&(typeof d=="string"?s.strokeStyle=d:(st[d._renderer.type].render.call(d,s,t),s.strokeStyle=d._renderer.effect),f&&(s.lineWidth=f)),typeof u=="number"&&(s.globalAlpha=u),x&&x.length>0&&(s.lineDashOffset=x.offset||0,s.setLineDash(x)),s.save(),s.scale(o.x,o.y),s.translate(A,F),st.isHidden.test(_)||(_._renderer&&_._renderer.offset?(D=_._renderer.scale.x,X=_._renderer.scale.y,s.save(),s.translate(-_._renderer.offset.x,-_._renderer.offset.y),s.scale(D,X),z=t._size/_._renderer.scale.y,C=t._leading/_._renderer.scale.y,s.font=[t._style,t._weight,z+"px/",C+"px",t._family].join(" "),P=_._renderer.offset.x/_._renderer.scale.x,Y=_._renderer.offset.y/_._renderer.scale.y,s.fillText(t.value,P,Y),s.restore()):s.fillText(t.value,0,0)),st.isHidden.test(d)||(d._renderer&&d._renderer.offset?(D=d._renderer.scale.x,X=d._renderer.scale.y,s.save(),s.translate(-d._renderer.offset.x,-d._renderer.offset.y),s.scale(D,X),z=t._size/d._renderer.scale.y,C=t._leading/d._renderer.scale.y,s.font=[t._style,t._weight,z+"px/",C+"px",t._family].join(" "),P=d._renderer.offset.x/d._renderer.scale.x,Y=d._renderer.offset.y/d._renderer.scale.y,q=f/d._renderer.scale.x,s.lineWidth=q,s.strokeText(t.value,P,Y),s.restore()):s.strokeText(t.value,0,0)),/(underline|strikethrough)/i.test(w)){let ct=s.measureText(t.value);switch(w){case"underline":at=ct.actualBoundingBoxDescent,et=ct.actualBoundingBoxDescent;break;case"strikethrough":at=0,et=0;break}$=-ct.width/2,rt=ct.width/2,s.lineWidth=Math.max(Math.floor(t._size/15),1),s.strokeStyle=s.fillStyle,s.beginPath(),s.moveTo($,at),s.lineTo(rt,et),s.stroke()}s.restore()},getBoundingClientRect:function(i,t){let r=st.ctx;r.font=[i._style,i._weight,i._size+"px/"+i._leading+"px",i._family].join(" "),r.textAlign="center",r.textBaseline=Fe.Utils.baselines[i._baseline]||i._baseline;let s=r.measureText(i._value),a=s.width,o=1.15*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent);this._linewidth&&!st.isHidden.test(this._stroke)&&(a+=this._linewidth*2,o+=this._linewidth*2);let d=a/2,f=o/2;switch(st.alignments[i._alignment]||i._alignment){case st.alignments.left:i.direction==="ltr"?(t.left=0,t.right=a):(t.left=-a,t.right=0);break;case st.alignments.right:i.direction==="ltr"?(t.left=-a,t.right=0):(t.left=0,t.right=a);break;default:t.left=-d,t.right=d}switch(i._baseline){case"bottom":t.top=-o,t.bottom=0;break;case"top":t.top=0,t.bottom=o;break;case"baseline":t.top=-f*1.5,t.bottom=f*.5;break;default:t.top=-f,t.bottom=f}t.width=a,t.height=o,t.centroid||(t.centroid={}),t.centroid.x=d,t.centroid.y=f},render:function(i,t,r){if(!this._visible||!this._opacity)return this;this._update();let s=r||this.parent,a=t[this._renderer.type],o=s._matrix.manual||s._flagMatrix,d=this._matrix.manual||this._flagMatrix,f=this._renderer.parent!==s,_=this._flagVertices||this._flagFill||this._fill instanceof Tt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Rt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof vt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof Tt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Rt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof vt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((o||d||f)&&(this._renderer.matrix||(this._renderer.matrix=new ht(9)),this._matrix.toTransformArray(!0,Se),vi(Se,s._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?(this._renderer.scale.x=this._scale.x*s._renderer.scale.x,this._renderer.scale.y=this._scale.y*s._renderer.scale.y):(this._renderer.scale.x=this._scale*s._renderer.scale.x,this._renderer.scale.y=this._scale*s._renderer.scale.y),f&&(this._renderer.parent=s)),this._mask&&(i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST),i.stencilFunc(i.ALWAYS,1,0),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.colorMask(!1,!1,!1,!1),st[this._mask._renderer.type].render.call(this._mask,i,t,this),i.stencilFunc(i.EQUAL,1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.colorMask(!0,!0,!0,!0)),_?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*s._renderer.opacity,st.text.getBoundingClientRect(this,this._renderer.rect),st.updateTexture.call(st,i,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==a&&(i.useProgram(a),i.bindBuffer(i.ARRAY_BUFFER,t.buffers.position),i.vertexAttribPointer(a.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a.position),i.bufferData(i.ARRAY_BUFFER,Yi,i.STATIC_DRAW),t.resolution.flagged||i.uniform2f(i.getUniformLocation(a,"u_resolution"),t.resolution.width,t.resolution.height),t.current=a),t.resolution.flagged&&i.uniform2f(i.getUniformLocation(a,"u_resolution"),t.resolution.width,t.resolution.height),i.bindTexture(i.TEXTURE_2D,this._renderer.texture);let u=this._renderer.rect;return i.uniformMatrix3fv(a.matrix,!1,this._renderer.matrix),i.uniform4f(a.rect,u.left,u.top,u.right,u.bottom),i.drawArrays(i.TRIANGLES,0,6),this._mask&&i.disable(i.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(i,t){if(!(!i.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,s=this.left._x,a=this.left._y,o=this.right._x,d=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),s=(s-.5)*r.width,a=(a-.5)*r.height,o=(o-.5)*r.width,d=(d-.5)*r.height),this._renderer.effect=i.createLinearGradient(s,a,o,d);for(let f=0;f<this.stops.length;f++){let _=this.stops[f];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},"radial-gradient":{render:function(i,t){if(!(!i.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,s=this.center._x,a=this.center._y,o=this.focal._x,d=this.focal._y,f=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),s=s*r.width*.5,a=a*r.height*.5,o=o*r.width*.5,d=d*r.height*.5,f*=Math.min(r.width,r.height)*.5),this._renderer.effect=i.createRadialGradient(s,a,0,o,d,f);for(let _=0;_<this.stops.length;_++){let u=this.stops[_];this._renderer.effect.addColorStop(u._offset,u._color)}}return this.flagReset()}}},texture:{render:function(i,t){if(!i.canvas.getContext("2d"))return;this._update();let r=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=i.createPattern(r,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof N||(this._renderer.offset=new N),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,r&&(this._renderer.offset.x+=r.width/2,this._renderer.offset.y+=r.height/2,this._scale instanceof N?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof N||(this._renderer.scale=new N),this._scale instanceof N?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},updateTexture:function(i,t){if(this[t._renderer.type].updateCanvas.call(st,i,t),this.canvas.width<=0||this.canvas.height<=0){t._renderer.texture&&i.deleteTexture(t._renderer.texture),delete t._renderer.texture;return}t._renderer.texture||(t._renderer.texture=i.createTexture()),i.bindTexture(i.TEXTURE_2D,t._renderer.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this.canvas),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)},program:{create:function(i,t){let r,s,a;if(r=i.createProgram(),j.each(t,function(o){i.attachShader(r,o)}),i.linkProgram(r),s=i.getProgramParameter(r,i.LINK_STATUS),!s)throw a=i.getProgramInfoLog(r),i.deleteProgram(r),new te("unable to link program: "+a);return r}},extensions:{init:function(i){let t={},r=["EXT_texture_filter_anisotropic","WEBGL_compressed_texture_s3tc","OES_texture_float_linear","WEBGL_multisampled_render_to_texture"];for(let s=0;s<r.length;s++){let a=r[s];t[a]=st.extensions.get(i,a)}return t},get:function(i,t){return i.getExtension(t)||i.getExtension("MOZ_".concat(t))||i.getExtension("WEBKIT_".concat(t))}},TextureRegistry:new ri};st.ctx=st.canvas.getContext("2d");var Yr=class extends E{constructor(i){super();let t,r,s,a;if(this.domElement=i.domElement||document.createElement("canvas"),typeof i.offscreenElement<"u"&&(st.canvas=i.offscreenElement,st.ctx=st.canvas.getContext("2d")),this.scene=new Ot,this.scene.parent=this,this._renderer={type:"renderer",matrix:new ht(js),scale:1,opacity:1},this._flagMatrix=!0,i=j.defaults(i||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=i.overdraw,t=this.ctx=this.domElement.getContext("webgl",i)||this.domElement.getContext("experimental-webgl",i),!this.ctx)throw new te("unable to create a webgl context. Try using another renderer.");s=le.create(t,le.path.vertex,le.types.vertex),a=le.create(t,le.path.fragment,le.types.fragment),this.programs={current:null,buffers:{position:t.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},r=this.programs.path=st.program.create(t,[s,a]),this.programs.text=this.programs.path,t.extensions=st.extensions.init(t),t.renderer=this,r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.rect=t.getUniformLocation(r,"u_rect");let o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,Yi,t.STATIC_DRAW),s=le.create(t,le.points.vertex,le.types.vertex),a=le.create(t,le.points.fragment,le.types.fragment),r=this.programs.points=st.program.create(t,[s,a]),r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.size=t.getUniformLocation(r,"u_size"),t.enable(t.BLEND),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}setSize(i,t,r){let s,a,o=this.ctx;return this.width=i,this.height=t,this.ratio=typeof r>"u"?Ai(o):r,this.domElement.width=i*this.ratio,this.domElement.height=t*this.ratio,j.isObject(this.domElement.style)&&j.extend(this.domElement.style,{width:i+"px",height:t+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,s=i*this.ratio,a=t*this.ratio,o.viewport(0,0,s,a),this.programs.resolution.width=s,this.programs.resolution.height=a,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(E.Types.resize,i,t,r)}render(){let i=this.ctx;return this.overdraw||i.clear(i.COLOR_BUFFER_BIT),st.group.render.call(this.scene,i,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}};g(Yr,"Utils",st);var Ks=j.extend({Error:te,getRatio:Ai,read:Mt,xhr:Lr},j,$t,fe,U),We=class{constructor(i){m(this,"_events",new E);m(this,"type","");m(this,"renderer",null);m(this,"scene",null);m(this,"width",0);m(this,"height",0);m(this,"frameCount",0);m(this,"timeDelta",0);m(this,"playing",!1);let t=j.defaults(i||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:We.Types.svg,autostart:!1});if(j.each(t,function(r,s){/fullscreen/i.test(s)||/autostart/i.test(s)||(this[s]=r)},this),j.isElement(t.domElement)){let r=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+r)||(this.type=We.Types[r])}this.renderer=new We[this.type](this),this.setPlaying(t.autostart),this.frameCount=0,t.fullscreen?(this.fit=Qs.bind(this),this.fit.domElement=window,this.fit.attached=!0,j.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),j.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Zt.bind(this.fit.domElement,"resize",this.fit),this.fit()):t.fitted?(this.fit=$s.bind(this),j.extend(this.renderer.domElement.style,{display:"block"})):j.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.renderer.bind(E.Types.resize,Zs.bind(this)),this.scene=this.renderer.scene,We.Instances.push(this),t.autostart&&qe.init()}get _bound(){return this._events._bound}set _bound(i){this._events._bound=i}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.addEventListener.apply(this,arguments)}bind(){return this._events.addEventListener.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.removeEventListener.apply(this,arguments)}unbind(){return this._events.removeEventListener.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.dispatchEvent.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}appendTo(i){return i.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=i,this.fit.attached=!1),this.update()),this}play(){return this.playing=!0,qe.init(),this.trigger(E.Types.play)}pause(){return this.playing=!1,this.trigger(E.Types.pause)}setPlaying(i){this.playing=i}release(i){let t,r,s;if(!j.isObject(i))return this.release(this.scene);if(typeof i.unbind=="function"&&i.unbind(),i.vertices)for(typeof i.vertices.unbind=="function"&&i.vertices.unbind(),t=0;t<i.vertices.length;t++)r=i.vertices[t],typeof r.unbind=="function"&&r.unbind(),r.controls&&(r.controls.left&&typeof r.controls.left.unbind=="function"&&r.controls.left.unbind(),r.controls.right&&typeof r.controls.right.unbind=="function"&&r.controls.right.unbind());if(i.children){for(t=0;t<i.children.length;t++)s=i.children[t],this.release(s);typeof i.children.unbind=="function"&&i.children.unbind()}return i}update(){let i=!!this._lastFrame,t=j.performance.now();i&&(this.timeDelta=parseFloat((t-this._lastFrame).toFixed(3))),this._lastFrame=t,this.fit&&this.fit.domElement&&!this.fit.attached&&(Zt.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());let r=this.width,s=this.height,a=this.renderer;return(r!==a.width||s!==a.height)&&a.setSize(r,s,this.ratio),this.trigger(E.Types.update,this.frameCount,this.timeDelta),this.render()}render(){return this.renderer.render(),this.trigger(E.Types.render,this.frameCount++)}add(i){return i instanceof Array||(i=Array.prototype.slice.call(arguments)),this.scene.add(i),this}remove(i){return i instanceof Array||(i=Array.prototype.slice.call(arguments)),this.scene.remove(i),this}clear(){return this.scene.remove(this.scene.children),this}makeLine(i,t,r,s){let a=new Ci(i,t,r,s);return this.scene.add(a),a}makeArrow(i,t,r,s,a){let o=typeof a=="number"?a:10,d=Math.atan2(s-t,r-i),f=[new Q(i,t,void 0,void 0,void 0,void 0,k.move),new Q(r,s,void 0,void 0,void 0,void 0,k.line),new Q(r-o*Math.cos(d-Math.PI/4),s-o*Math.sin(d-Math.PI/4),void 0,void 0,void 0,void 0,k.line),new Q(r,s,void 0,void 0,void 0,void 0,k.move),new Q(r-o*Math.cos(d+Math.PI/4),s-o*Math.sin(d+Math.PI/4),void 0,void 0,void 0,void 0,k.line)],_=new ut(f,!1,!1,!0);return _.noFill(),_.cap="round",_.join="round",this.scene.add(_),_}makeRectangle(i,t,r,s){let a=new Pe(i,t,r,s);return this.scene.add(a),a}makeRoundedRectangle(i,t,r,s,a){let o=new _i(i,t,r,s,a);return this.scene.add(o),o}makeCircle(i,t,r,s){let a=new ci(i,t,r,s);return this.scene.add(a),a}makeEllipse(i,t,r,s,a){let o=new fi(i,t,r,s,a);return this.scene.add(o),o}makeStar(i,t,r,s,a){let o=new Bi(i,t,r,s,a);return this.scene.add(o),o}makeCurve(i){let t=arguments.length;if(!Array.isArray(i)){i=[];for(let o=0;o<t;o+=2){let d=arguments[o];if(typeof d!="number")break;let f=arguments[o+1];i.push(new Q(d,f))}}let r=arguments[t-1],s=new ut(i,!(typeof r=="boolean"&&r),!0),a=s.getBoundingClientRect();return s.center().translation.set(a.left+a.width/2,a.top+a.height/2),this.scene.add(s),s}makePolygon(i,t,r,s){let a=new Ni(i,t,r,s);return this.scene.add(a),a}makeArcSegment(i,t,r,s,a,o,d){let f=new Oi(i,t,r,s,a,o,d);return this.scene.add(f),f}makePoints(i){let t=arguments.length,r=i;if(!Array.isArray(i)){r=[];for(let a=0;a<t;a+=2){let o=arguments[a];if(typeof o!="number")break;let d=arguments[a+1];r.push(new N(o,d))}}let s=new zi(r);return this.scene.add(s),s}makePath(i){let t=arguments.length,r=i;if(!Array.isArray(i)){r=[];for(let d=0;d<t;d+=2){let f=arguments[d];if(typeof f!="number")break;let _=arguments[d+1];r.push(new Q(f,_))}}let s=arguments[t-1],a=new ut(r,!(typeof s=="boolean"&&s)),o=a.getBoundingClientRect();return typeof o.top=="number"&&typeof o.left=="number"&&typeof o.right=="number"&&typeof o.bottom=="number"&&a.center().translation.set(o.left+o.width/2,o.top+o.height/2),this.scene.add(a),a}makeText(i,t,r,s){let a=new ue(i,t,r,s);return this.add(a),a}makeLinearGradient(i,t,r,s){let a=Array.prototype.slice.call(arguments,4),o=new Tt(i,t,r,s,a);return this.add(o),o}makeRadialGradient(i,t,r){let s=Array.prototype.slice.call(arguments,3),a=new Rt(i,t,r,s);return this.add(a),a}makeSprite(i,t,r,s,a,o,d){let f=new hi(i,t,r,s,a,o);return d&&f.play(),this.add(f),f}makeImageSequence(i,t,r,s,a){let o=new pi(i,t,r,s);return a&&o.play(),this.add(o),o}makeTexture(i,t){return new vt(i,t)}makeGroup(i){i instanceof Array||(i=Array.prototype.slice.call(arguments));let t=new Ot;return this.scene.add(t),t.add(i),t}interpret(i,t,r){let s=i.tagName.toLowerCase();if(r=typeof r<"u"?r:!0,!(s in Mt))return null;let a=Mt[s].call(this,i);return r?this.add(t&&a instanceof Ot?a.children:a):a.parent&&a.remove(),a}load(i,t){let r=new Ot,s,a,o,d=(function(f){for(Zt.temp.innerHTML=f,a=0;a<Zt.temp.children.length;a++)s=Zt.temp.children[a],o=this.interpret(s,!1,!1),o!==null&&r.add(o);if(typeof t=="function"){let _=Zt.temp.children.length<=1?Zt.temp.children[0]:Zt.temp.children;t(r,_)}}).bind(this);return/\.svg$/i.test(i)?(Lr(i,d),r):(d(i),r)}},ot=We;g(ot,"nextFrameID",xt.nextFrameID),g(ot,"Types",xt.Types),g(ot,"Version",xt.Version),g(ot,"PublishDate",xt.PublishDate),g(ot,"Identifier",xt.Identifier),g(ot,"Resolution",xt.Resolution),g(ot,"AutoCalculateImportedMatrices",xt.AutoCalculateImportedMatrices),g(ot,"Instances",xt.Instances),g(ot,"uniqueId",xt.uniqueId),g(ot,"Anchor",Q),g(ot,"Collection",Ae),g(ot,"Events",E),g(ot,"Group",Ot),g(ot,"Matrix",Le),g(ot,"Path",ut),g(ot,"Registry",ri),g(ot,"Shape",we),g(ot,"Text",ue),g(ot,"Vector",N),g(ot,"Gradient",zt),g(ot,"ImageSequence",pi),g(ot,"LinearGradient",Tt),g(ot,"RadialGradient",Rt),g(ot,"Sprite",hi),g(ot,"Stop",Ee),g(ot,"Texture",vt),g(ot,"ArcSegment",Oi),g(ot,"Circle",ci),g(ot,"Ellipse",fi),g(ot,"Line",Ci),g(ot,"Points",zi),g(ot,"Polygon",Ni),g(ot,"Rectangle",Pe),g(ot,"RoundedRectangle",_i),g(ot,"Star",Bi),g(ot,"CanvasRenderer",Fe),g(ot,"SVGRenderer",Nr),g(ot,"WebGLRenderer",Yr),g(ot,"Commands",k),g(ot,"Utils",Ks);function Qs(){let i=document.body.getBoundingClientRect(),t=this.width=i.width,r=this.height=i.height;this.renderer.setSize(t,r,this.ratio)}function $s(){let i=this.renderer.domElement.parentElement;if(!i){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}let t=i.getBoundingClientRect(),r=this.width=t.width,s=this.height=t.height;this.renderer.setSize(r,s,this.ratio)}function Zs(i,t){this.width=i,this.height=t,this.trigger(E.Types.resize,i,t)}var qe=Zt.getRequestAnimationFrame();function Dr(){for(let i=0;i<ot.Instances.length;i++){let t=ot.Instances[i];t.playing&&t.update()}ot.nextFrameID=qe(Dr)}return qe.init=function(){Dr(),qe.init=function(){}},b(M)})().default,de=sn;var Di=class{constructor(n,h,c){this.renderer=c,this.limits={minScale:-1/0,maxScale:1/0,minX:-1/0,maxX:1/0,minY:-1/0,maxY:1/0,scaleFactor:4,Max:!1},this.viewport=h,this.viewportMatrix=new de.Matrix,this.surfaceMatrix=new de.Matrix,this.scale=1,this.surface=n}setScaleLimits(n,h){this.limits.minScale=n,this.limits.maxScale=h}setWorldLimits(n,h=!1,c=4){this.limits.minX=n.mins.x,this.limits.maxX=n.maxs.x,this.limits.minY=n.mins.y,this.limits.maxY=n.maxs.y,this.limits.Max=h,this.limits.scaleFactor=c,this.updateScaleLimits()}resetWorldLimits(){this.limits.minX=-1/0,this.limits.maxX=1/0,this.limits.minY=-1/0,this.limits.maxY=1/0}updateScaleLimits(){if(!(this.limits.maxX===1/0||this.limits.minX===-1/0||this.limits.maxY===1/0||this.limits.minY===-1/0)){var n={x:this.renderer.width/(this.limits.maxX-this.limits.minX),y:this.renderer.height/(this.limits.maxY-this.limits.minY)};this.limits.minScale=Math[this.limits.Max?"max":"min"](n.x,n.y),this.limits.maxScale=this.limits.minScale*this.limits.scaleFactor;var h=this.fitScaleToLimits(this.scale);h!==this.scale&&this.zoomSet(h),this.translateSurface(0,0)}}fitCameraToBounds(n,h=!1){var c={x:this.renderer.width/(n.maxs.x-n.mins.x),y:this.renderer.height/(n.maxs.y-n.mins.y)};this.zoomSet(Math[h?"max":"min"](c.x,c.y)),this.moveCameraTo((n.maxs.x+n.mins.x)*.5,(n.maxs.y+n.mins.y)*.5)}moveCameraTo(n,h){let c=this.worldToScreen(n,-h);this.translateSurface(this.renderer.width*.5-c.x,this.renderer.height*.5-c.y)}validateCameraBounds(n,h){var c={x:n,y:h};if(this.limits.maxX===1/0||this.limits.minX===-1/0||this.limits.maxY===1/0||this.limits.minY===-1/0)return c;let p=this.screenToWorld(0,0),v=this.screenToWorld(this.renderer.width,this.renderer.height),y=(v.x-p.x)*.5,b=(v.y-p.y)*.5,g=(this.limits.maxX+this.limits.minX)*.5,M=(this.limits.maxY+this.limits.minY)*.5;var k=this.screenToWorld(this.renderer.width*.5-c.x,this.renderer.height*.5-c.y);let U=k.x-y<=this.limits.minX,O=k.x+y>=this.limits.maxX,Z=-k.y-b<=this.limits.minY,L=-k.y+b>=this.limits.maxY;if(y>(this.limits.maxX-this.limits.minX)*.5){let R=this.worldToScreen(g,M);c.x=this.renderer.width*.5-R.x}else{if(U){let R=this.worldToScreen(this.limits.minX,this.limits.minY);c.x=-R.x}if(O){let R=this.worldToScreen(this.limits.maxX,this.limits.maxY);c.x=this.renderer.width-R.x}}if(b>(this.limits.maxY-this.limits.minY)*.5){let R=this.worldToScreen(g,-M);c.y=this.renderer.height*.5-R.y}else{if(Z){let R=this.worldToScreen(this.limits.minX,-this.limits.minY);c.y=this.renderer.height-R.y}if(L){let R=this.worldToScreen(this.limits.maxX,-this.limits.maxY);c.y=-R.y}}return c}screenToWorld(n,h){let c=this.viewportMatrix.inverse().multiply(n,h,1),p=this.surfaceMatrix.inverse().multiply(c[0],c[1],c[2]);return{x:p[0],y:p[1],z:p[2]}}worldToScreen(n,h){let c=this.surfaceMatrix.multiply(n,h,1),p=this.viewportMatrix.multiply(c[0],c[1],c[2]);return{x:p[0],y:p[1],z:p[2]}}fitScaleToLimits(n){return Math.min(Math.max(n,this.limits.minScale),this.limits.maxScale)}zoomBy(n,h=0,c=0){this.zoomSet(Math.exp(Math.log(this.scale)+n),h,c)}zoomSet(n,h=0,c=0){let p=this.fitScaleToLimits(n);if(p===this.scale)return this;let v=this.screenToWorld(h,c);this.surfaceMatrix.scale(p/this.scale),this.scale=p;let y=this.worldToScreen(v.x,v.y),b=h-y.x,g=c-y.y;this.translateSurface(b,g)}translateSurface(n,h){var{x:c,y:p}=this.validateCameraBounds(n,h);this.surfaceMatrix.elements[2]+=c,this.surfaceMatrix.elements[5]+=p,this.updateSurface()}updateSurface(){let n=this.surfaceMatrix.elements;this.surface.translation.set(n[2],n[5]),this.surface.scale=new de.Vector(n[0],-n[0])}},is=Di;function ne(e,n){this.Newton=e,this.canvas=n,de.Camera=is,this.Two=de,this.two=new de({type:de.Types.svg,autostart:!0}).appendTo(n),this.stage=new de.Group,this.two.add(this.stage),this.joints_group=new de.Group,this.stage.add(this.joints_group),this.camera=new de.Camera(this.stage,this.two.renderer.domElement,this),this.camera.setScaleLimits(10,500),this.resize(),this.camera.translateSurface(this.width/2,this.height/2),this.camera.zoomSet(35,this.width/2,this.height/2)}ne.prototype.resize=function(){var e=this.canvas.offsetWidth-(this.width||this.canvas.offsetWidth),n=this.canvas.offsetHeight-(this.height||this.canvas.offsetHeight);this.width=this.canvas.offsetWidth,this.height=this.canvas.offsetHeight,this.two.renderer.setSize(this.width,this.height),this.camera.translateSurface(e/2,n/2),this.camera.updateScaleLimits()};ne.prototype.jointsVisible=function(e){this.joints_group.visible=e};ne.prototype.createCircle=function(e,n,h){var c=this.Newton.vec2.sub(n.tc,h.p);let p=this.two.makeCircle(c.x,c.y,n.r);p.fill="#FF8000",p.stroke="orangered",p.linewidth=.05;let v=this.two.makeLine(c.x,c.y,c.x,c.y+n.r);v.linewidth=.05,v.stroke="rgba(255, 0, 0, 0.5)",e.add(p,v),n.render_entity=p};ne.prototype.createPolygon=function(e,n,h){let c=this.two.makePath(...n.tverts.reduce((p,v)=>{var y=this.Newton.vec2.sub(v,h.p);return p.concat([y.x,y.y])},[]));c.linewidth=.05,c.stroke="#aaaaaa",c.fill="#ececec",e.add(c),n.render_entity=c};ne.prototype.createSegment=function(e,n,h){var c=this.Newton.vec2.sub(n.ta,h.p),p=this.Newton.vec2.sub(n.tb,h.p),v=n.r*2,y=this.Newton.vec2.perp(this.Newton.vec2.sub(p,c)).toAngle()-h.a;let b=this.Newton.vec2.dist(p,c)+v,g=this.Newton.vec2.add(p,c).scale(.5);var M=this.two.makeRoundedRectangle(g.x,g.y,v,b,n.r);M.rotation=y,M.stroke="#aaaaaa",M.fill="#ececec",M.linewidth=.05,e.add(M),n.render_entity=M};ne.prototype.addBody=function(e){e.render_group=this.two.makeGroup(),e.render_group.position.set(e.p.x,e.p.y),e.render_group.rotation=e.a,this.stage.add(e.render_group);for(var n=0;n<e.shapeArr.length;n++){var h=e.shapeArr[n];if(h.createRenderEntity){h.createRenderEntity(e.render_group,h,e);continue}switch(h.type){case this.Newton.Shape.TYPE_CIRCLE:this.createCircle(e.render_group,h,e);break;case this.Newton.Shape.TYPE_SEGMENT:this.createSegment(e.render_group,h,e);break;case this.Newton.Shape.TYPE_POLY:this.createPolygon(e.render_group,h,e);break}}};ne.prototype.removeBody=function(e){e.render_group.remove()};ne.prototype.updateBody=function(e){e.render_group.position.set(e.p.x,e.p.y),e.render_group.rotation=e.a};ne.prototype.addJoint=function(e){if(e.render_group=this.two.makeGroup(),e.type===e.TYPE_DISTANCE||e.type===e.TYPE_ROPE||e.type===e.TYPE_PRISMATIC||e.type===e.TYPE_MOUSE){var n=e.getWorldAnchor1(),h=e.getWorldAnchor2(),c=this.two.makeLine(n.x,n.y,h.x,h.y);e.type===e.TYPE_PRISMATIC?(c.linewidth=.02,c.stroke="rgba(255, 0, 0, 1)",c.dashes=[.5,.1]):e.type===e.TYPE_MOUSE?(c.linewidth=.02,c.stroke="rgba(255, 0, 0, 1)",c.dashes=[.05,.05]):e.type===e.TYPE_DISTANCE?(c.linewidth=.05,c.stroke="rgba(0, 155, 255, 0.7)",c.dashes=[.1,.1]):(c.linewidth=.05,c.stroke="rgba(0, 255, 0, 0.5)");let p=this.two.makeCircle(n.x,n.y,.08);p.fill="red",p.linewidth=0;let v=this.two.makeCircle(h.x,h.y,.08);v.fill="red",v.linewidth=0,e.render_group.add(c,p,v)}else if(e.type===e.TYPE_REVOLUTE){var n=e.getWorldAnchor1();let v=this.two.makeCircle(n.x,n.y,.08);v.stroke="green",v.linewidth=.05,e.render_group.add(v)}else if(e.type===e.TYPE_WELD){var n=e.getWorldAnchor1();let v=this.two.makeCircle(n.x,n.y,.05);v.stroke="blue",v.linewidth=.02,e.render_group.add(v)}else if(e.type===e.TYPE_WHEEL){var n=e.getWorldAnchor1(),h=e.getWorldAnchor2();let y=this.two.makeCircle(h.x,h.y,.08);y.fill="red",y.linewidth=0;var c=this.two.makeLine(n.x,n.y,h.x,h.y);c.linewidth=.05,c.stroke="rgba(0, 0, 0, 1)",e.render_group.add(y,c)}else console.log(e);this.joints_group.add(e.render_group),this.stage.add(this.joints_group)};ne.prototype.removeJoint=function(e){e.render_group.remove()};ne.prototype.updateJoint=function(e){if(e.type===e.TYPE_DISTANCE||e.type===e.TYPE_ROPE||e.type===e.TYPE_PRISMATIC||e.type===e.TYPE_MOUSE){var n=e.getWorldAnchor1(),h=e.getWorldAnchor2(),[c,p]=e.render_group.children[0].vertices,[v,y]=[e.render_group.children[1],e.render_group.children[2]];c.x=n.x,c.y=n.y,p.x=h.x,p.y=h.y,v.position.set(n.x,n.y),y.position.set(h.x,h.y)}else if(e.type===e.TYPE_REVOLUTE||e.type===e.TYPE_WELD){var n=e.getWorldAnchor1();e.render_group.children[0].position.set(n.x,n.y)}else if(e.type===e.TYPE_WHEEL){var n=e.getWorldAnchor1(),h=e.getWorldAnchor2(),b=e.render_group.children[0];b.position.set(h.x,h.y);var[c,p]=e.render_group.children[1].vertices;c.x=n.x,c.y=n.y,p.x=h.x,p.y=h.y}};function rs(e,n,h=1e3,c=0,p=300){var v=performance.now(),y=v+h,b;function g(M){var k=M-v;if(k>=h)return cancelAnimationFrame(b);e(c+(p-c)*n(k/h)),b=requestAnimationFrame(g)}return b=requestAnimationFrame(g)}function ss(e,n,h=1e3,c){var p=performance.now(),v=p+h,y,b=new Array(c[0].length);function g(M){var k=M-p;if(k>=h)return cancelAnimationFrame(y);var U=n(k/h);c.forEach((O,Z)=>b[Z]=O[0]+(O[1]-O[0])*U),e(...b),y=requestAnimationFrame(g)}return y=requestAnimationFrame(g)}var _t={};_t.linear=function(e){return e};_t.inQuad=function(e){return e*e};_t.outQuad=function(e){return e*(2-e)};_t.inOutQuad=function(e){return e*=2,e<1?.5*e*e:-.5*(--e*(e-2)-1)};_t.inCube=function(e){return e*e*e};_t.outCube=function(e){return--e*e*e+1};_t.inOutCube=function(e){return e*=2,e<1?.5*e*e*e:.5*((e-=2)*e*e+2)};_t.inQuart=function(e){return e*e*e*e};_t.outQuart=function(e){return 1- --e*e*e*e};_t.inOutQuart=function(e){return e*=2,e<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)};_t.inQuint=function(e){return e*e*e*e*e};_t.outQuint=function(e){return--e*e*e*e*e+1};_t.inOutQuint=function(e){return e*=2,e<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)};_t.inSine=function(e){return 1-Math.cos(e*Math.PI/2)};_t.outSine=function(e){return Math.sin(e*Math.PI/2)};_t.inOutSine=function(e){return .5*(1-Math.cos(Math.PI*e))};_t.inExpo=function(e){return e==0?0:Math.pow(1024,e-1)};_t.outExpo=function(e){return e==1?e:1-Math.pow(2,-10*e)};_t.inOutExpo=function(e){return e==0?0:e==1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)};_t.inCirc=function(e){return 1-Math.sqrt(1-e*e)};_t.outCirc=function(e){return Math.sqrt(1- --e*e)};_t.inOutCirc=function(e){return e*=2,e<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)};_t.inBack=function(e){var n=1.70158;return e*e*((n+1)*e-n)};_t.outBack=function(e){var n=1.70158;return--e*e*((n+1)*e+n)+1};_t.inOutBack=function(e){var n=2.5949095;return(e*=2)<1?.5*(e*e*((n+1)*e-n)):.5*((e-=2)*e*((n+1)*e+n)+2)};_t.inBounce=function(e){return 1-_t.outBounce(1-e)};_t.outBounce=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375};_t.inOutBounce=function(e){return e<.5?_t.inBounce(e*2)*.5:_t.outBounce(e*2-1)*.5+.5};_t.inElastic=function(e){var n,h=.1,c=.4;return e===0?0:e===1?1:(!h||h<1?(h=1,n=c/4):n=c*Math.asin(1/h)/(2*Math.PI),-(h*Math.pow(2,10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/c)))};_t.outElastic=function(e){var n,h=.1,c=.4;return e===0?0:e===1?1:(!h||h<1?(h=1,n=c/4):n=c*Math.asin(1/h)/(2*Math.PI),h*Math.pow(2,-10*e)*Math.sin((e-n)*(2*Math.PI)/c)+1)};_t.inOutElastic=function(e){var n,h=.1,c=.4;return e===0?0:e===1?1:(!h||h<1?(h=1,n=c/4):n=c*Math.asin(1/h)/(2*Math.PI),(e*=2)<1?-.5*(h*Math.pow(2,10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/c)):h*Math.pow(2,-10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/c)*.5+1)};var ns={Interaction:Be,Runner:ce,World:yt,Body:tt,Shape:nt,ShapeBox:$r,ShapePoly:kt,ShapeCircle:Ft,ShapeTriangle:Qr,ShapeSegment:It,RopeJoint:ie,WeldJoint:Jt,WheelJoint:Vt,AngleJoint:re,MouseJoint:Kt,DistanceJoint:jt,RevoluteJoint:Wt,PrismaticJoint:se,Bounds:Et,collision:Re,stats:Xt,pixel2meter:bi,meter2pixel:Vr,vec2:l,deg2rad:Ce,TwoRenderer:ne,animate:rs,animateBatch:ss,easings:_t};window.Newton=ns;})();
